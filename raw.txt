1/
    1.字母识别项目/
    10.多个小球碰撞有背景颜色支持更换小球个数项目/
    11.设计并仿真以下无线系统/
    12.双PWM调速系统的仿真模型项目/
    13.夜间车牌识别项目/
    14.Elman神经网络预测数据项目/
    15.给图片增加水印项目/
    16.实现学生成绩查询系统 项目/
    17.建模 人口增长模型 项目/
    18.对图像特征的分类随机森林算法/
    19.Laplace变换和逆变换项目/
    2.噪声波形和功率绘图项目/
    20.交通系统MCM-2009A题答案/
    21.实现线性拟合和相关系数项目/
    22.多聚焦图像融合将两张到六张不同焦点的图片合成成一张项目/
    23.模式识别/
    24.二进小波和非线性变换的图像增强项目/
    25.模拟surface plasmon的随着不同角度变化的电磁场分布项目/
    26.输液管失稳弹簧刚度变化求临界失稳流速项目/
    27.BP网络项目/
    28.B神经网络30个案例分析/
    3.广义预测控制项目/
    4.遗传算法求解最优解最大值项目/
    5.遗传算法求多目标函数有无约束条件的最优解项目/
    6.滤波器设计/
    7.使用Matlab在优化方面的程序项目/
    8.b太空之战程序项目/
    9.蒙特卡洛法求椭圆面积项目/
2/
    1.（跟信号项目有关）证据理论中用于求取Jousselme证据距离/
    10.对图像特征的分类随机森林算法是一类很好的算法/
    11.多个小球碰撞有背景颜色支持更换小球个数/
    12.仿真现代通信中应用/
    13.建模 人口增长模型 源程序/
    14.设计并仿真以下无线系统/
    15.神经网络30个案例分析/
    16.实现线性拟合和相关系数/
    17.实现学生成绩查询系统/
    18.夜间车牌识别程序/
    19.运动估计/
    2.BP网络/
    20.mimo信道模型MATLAB程序/
    21.mimo信道模型/
    22.s整数小波分解图像/
    23.表面等离子体共振的模拟，可以计算出共振峰的准确位置/
    24.层次分析法/
    25.积分和微分视频及例子/
    26.对图像特征的分类，随机森林算法是一类很好的算法/
    27.对噪声图像进行滤波仿真/
    28.多聚焦图像融合将两张到六张不同焦点的图片合成成一张/
    29.二进小波和非线性变换的图像增强/
    3.Elman神经网络预测数据/
    30.仿真里德-穆勒（Reed-Muller）码在AWGN信道中的性能，调制采用bpsk/
    4.GPS仿真程序/
    5.GPS卫星 L1波段的simulink仿真模型 包括CA码 载波 噪声/
    6.GPS信号捕获跟踪仿真/
    7.Laplace变换和逆变换/
    8.Locally Linear Embedding(LLE)的Matlab代码/
    9.太空之战程序/
3/
    1.给图片添加了正弦噪声，消除噪声/
    10.模式识别/
    11.在优化方面的程序/
    12.势场法路径规划/
    13.输DQM法输液管失稳MATLAB弹簧刚度变化求临界失稳流速/
    14.双PWM便片调速系统的仿真试验模型/
    15.给图片增加水印/
    16.通信仿真/
    17.图像处理实现直线识别拟合角平分线/
    18.图像去噪 滤波 锐化 边缘检测/
    19.相机标定,Tsai 算法/
    2.关于交流电机及其故障仿真，同步发电机故障诊断实验/
    20.字母识别/
    21.语音数字均衡器/
    22.噪声波形和功率绘图/
    23.有限差分法数值模拟弹性波动方程/
    24.遗传算法求解最优解最大值/
    25.遗传算法求多目标函数有无约束条件的最优解/
    26.一级倒立摆系统的PID控制，PID控制为双闭环控制，有较好的控制效果/
    27.阵列信号处理中的延迟相加、Capon、MUSIC、Root-MUSIC、ESPRIT算法的性能比较分析/
    28.光通过三稜镜色散动画模拟/
    29.复杂网络中聚类系数与关联系数/
    3.广义预测控制/
    30.中文字符的识别/
    4.灰度预测模型原始发电量预测发电量/
    5.交通系统MCM-案/
    6.粒子速度分布（可以跟碰撞球结合）/
    7.滤波器设计/
    8.蒙特卡洛法求椭圆面积代码/
    9.模拟surface plasmon的随着不同角度变化的电磁场分布/
4/
    1.元胞自动机/
    10.吉尔法求解点堆中子动力学方程/
    11.QPSK的锁相，用来进行QPSK通信系统的仿真和实际信号载波同步的提取/
    12.欧拉Euler法求解微分方程组/
    14.震源震动模拟/
    15.模拟一个ARMA模型，然后进行时频归并/
    16.BA无标度网络拓扑生成算法，BA模型有两个重要特性：增长特性和优先连接特性/
    17.lanczos算法用来计算大型稀疏矩阵的最大最小本征值及相应的本征矢量/
    18.实现蚁群算法的低压电力线设计/
    19.一个四维状态、二维观测的目标跟踪扩展卡尔曼滤波/
    2.一级倒立摆系统的PID控制，PID控制为双闭环控制，有较好的控制效果/
    20.天线圆周阵列_密度加权/
    21.拉格朗日插值/
    22..杜芬方程解的小程序，通过仿真曲线可以很容易的看到解的曲线/
    23.无线定位基本算法CHAN等/
    24实现不同插值方法的GUI界面设计/
    25实现偏微分方程的差分计算/
    26simpower仿真pmsm永磁同步电机/
    27.OFDM系统仿真框图能设置不同参数进行仿真/
    28.信号处理案例/
    29.移动侦测方面-move detect不成功/
    3.图像处理实现螺纹识别/
    30.GPS相关读取跟踪和捕获/
    4.负荷/
    5. GUI实现动态画图曲线/
    6.用滤波器和控制算法两种方法滤波/
    7.植物图像处理提取RGBHSI均值/
    8.无线传感器网络时间同步算法/
    9.基于动量叶素理论建立的风力机叶片设计，用于计算轴向和周向诱导因子/
5/
    1.关键帧提取参考光流法基于帧差的欧式距离均值方差差异系数/
    10..simulink卫星姿态控制系统模型/
    11.风力发电机PMSG模型设计，simulink仿真文件mdl/
    12.卡方检验不成功/
    13.文字连通域/
    14.基于仿射变换的数字图象置乱技术/
    15.波形发生器/
    16.利用BP网逼近某青霉素发酵过程没成功/
    17.专门用于计算频散现象各种功能函数都提供并且还有举例说明/
    18.经典的Gabor滤波器的源码/
    19.适用于高维方程组求解的牛顿迭代法算法函数，为工程计算和大型模型求解带来便利/
    2.上下文意识的显著性检测/
    20.实现了音乐信号处理中的恒Q变换(Constant Q Transformation)并得到频谱矩阵和语谱图/
    21.对图像进行频率域图像增强，计算并画出此图像的中心化频率谱，用拉普拉斯算子对此图像锐化/
    22.遗传算法采用二进制编码/
    23.Labview读写Matlab的Mat数据文件/
    24.OFDM系统的matlab simulink仿真框图，能设置不同参数进行仿真/
    25解复合材料层合板的问题实验不成功/
    26.三相并网逆变器，有电压环和电流环双环控制/
    27.利用Markov算法根据原始文本的统计规律生成随机文本，利用容器vector, map实现。包含详细测试数据/
    28.svpwm的matlab仿真/
    29.基于matlab的人脸检测K-L的人脸识别没成功/
    3.霍夫曼Huffman编码译码GUI界面设计/
    30.MATLAB最优化计算20例/
    4.设计的简单滤波器/
    5.基于卡尔曼滤波的运动目标检测/
    6.在线电机PMSM仿真模型（有无传感器）/
    7.matlab仿真通信原理FM系统文档总结以及文档程序/
    8.直方图拟合/
    9.能进行ofdma自适应资源分配未能运行成功/
6/
    1.基于移相全桥控制双向DCDC变换器仿真原理图/
    10.使用labview进行信号分析傅立叶变换和小波分析不成功/
    11.二维射线追踪程序地震声波正演源程序不成功/
    12.基于Relief算法的特征权重选择有效地选择出了权重数据不成功/
    13.特征选择以及小波变换方面的案例/
    14对图像用小波进行层小波分解MATLAB小波变换处理二维图像/
    15.IEEE30节点测试系统matlab M文件，包含各节点信息/
    16.空间无线信道建模程序matlab，考虑了多径延迟，多普勒效应，信号的角度扩展（拉普拉斯分布），MIMO，可以产生MIMO信道矩 阵没试验成功/
    17.小波变换图像处理MATLAB源程序/
    18.实现车牌识别包括定位分割和字符识别识别方法是神经网络未成功/
    19.说话人识别和确认系统研究声纹识别很好不成功/
    2.牛顿Newton插值/
    20.局部模糊c均值聚类算法/
    21.汽轮轨迹模拟为实验/
    22.mimo通信系统中空时编码处理matlab仿真没试验/
    23 GUI数据传递和多窗口编程/
    24.使用labview进行信号分析，傅立叶变换和小波分析不成功/
    25. matlab控制摄像头获取外界图像/
    26.PMSM仿真模型/
    27. MATLAB与Excel交互/
    28.matlab回归法做图像变化检测/
    29.计算GTD-UTD绕射源代码/
    30.多项式和非多项式曲线拟合/
    3关于惯性导航系统的使用工具箱,包括了各种函数的编写及使用说明，最重要的是先要安装此工具箱/
    4.实现链码提取内含测试图片及所用的算法不成功/
    5.基于分数阶微积分的分数阶傅里叶变换/
    6.遗传算法实现车间设备布局界面系统不成功/
    7.基于小波变换的三维模型提取技术未成功/
    8.光学项目案例/
    9.无模型自适应控制的matlab simulink模型不依赖系统模型的控制方法/
7/
    1.基于多尺度retinex算法的图像去雾能较好得去雾并保留原图色彩/
    10.初学者设计的matlab顶点问题着色问题gui解决，要求输入顶点个数，可计算色多项式，及染色方法/
    11.3机9节点系统暂态稳定计算程序/
    12.永磁同步电机的弱磁控制/
    13.卡尔曼滤波目标跟踪，卡尔曼滤波目标跟踪/
    14.MATLAB小波分析—张德丰/
    15.MATLAB求解非线性方程组 fsolve/
    16.平衡方程Matlab代码/
    17.sift算法的完整matlab程序稍加修改即可/
    18.人们之所以能够看到深度，是因为，来自三维世界的不同视角。本程序尝试从一个2D图像映射并计算对应的3D的距离/
    19.SIMULATION OF OPTICAL SYSTEM/
    2.PID对液位的控制未完全弄懂/
    20.LQR源程序/
    21.uic513标准的matlab算法。振动，分垂横纵3个方向，输入，经matlab算法得出振动舒适度的指标/
    22.基于matlab语言环境下的MA(1)模型的参数估计/
    23.多输入多输出系统的状态空间simulink模型获得阶跃响应/
    24.amesim和matlab simulink联合仿真设置方法及多个精彩例程/
    25.解抛物型方程的交替隐方向P-R差分格式的实现/
    27.BPSK的simulink仿真及其完整的参数设置频谱分析图和星座图/
    28. RPCA程序代码/
    29.MA的辅助工具源码,基于C。 需要的朋友可以通过这个软件对MA的程序结构和加密方法进行分析/
    3.单位功率因素校正（PFC）仿真/
    30.mfa/
    4.系统辨识及其MATLAB仿真/
    5.利用DCT变换对灰度图像进行压缩，求出压缩比；对比不同压缩比的图像/
    6.人工免疫系统中的反向选择算法/
    7.产生高斯随机粗糙面的函数 输入变量为点数 长度 相关长度 均方根高度/
    8..对高光谱图像数据进行分析没成功/
    9.分支定界法、割平面法、隐式枚举法的整数规划码/
    matlab算法十大算法源代码/
8/
    1.复杂网络中聚类系数与度度关联系数的matlab Clustering_Coefficient/
    10.fdtd/
    11.数学建模类/
    12.MATLAB寻找素数的源程序代码/
    13.将matlab的mat文件转化成labview中的波形文件，便于在labview中应用mat文件里的数据/
    14.colorbar的设置/
    15.AAA 与图像相关的项目案例（十四个）/
    16.pso/
    17.解复合材料层合板的问题实验不成功/
    18.地理统计学克里格插值/
    19.马尔科夫决策过程包括一些例程/
    2.可以用来计算MTF值数据文件需要为Excel格式/
    20.chow算法与campello算法的结合（OFDM技术）/
    21.adaboost分类器用于分类样本数据未完全明白/
    22.润滑理论的求解程序包括弹流和刚流润滑不成功/
    23.仿相环功能/
    24.控制系统代码&资源/
    25.遗传规划matlab工具箱，可以大大提高编程的效率/
    26.relief算法/
    27.竞赛/
    28.车辆检测不成功/
    29.绘制 维维安尼Viviani曲线/
    3.贝叶斯和通用阈值软阈值图像去噪未成功/
    30.VC  实现的二维小波变换用于图像去噪、压缩等/
    4.adrc源码/
    5.高等数学问题求解/
    6.预留子载波法(TR)降低PAPR/
    7.ldpc译码算法，码长960，码率0.5,完全模拟fpga硬件实现语言，量化处理/
    8matlab的GA工具箱与vc混和实现遗传算法/
    9.ocd函数 最优化的方法/
9/
    1.registration SAR图像和光学图像的配准算法/
    10.对小波块不同补零方式的不同结果/
    11.在matlab上生成数据波形文件，下载到安捷伦信号源中，直接用信号源的IQ调制功能回放波形/
    12.地统计学中的克里格插值法/
    13.渗流项目/
    14.电弧模型的建立与分析/
    15.车牌识别程序C++/
    16.潮流计算仿真/
    17.小波等多种方法去噪和信噪比成程序和本科毕设/
    18.脑血管检测项目/
    19.行人异常检测项目/
    2.图像水印/
    3.数字频带传输/
    4.利用matlab引入数据，对数据进行处理/
    5.实现爱尔兰B公式计算并输出表格/
    6.实现的深度学习算法/
    7.双凸轮传动变速器的MATLAB模型，6速双凸轮，带经济燃油评估，控制系统/
    8.步态识别代码视频序列ppt展示及相关文献/
    9.二代小波harr变换整数小波变换/
	
	密级：               年限：      
编号：               


电信科学技术研究院
 硕士研究生学位论文  




论文题目（中文）： 基于数字孪生的智能产线设计与实现                          
（英文）： Design and implementation of intelligent
 production line based on digital twin                                                        





作者：                
                 指导教师：            
                 日期：                
 
 
    
电信科学技术研究院
硕士研究生学位论文


论文题目（中文）： 基于数字孪生的智能产线设计与实现                            
 （英文）：Design and implementation of 
intelligentproduction line based on digital 
twin                                  
                   


作者：                      
指导教师：                  
学位类别：                  
学科专业：                  
所在单位：                  
学位授予单位：              
日期：                      
 
独创性（或创新性）声明
本人声明所呈交的学位论文是本人在导师指导下进行的研究工作及取得的研究成果，由本人独立撰写。尽我所知，除了文中特别加以标注和致谢中所罗列的内容以外，论文中不包含其他人已经发表或撰写过的研究成果。与我一同工作的同事对本研究所作的任何贡献均己在论文中作了明确的说明。
本学位论文经核准若有不实之处，本人承担一切相关责任。


关于论文使用授权的说明
本学位论文作者完全了解电信科学技术研究院有关保留和使用学位论文的规定，即：研究生在校攻读学位期间论文工作的知识产权属所在课题单位所有。学校有权保留并向国家有关部门或机构送交论文的原件或复印件，允许学位论文被查阅和借阅。关于保密的学位论文在解密后遵守此规定。


本人签名：                    日期：202412.10     

导师签名：                    日期：2024.12.10      


 
摘 要
信息技术的飞速发展正在推动传统制造业进行数字化转型。数字孪生技术通过创建物理实体的数字副本，在物理世界与数字世界之间实现无缝对接，对此转型至关重要。本论文聚焦于利用数字孪生技术设计和实现智能产线，旨在提高生产效率、降低成本、增强制造企业的竞争力。研究首先分析了数字孪生技术在智能产线中的当前状态，识别了挑战和改进领域。提出了智能产线的全面设计方案，包括需求分析、性能要求和系统架构设计，为构建高效、可靠和可扩展的智能产线提供了理论和实践基础。论文探讨了多源异构数据的采集与融合，提出了基于知识图谱的方法来整合和互操作不同的数据源，这对于构建准确的数字孪生模型至关重要。此外，还讨论了设备孪生建模和智能产线建模技术，包括几何建模、物理建模、行为建模、电气建模、数学建模、交互及接口建模和流水车间模型、混合流水车间模型。在产线监测与优化方面，论文引入了深度学习和强化学习方法来进行设备健康检测和调度优化。实验结果验证了这些方法在提高产线效率和设备健康水平、降低维护成本和故障风险方面的有效性。在系统实现与测试阶段，利用Unity 3D构建了智能产线的数字孪生可视化平台，实现了对智能产线的实时监控和动态仿真；采用SSM架构构建了数据中台，实现了对数据的跨时间、跨空间利用。这不仅增强了用户对产线运行状态的理解和控制，也为产线的优化提供了直观的决策支持。总结而言，本研究通过提出基于数字孪生的智能产线设计和实现框架，为制造业的数字化转型和智能化升级提供借鉴思考。尽管取得了一定成果，论文也承认了需要进一步研究的领域，如提高模型的精确性和实时性、提升数据分析效率、确保产线的安全性和可靠性、融合跨学科技术，以及开展更多的实际应用和案例研究。
关键词：数字孪生；智能产线；数据融合；调度优化；设备故障检测；深度学习；深度强化学习 
Abstract
The rapid development of information technology is propelling the traditional manufacturing industry towards digital transformation. Digital Twin technology, which creates digital replicas of physical entities, is crucial for achieving seamless integration between the physical and digital worlds during this transition. This thesis focuses on the design and implementation of intelligent production lines using Digital Twin technology, aiming to enhance production efficiency, reduce costs, and strengthen the competitiveness of manufacturing enterprises. The research begins with an analysis of the current state of Digital Twin technology in intelligent production lines, identifying challenges and areas for improvement. A comprehensive design scheme for intelligent production lines is proposed, including requirement analysis, performance requirements, and system architecture design, providing a theoretical and practical foundation for constructing efficient, reliable, and scalable intelligent production lines. The thesis explores the collection and integration of multi-source heterogeneous data, proposing a knowledge graph-based approach to integrate and interoperate different data sources, which is essential for building accurate Digital Twin models. Additionally, the thesis discusses device twin modeling and intelligent production line modeling techniques, including geometric modeling, physical modeling, behavioral modeling, electrical modeling, mathematical modeling, interaction and interface modeling, and flow shop models, hybrid flow shop models. In terms of production line monitoring and optimization, the thesis introduces deep learning and reinforcement learning methods for equipment health detection and scheduling optimization. Experimental results validate the effectiveness of these methods in improving production line efficiency and equipment health levels, reducing maintenance costs and failure risks. During the system implementation and testing phase, a Digital Twin visualization platform for intelligent production lines was constructed using Unity 3D, achieving real-time monitoring and dynamic simulation of intelligent production lines; a data middleware was built using the SSM architecture, enabling the cross-temporal and cross-spatial utilization of data. This not only enhances users' understanding and control of the production line's operational status but also provides intuitive decision support for optimization. In summary, this research presents a Digital Twin-based intelligent production line design and implementation framework, offering insights for the digital transformation and intelligent upgrading of the manufacturing industry. Despite the achievements, the thesis acknowledges areas for further research, such as enhancing model accuracy and real-time performance, improving data analysis efficiency, ensuring production line safety and reliability, integrating interdisciplinary technologies, and conducting more practical applications and case studies.
Keywords: Digital Twin; Intelligent Production Line; Data Fusion; Scheduling Optimization; Equipment Fault Detection; Deep Learning;Deep Reinforcement Learning

 
目 录
第一章 绪论	1
1.1研究背景及意义	1
1.1.1 研究背景	1
1.1.2 研究意义	2
1.2国内外研究现状	3
1.2.1 国外研究现状	3
1.2.2 国内研究现状	4
1.3主要研究内容与章节安排	5
1.3.1 研究内容	5
1.3.2 章节安排	6
第二章 数字孪生智能产线总体设计	6
2.1 需求分析	6
2.2 性能要求	8
2.3 架构设计	9
第三章 产线数据采集与模型建立	10
3.1 多源数据采集	10
3.2 异构数据融合	12
3.3 设备孪生建模	14
3.4 智能产线建模	25
3.4.1 产线流水线模型	25
3.4.2 混合流水线模型	26
第四章 产线设备检测与调度优化	27
4.1 产线设备故障检测	27
4.1.1 设备数据采集与增强	29
4.1.2 基于卷积神经网络的故障检测	31
4.1.3 基于循环神经网络的故障检测	32
4.1.4 基于自注意力机制的故障检测	35
4.1.5 模型评估	37
4.2产线调度优化	38
4.2.1 基于均值聚类划分父本母本的遗传调度方法	38
4.2.2 基于深度强化学习和多瞥见机制的调度方法	49
4.2.3 基于遗传算法的混合流水线调度方法	56
第五章 系统实现	58
5.1 设备模型建立	58
5.2 数据中台建立	61
5.3 算法接口设计	65
5.4 产线模型建立	67
第六章 总结与展望	71
6.1 论文总结与结论	71
6.2 不足与未来展望	72
缩略语表	74
参考文献	75
致 谢	79
 














第一章 绪论
1.1研究背景及意义
1.1.1 研究背景
随着信息技术的飞速发展，我们正站在一个新时代的门槛上，数字化技术正以前所未有的速度渗透到传统制造业中。在这个背景下，各国纷纷出台战略计划，如中国的“中国制造2025”和德国的“工业4.0”，旨在通过数字化转型推动制造业的升级[1]。在这一转型过程中，数字孪生技术扮演着至关重要的角色，它不仅是一种技术趋势，更是制造业未来发展的关键。
数字孪生技术的核心在于创建一个物理实体的数字副本，这个副本能够实时反映实体的状态，实现物理世界与数字世界的无缝对接。这种技术最早起源于NASA的APOLLO 13计划，当时为了解决无人机的系统问题，NASA在地面构建了一套与无人机完全相同的物理模型进行模拟和预测[2]，这便是数字孪生的雏形。
如今，数字孪生技术已经从最初的航天领域扩展到了更广泛的工业应用。它通过集成传感器、大数据、人工智能、数学建模、云计算等技术理论，使得我们能够在虚拟空间中对物理设备、实体产品和生产过程进行精确的模拟和优化。这种技术的应用，不仅能够提高生产效率，降低成本，还能通过预测性维护减少意外停机，提高产品的可靠性和安全性[3]。
在智能制造领域，数字孪生技术的应用尤为突出。它能够实现生产过程的数字化管理，通过虚拟模型模拟产品的设计、制造和运维全流程，实现全生命周期的管理。这不仅减少了物理样机的制造次数、时间和成本，还能通过实时监控和优化，提高生产线的运行效率和产品质量[4]。
数字孪生技术的发展，也带来了对智能产线的新理解。智能产线不再仅仅是自动化和信息化的简单组合，而是通过数字化技术和先进制造技术手段，实现生产过程的智能化、自动化和高效化。智能产线通过集成先进的传感器和软件系统，能够实时收集和分析生产数据，洞察生产过程中的瓶颈与隐患，不仅能够实现对产线设备及产线整体状态的数字化实时孪生映射，而且能够实时响应市场变化，灵活调整生产计划，实现个性化定制和批量生产的最佳平衡[5]。这种智能化、自适应的生产模式，不仅降低了运营成本，还增强了企业的市场竞争力。
然而，尽管数字孪生技术展现出巨大的潜力，我们对如何基于这项技术进行智能产线的设计与实现，仍然有许多未知之处。这包括如何确保孪生模型的精准性、数据的有效性、交互的实时性和全面性，以及如何构建一个通用的、公共的数字孪生工业软件平台，这些都是未来研究和实践需要解决的问题[6]。
总之，数字孪生技术正成为智能制造的新引擎，它不仅推动了制造业的数字化转型，也为制造业的未来发展打开了新的可能性。随着技术的不断进步和应用的深入，我们有理由相信，数字孪生技术将为制造业带来一场深刻的变革。
1.1.2 研究意义
如今，智能制造和工业自动化逐渐成为全球制造业的重要发展趋势。数字孪生技术以其独特优势，为智能产线的实现提供了新的解决方案。本课题将研究基于数字孪生的智能产线设计与实现，对于推动我国制造业转型升级，提高生产效率、降低成本、优化资源配置以及增强企业竞争力具有重要意义[7]。以下是本论文的具体研究意义：
提高生产效率：数字孪生技术可以实时模拟和监测产线的运营情况，帮助发现生产过程中的瓶颈和问题，提供相应的优化方案，减少生产线的停机时间和浪费，提高生产效率。
降低成本：通过数字孪生等相关技术，可以对产线的各个环节进行精确的模拟和优化，从而降低生产过程中的资源浪费和成本。首先，通过优化生产流程和减少生产浪费，可以显著降低生产成本。其次，数字孪生等技术可以利用虚拟仿真技术进行产品设计和测试，从而减少试制和调试成本。此外，数字孪生技术还可以通过对设备的远程监控和维护，降低运维成本。
优化资源配置：数字孪生等技术可以对产线的资源进行实时分析和优化。通过模拟和分析各个生产环节的资源需求和利用情况，可以更加科学地进行资源分配和调度。例如，通过数字孪生等技术可以预测设备的使用情况和需求，从而提前进行资源调度和储备，避免资源的浪费和短缺。
提升质量和安全性：数字孪生可以实时监测产线的运营状态，及时发现潜在的质量问题和安全隐患，并采取相应的措施进行预防和修复。这可以提高产品质量，保障员工的安全。
推动工业转型升级：智能产线是工业4.0时代的重要组成部分，通过数字孪生等技术的应用，可以推动传统制造业向智能制造的转型升级。这对于提升国内制造业的竞争力，推动经济发展具有重要意义。
增强企业竞争力：基于数字孪生的智能产线设计与实现可以增强企业的竞争力。首先，通过数字孪生技术可以提升企业的生产和管理效率，降低成本，使得企业在市场上更具有竞争力。其次，数字孪生等技术的应用可以提升企业的研发能力，帮助企业更快地适应市场变化和技术革新。此外，数字孪生技术的应用还可以提高企业的信息化水平，增强企业的数字化转型能力。
在数字孪生技术的应用实践中，我们可以看到，无论是在产品设计、生产过程优化，还是在设备维护和健康管理方面，数字孪生技术都展现出了巨大的潜力。它不仅能够提高生产效率和产品质量，还能够降低成本和资源消耗，优化资源配置，提升企业的竞争力。随着技术的不断进步，数字孪生技术的应用领域也在不断扩展。从航空航天、汽车制造到医疗设备，数字孪生技术正在成为推动制造业数字化转型的关键力量。未来，随着物联网、大数据、人工智能等技术的进一步融合，数字孪生技术将在全球制造业中发挥更加重要的作用，为智能制造带来更多的可能性。
1.2国内外研究现状
数字孪生的概念最早于 2002 年被 Grieves 教授提出。2010年，NASA在技术报告中首次给出了“Digital Twin”的名称，即“数字孪生”。后来美国国家航天局 （NASA）将数字孪生概念应用在阿波罗计划中的飞行器上，将其列为驱动未来发展的关键术之一[8-9]。伴随着智能产线概念在制造业的应用，数字孪生日益受到工业界和学术界关注，数字孪生技术基于数据、模型和服务等方面的优势也日益得到凸显。在国内外，越来越多的企业和研究机构开始关注数字孪生技术在智能产线中的应用，并开展了一系列的研究和实践。以下是一些国内外研究现状的概述。
1.2.1 国外研究现状
在全球化的背景下，数字孪生技术已经成为智能制造和工业自动化领域的一个重要趋势。美国、德国和日本等发达国家在这方面的研究和应用处于领先地位，它们在数字孪生技术、仿真技术、物联网技术、数据挖掘技术等领域展现出了强大的技术实力和成熟度[10]。
德国的工业4.0倡议是全球智能制造的标杆之一，它推动了智能产线和数字孪生的研究与应用，并取得了显著成果。德国企业如西门子，通过MindSphere平台，将数字孪生技术融入到工业互联网中[7]，实现了设备运行的监控和优化。西门子的数字孪生解决方案不仅涵盖了产品设计，还扩展到了生产制造规划，形成了从概念到实施的闭环数字线程，即“数字孪生体绩效”，特别在智能产线建设方面表现出色[10-11]。
美国作为科技创新的领头羊，其大型制造企业如通用电气（GE）在数字孪生和智能产线方面进行了深入研究。GE推出的Digital Twin解决方案，通过采集设备在现实世界中的实时数据，并与虚拟世界中的模型进行比较和优化，显著提高了设备的运行效率和降低了维护成本。这种技术的应用，使得GE在燃气轮机、飞机引擎等领域实现了产品的实时监测和预测性维护[12-15]。
欧洲的研究机构和大学也在数字孪生和智能产线方面进行了广泛的研究。他们探索了数字孪生技术在产线设计和生产管理中的应用，为工业转型和智能制造提供了理论和实践支持。例如，空客公司在飞机组装过程中使用数字孪生技术提高自动化程度并减少交货时间，特别是在碳纤维增强基复合材料机身结构的组装中，通过数字孪生技术的大型配件装配系统，对装配过程进行自动控制以减少剩余应力[16-17]。
此外，数字孪生技术的发展也带来了新的合作模式。例如，德国成立了“工业数字孪生体协会”，汇集了包括ABB、博世、西门子等20家企业，共同推进数字孪生技术的发展。这种跨行业的合作，不仅加速了技术的创新，也为数字孪生技术的应用提供了更广阔的平台[18-19]。
1.2.2 国内研究现状
在国内，随着工业互联网时代的到来，数字孪生智能产线的设计与实现也受到了广泛关注。我国政府和企业对数字孪生技术的研究和应用也投入了大量资金和人力资源。例如，中国航空发动机集团已经在生产中应用了数字孪生技术，通过构建发动机的数字孪生体，实现对发动机运行的实时监控和优化，从而提高了发动机的性能和可靠性[20-21]。此外，国内一些知名企业如华为、腾讯、阿里巴巴等也纷纷投入数字孪生技术的研究和应用，推动工业互联网的发展[22]。中国科学院自动化研究所的研究团队在智能产线的数字孪生建模与仿真方面取得了一些重要成果。他们通过建立车间的数字孪生模型，实现了对生产过程的实时监测和优化[23]。中国工程院的专家们也开展了一系列关于智能产线和数字孪生的研究，他们提出了一种基于物联网和云计算的智能产线架构，并探索了数字孪生技术在产线设计和运营中的应用[24]。北航陶飞研究并改进了数字孪生建模准则和理论体系，提出了数字孪生五维模型，并对数字孪生在各个领域的应用提出了一定的参考[25]。
国内外在基于数字孪生的智能产线设计与实现的研究方面都取得了一些进展。然而，仍然存在一些挑战和待解决的问题，例如如何提高数字孪生模型的精确性和实时性、如何构建高度描述物理产线的数据模型或数学模型、如何实现更加高效的数据分析和处理、以及提升智能产线的安全性和可靠性等[26-27]。未来的研究可以进一步深化对数字孪生和智能产线的理解，并探索更加创新和有效的应用方法。
1.3主要研究内容与章节安排
1.3.1 研究内容
文章深入探讨了数字孪生技术在智能产线设计和实现中的应用，包括其在生产过程的智能化、自动化和高效化中的作用。数字孪生技术通过创建物理实体的数字副本，实现对产线设备及产线整体状态的实时映射和优化。首先是研究了基于数字孪生技术的智能产线总体设计方案，包括需求分析、性能要求和系统架构设计。这为构建高效、可靠和可扩展的智能产线提供了理论基础和实践指导。其次探讨了多源异构数据采集的架构方法，并对智能产线的模型进行建模，包括物理模型、数据模型、数学模型。特别提出了一种基于知识图谱的多源异构数据融合架构和方法论，为数据集成和互操作性提供借鉴参考。之后提出了基于深度学习和基于遗传算法、基于强化学习的智能产线设备健康检测和调度优化方法。研究的方案包括基于卷积神经网络（Convolutional Neural Network, CNN）、门控循环单元（Gated Recurrent Unit, GRU）、长短期记忆网络（Long Short-Term Memory, LSTM）、自注意力机制（Self-Attention）来对设备的轴承进行健康诊断，还提出了2种方案来实现智能产线的调度优化，包括基于K均值聚类（K-Means Clustering, K-Means）划分父本母本的方法以及基于深度强化学习（Deep Reinforcement Learning, DRL）和多瞥见机制（Multi-Glimpse Mechanism, MGM）的方法。通过实验验证，这些方法能够有效地提高产线的运行效率和对设备的健康水平进行评估，降低了维护成本和故障风险。对于系统实现与测试，本论文利用Unity 3D构建了智能产线的数字孪生可视化平台，使用SSM框架（Spring+SpringMVC+MyBatis, SSM）构建一数据中台，实现了对智能产线的实时监控和动态仿真。这提高了用户对产线运行状态的理解和控制，也为产线的优化提供了直观的决策支持。最后文章还对数字孪生技术的未来发展趋势进行了探讨，包括智能化、多模态化、联网化等方向，这些趋势将推动数字孪生技术在智能产线中的应用更加广泛和深入。
	章节安排
本文共分六章，全面探讨基于数字孪生的智能产线设计与实现。第一章绪论，阐述研究背景与意义，分析国内外研究现状，明确研究目标与技术路线图。第二章数字孪生智能产线总体设计，深入需求分析，提出性能要求，构建系统架构设计，为后续实践奠定基础。第三章产线数据采集与模型建立，探讨多源异构数据采集、融合，以及数字孪生建模方法，强调知识图谱在数据融合中的作用。第四章产线设备检测与调度优化，介绍基于深度学习和遗传算法、强化学习的设备健康检测与调度优化方法，通过实验验证其有效性。第五章系统实现，利用Unity 3D和SSM实现智能产线的数字孪生平台，展示实时监控和动态仿真能力。第六章总结与展望，总结研究成果，讨论不足，并对未来研究方向提出建议，包括模型精确性提升、跨学科技术融合等，以期为制造业数字化转型提供持续动力。
第二章 数字孪生智能产线总体设计
2.1 需求分析
基于数字孪生的智能产线代表了制造业的未来趋势，它通过创建物理产线的虚拟副本，实现对生产过程的实时监控、优化和预测。然而，在推广和实施数字孪生技术的过程中，企业和行业面临着一系列需求和痛点[28-33]。
一是多源异构数据的采集和集成，智能产线需要集成融合来自多个来源的数据，包括传感器、设备、系统等，以构建准确的数字孪生模型。不同设备和系统之间的数据格式和协议可能不一致，导致数据集成困难。为了实现这一点，必须采用先进的数据集成技术，如数据融合、数据转换、数据映射等，以确保不同来源的数据能够被有效地整合在一起。这涉及到对数据的预处理、清洗、标准化和融合，以消除数据不一致性和格式差异，从而实现数据的互操作性和一致性。通过这些措施，可以构建一个全面、准确和可靠的数字孪生模型，为智能产线的优化和决策提供强有力的数据支持。
二是需要确保系统的实时性和准确性。数字孪生系统的实时性需求是指系统必须能够及时捕捉、处理和分析来自物理世界的数据，并在虚拟世界中提供即时反馈和响应，准确描述物理产线的实时状态。这种实时性对于数字孪生系统的功能至关重要，因为它直接影响到系统的效能和应用价值。而这又包括：数据采集的实时性、数据处理和分析的实时性、决策和响应的实时性、可视化和监控的实时性、预测和模拟的实时性、交互和协作的实时性等。为了满足这些实时性需求，数字孪生系统通常依赖于高速网络连接、边缘计算、高性能计算机、云计算和先进的数据处理技术。这些技术确保了数据的快速传输和处理，以及对物理实体的即时反馈和控制，从而提高了生产效率、减少了停机时间，并增强了整个系统的适应性和韧性。
三是建模技术单一，不同领域的建模技术难以融合，如三维模型、物理模型、数据模型、数学模型。数字孪生建模需要确保虚拟模型能够准确地代表和模拟其对应的物理实体或系统。这一过程涉及到创建高度详细和精确的数字副本，以便能够在虚拟环境中进行有效的分析、预测和优化。而这包括精确的几何建模、数学和行为建模、模型动态和实时更新、多尺度和多物理场建模、历史数据和未来趋势建模等。这些方面的建模所采用的建模技术相互隔离，工具也大不相同，如何融合这些不同方面的建模技术及工具以完整全面的描述及展示数字孪生智能产线是目前研究的一大热点。
四是产线的多样化及个性化，不同的产线有着不同的入口材料及出口产品，这往往意味中间的各个环节的生产加工及交互接口大相径庭。对于技术人员来说，不同的产线往往需要不同的理论及技术来建模，而这大大加大了建模过程中的人员及成本。所以目前关于智能产线的数字孪生模型的建立迫切需要一个通用的理论及方法集，这对于加速我国工业智能制造转型具有重大意义！本论文将针对一印章生产线进行数字孪生建模。
五是可扩展和灵活性，随着智能产线上的产品及设备的迭代升级，需要其数字孪生系统同步更新以来确保系统能够适应不断变化的业务需求和技术进步，这又对数字孪生系统提出了更高要求。这包括需要模块化设计、多尺度和多层次建模、支持多种数据源和格式、可伸缩的计算资源、跨平台和跨区域操作、易于维护和升级等几大部分。
2.2 性能要求
基于数字孪生的智能产线是一种先进的制造模式，它利用数字孪生技术来优化生产流程、提高效率和质量，并实现更好的资源管理。这种产线的性能要求通常包括[34-37]：
高精度监控：智能产线需要能够通过数字孪生模型实时监控生产过程中的各种参数，如温度、压力、速度等，确保生产活动按照预定标准进行；
实时数据分析和反馈：产线应具备实时数据分析的能力，能够快速识别生产过程中的异常情况，并提供即时反馈，以便采取相应的调整措施；
预测性维护：利用数字孪生模型进行预测性维护，通过分析历史数据和实时数据来预测设备故障，从而提前进行维护，减少停机时间；
资源优化配置：智能产线需要有效地管理和分配资源，包括原材料、能源和人力，以实现生产效率的最大化和成本的最小化；
灵活的生产调整：产线应能够快速适应生产需求的变化，包括产品变更、订单调整等，以保持生产活动的连续性和高效性；
质量控制：通过数字孪生模型对生产过程进行质量控制，确保产品质量符合标准，及时发现并解决质量问题；
追溯和透明度：智能产线需要提供完整的产品追溯能力，记录每个生产环节的详细信息，以提高供应链的透明度和产品的可信度；
用户交互和操作友好性：产线的操作界面应直观易用，使操作人员能够轻松管理和控制生产过程，同时支持与专业人员的协作和沟通；
可扩展性和可升级性：随着技术的发展和生产需求的变化，智能产线应具备良好的可扩展性，能够容易地添加新的功能或升级现有系统。
基于数字孪生的智能产线需要通过集成先进的传感器、通信技术、数据处理和人工智能来实现上述性能要求，从而提升企业竞争力。
2.3 架构设计
在基于数字孪生的智能产线总体设计中，系统架构设计是构建高效、可靠和可扩展生产线的基础。一个良好的系统架构能够确保数据流动的顺畅、系统的稳定运行以及各个组件之间的有效协同。以下是智能产线系统架构设计的关键组成部分：
 
图2-1  数字孪生智能产线总体架构图
设备层：基于数字孪生的智能产线的设备层是整个系统中最接近物理实体的部分，它包括生产线上的所有实际设备和机器及物料等，如机器人、传送带、自动化装配线、检测设备等。这一层的主要作用是执行具体的生产任务，同时也是数字孪生系统中数据采集和实时监控的基础。
数据采集与存储层：基于数字孪生的智能产线的数据采集与存储层是整个数字孪生系统的核心组成部分，它负责从生产线的物理设备中收集数据，并对这些数据进行初步处理和存储，为后续的建模及分析和决策提供支持。采集的数据主要来自传感器和执行器，部署在生产线各个关键环节的传感器用于实时采集设备状态、工艺参数、产品质量等数据，执行器则用于根据机器控制指令在相应的孪生模型中实现实时的映射。而在生产线的近端部署边缘计算节点，进行数据的预处理、清洗和临时存储，以减少数据传输的延迟和网络负载。
数字孪生模型层：基于数字孪生的智能产线的数字孪生模型层也是整个系统的核心，它是一个虚拟的、高度精确的、实时更新的数字副本，用于模拟和反映物理产线的状态和行为。这一层的主要作用是对生产过程进行虚拟化，以便于进行分析、预测、优化和决策支持。主要的模型包括：设备三维模型、设备物理模型、设备行为模型、设备电气模型、特定功能的大数据模型、算法数学模型、产线模型等。
应用服务层：基于数字孪生的智能产线的应用服务层是数字孪生技术满足用户需求，提供服务的层次，它将数字孪生模型层的数据分析和模拟结果转化为实际的业务应用和决策支持。这一层为用户提供了一系列的工具和服务，以实现生产过程的优化、自动化和智能化。主要包括：生产调度、质量控制、物料管理、可视化监控、设备预测性维护、生产数据分析、性能监控和生产报告等应用。
用户交互层：基于数字孪生的智能产线的用户交互层是系统与操作员、工程师、管理人员等用户之间沟通的桥梁。这一层的设计和实现对于确保数字孪生技术的有效应用至关重要，因为它直接影响用户的体验和系统的易用性。这需要提供直观的界面，用于监控生产线状态、输入操作指令和接收报警信息。还有就是仪表板和生产报告，这可以提供综合的生产指标和关键性能指标的可视化展示，为相关人员提供决策支持。
第三章 产线数据采集与模型建立
在智能产线的背景下，多源异构数据采集是指从不同的数据源获取并整合多种类型的数据。这些数据源可能包括生产设备、传感器、企业信息系统、外部环境、监测设备等，而数据类型可能涵盖结构化数据、半结构化数据和非结构化数据。多源异构数据的采集和融合对于构建全面、准确的数字孪生模型至关重要。而数据源有多源和异构两个特性[38-39]。
3.1 多源数据采集
在现代工业环境中，数据源的多样性是一个显著特点。例如生产设备：包括各种机床、机器人、传送带等，它们可以提供关于生产速度、产量、设备状态等的数据[40]；传感器网络：温度、压力、湿度等环境传感器，以及用于监测产品质量的视觉和声音传感器；企业信息系统：ERP（企业资源规划）、MES（制造执行系统）、SCM（供应链管理）等系统提供订单、库存、物流等信息；外部数据：市场趋势、原材料价格、天气预报等外部环境信息。
这些不同的数据源往往采用不同的通信协议来传递信息，在智能产线和工业现场中，常用的通信协议包括但不限于以下几种：
	Modbus是一种串行通信协议，广泛应用于工业环境中，支持传统的RS-232、RS-422、RS-485和以太网设备；
	Profibus是一种基于现场总线的标准化工业通信协议，用于电气设备之间的数字通信，并且独立于制造商；
	EtherNet/IP是基于CIP的工业以太网协议，用于实现设备间的数据交换；
	OPC UA是一种跨平台、跨语言的服务导向架构，用于实现不同工业系统和设备之间的互操作性；
	TCP/IP 和 UDP两种协议是互联网的基础，也被广泛应用于工业通信，尤其是在以太网环境中。
 
图3-1  工业数据格式和通信协议
这些通信协议在智能产线和工业自动化中扮演着至关重要的角色，它们确保设备之间的有效通信和数据交换，从而实现自动化和智能化的生产流程。
对多源数据的采集，第一需要识别数据源确定数据格式，而一般的数据其前面几个字节就是标识数据格式的，这需要一个强大的解析库以支持解析不同的文件格式；其次是需要适配不同的通信协议接口，这需要一个强大的智能网关来支持不同的协议，可能还需要对协议进行多次转换才能达到目标。以下是一些关键步骤和方法：
	数据源识别：首先要识别数据源，确定该数据源产生数据的格式、频率及大小。
	通信协议适配：对于使用不同通信协议的数据，需要开发或使用协议转换器，以便不同协议之间能够兼容。也可以利用中间件如消息队列和发布/订阅系统来管理和协调不同协议下的数据流。
3.2 异构数据融合
不同数据源一般采用不同通信协议，这些通信协议承载着工业现场、传感器、外部信息网络、企业管理与生产的数据。可以说数据本质来说就是二进制码，就是字节流，只是因为不同的目的用途导致了不同的诠释和不同的解读，也只有特定的
诠释和解读才能让数据成为有用的数据，成为支持决策的依据。不同的解读从广义上来说导致了数据的异构性，数据的异构性体现在数据格式和内容上的差异。例如：
	结构化数据：通常存储在关系数据库中，如订单信息、库存记录等。
	半结构化数据：如XML、JSON等格式的数据，它们具有一定的结构，但不如关系数据库那样严格。
	非结构化数据：包括文本、图片、视频等，这些数据缺乏预定义的数据模型，处理起来更为复杂。
不同的解读从狭义上来说就是数据的文件格式。这里对工业现场的数据进行一些简单的分类，我们将数据分为图片文件、视频文件、文本文件、键值对、专用文件。
 
图3-2  工业现场数据文件格式
对于这些异构的数据，需要进行清洗和预处理，需要定义不同的存储格式及存储空间，以便后续对数据进行融合建模。
在智能产线设计与实现的过程中，异构数据建模是一个关键环节。异构数据建模是指将异构数据融合到一个统一的数据模型中，以便进行有效的数据分析和决策支持。对于普通的文本、代码等文件我们需要NLP技术、大模型技术来提取知识；对于图片和视频我们需要人工智能、图像处理、目标检测等方法来提取知识；而对于一些控制指令下发和报警上报等的流式的数据我们需要相关代码嵌入工控系统里面来提取知识；对于这些不同数据源所提取的实体行为或知识，我们需要对其进行知识融合，避免信息孤岛，打通信息通路，提高决策效率及质量，而这就要用到知识图谱技术。为此，本文提出一种多源异构数据融合的架构和方法论，如下图所示：
 
图3-3  多源异构数据融合架构图
其中我们从多源数据中进行数据采集和协议解析得到原始字节流或比特流数据，这些数据多半是异构的，可能包括结构化数据（如数据库）、半结构化数据（如API文档）、非结构化数据（如文本、图像等）。我们需要进行文件预处理及解析得到确知数据，包括去除噪声、格式统一、编码转换等。然后根据确知数据的数据特点采用合适的实体抽取算法识别出实体（如人名、地点、组织等），如视频应采用深度学习目标识别的方法，文本数据应采用命名实体识别、大语言模型的方法。之后需要进行关系抽取，明确该数据中的实体与实体之间的关系，包括主客关系、包含与被包含的关系等。然后将实体和关系表示为结构化的形式，通常是三元组（实体1，关系，实体2）的形式，以便于存储和查询。其次需要对不同数据抽取的实体及关系数据进行知识融合，解决数据冲突和不一致性问题，形成统一的知识库，这需要用到人工智能、知识推理等技术。将融合后的知识存储在图数据库或其他形式的知识库中，以便于检索和分析。最后就是知识利用，需要专业人员从图数据库中调取和发掘相关知识来支持决策。而这些知识的深浅不一，链接的实体数量也不一样，需要大数据技术来支持。
在实际应用中，多源数据融合的难点在于处理数据的异构性和不一致性，以及如何高效准确地抽取实体和关系。此外，知识图谱的构建和应用还需要考虑数据的隐私和安全性问题。随着技术的发展，越来越多的机器学习和深度学习方法被应用于知识图谱的构建和优化中，以提高数据融合的自动化和智能化水平[41-43]。本文只提出一种架构和方法论，具体实施需要AI、人工智能、大语言模型来参与。
3.3 设备孪生建模
现在的商用市场对数字孪生的使用与理解大多停留在可视化阶段，也就是根据实际场景做三维动画，并不能深层次、多层次反映物体，对物体孪生镜像。所以迫切需要整合融入多种建模技术，以达到全方面、多层次、细粒度地镜像甚至推演物理实体或场景。
数字孪生建模不仅仅是对物理实体的简单复制，而是一个动态的、可交互的、多维度的虚拟模型。它能够实时反映实体的状态，预测未来的行为，并提供决策支持。在产线中，孪生体可以是一台设备、一个数据模型、一个工作站、甚至整个生产线。
 
图3-4  物理对象的特征描述
面向对象的多模态融合建模是一种先进的技术，它结合了面向对象建模的系统性和多模态建模层次及方法的丰富性。这种建模方法不仅关注特定物体的高层次抽象建模，还考虑了关于物体的不同方面的描述方式方法的异质性，以使得建立的模型更加充分的表示和描述物理世界的实体，并在此基础上进行一定层次的演绎。主要有几何建模：也就是对物理实体进行3D模型建立，这可以采用3D建模软件；物理建模：对模型的3D模型赋予相应的物理属性，如材质、颜色、重力、强度等，这可以采用相关仿真软件；电气建模：也就是对设备的静态电气特征和动态电气特征进行描述建模，主要包括电压、电流、功率、噪声水平、振动水平等；行为建模：行为建模是指创建一个能够反映实体行为特征的模型；数学建模：用数学模型及公式描述实体；交互接口建模：对于设备与设备之间以及人与设备之间的交互，需要建立相应的交互模型以完成整个生产流程；其中电气建模将在第四章进行阐述，几何建模和物理建模将在第五章系统实现进行阐述，下面进行行为建模、数学建模和交互接口建模。
对于上述六轴机械臂的行为建模来说，可以采用有限状态机（Finite State Machine，FSM），FSM需要考虑机械臂的多种操作状态以及这些状态之间的转换条件。FSM通常包括一系列状态和触发状态转换的事件。以下是一个六轴机械臂FSM的状态：
	初始化（Initialized）：机械臂处于断电或重置状态，所有关节角度为零或预设的安全位置。
	待机（Idle）：机械臂已上电，系统准备就绪，等待用户输入或程序指令。
	编程（Programming）：用户正在输入或修改机械臂的运动程序。
	校准（Calibrating）：机械臂正在进行零点校准或其他形式的标定。
	紧急停止（Emergency Stop）：由于安全原因，机械臂被紧急停止。
	手动操作（Manual Operation）：操作员通过手动控制机械臂的每个关节。
	自动操作（Automatic Operation）：机械臂根据预设程序自动执行任务。
	错误（Error）：机械臂检测到错误或异常情况，需要干预。
	维护（Maintenance）：机械臂处于维护模式，进行定期检查或维修。
状态机转换条件为：
	[*] --> Initialized: 机械臂启动时，进入初始化状态。
	Initialized --> Idle: 自检完成后，进入待机状态。
	Idle --> Programming: 用户选择编程模式时，进入编程状态。
	Idle --> Calibrating: 用户选择校准时，进入校准状态。
	Idle --> EmergencyStop: 紧急停止触发时，立即停止所有操作。
	Idle --> ManualOperation: 用户选择手动操作时，进入手动操作状态。
	Idle --> AutomaticOperation: 用户启动自动操作程序时，进入自动操作状态。
	Idle --> Maintenance: 用户选择进入维护模式时，进入维护状态。
	Programming --> Idle: 编程完成或用户取消编程时，返回待机状态。
	Calibrating --> Idle: 校准完成或用户取消校准时，返回待机状态。
	EmergencyStop --> Idle: 紧急情况解除后，返回待机状态。
	ManualOperation --> Idle: 用户停止手动操作后，返回待机状态。
	AutomaticOperation --> Idle: 自动操作完成或用户中断自动操作后，返回待机状态。
	Error --> Idle: 错误被解决后，返回待机状态。
	Maintenance --> Idle: 维护完成后，返回待机状态。
	Programming --> Error: 编程过程中出现错误时，进入错误状态。
	Calibrating --> Error: 校准失败时，进入错误状态。
	ManualOperation --> Error: 手动操作中出现错误时，进入错误状态。
	AutomaticOperation --> Error: 自动操作中出现错误时，进入错误状态。
状态转换图如下所示：
 
图3-5  六轴机械臂行为建模-有限状态机
对于上述六轴机械臂的数学建模来说，可以构建一个六轴机械臂的运动学正逆解的数学模型，在一个直角坐标系中有如下旋转矩阵：
绕x轴旋转θ_x
R_x (θ_x )=[■(1&0&0@0&cosθ_x&sinθ_x@0&-sinθ_x&cosθ_x )]             （式3-1）
绕y轴旋转θ_y
R_y (θ_y )=[■(cosθ_y&0&-sinθ_y@0&1&0@sinθ_y&0&cosθ_y )]             （式3-2）
绕z轴旋转θ_z
R_z (θ_z )=[■(cosθ_z&sinθ_z&0@-sinθ_z&cosθ_z&0@0&0&1)]             （式3-3）
在几何学中，任何一个坐标系w，可以通过三个以上基础旋转，唯一变换到另一个同原点的坐标系w^'，两个关系可以用按照变换的先后顺序左乘表示，如下所示。
[■(X_(w^' )@Y_(w^' )@Z_(w^' ) )]=R_x (θ_x ) R_y (θ_y ) R_z (θ_z )[■(X_w@Y_w@Z_w )]          （式3-4）
在三维空间里，如果有两个坐标系F0，F6，如果想知道P在F6系中的向量（或者点坐标）在F0系中是多少，可以表示如下：
P_0=R_06*P_6+t_0                  （式3-5）
[■(X_0@Y_0@Z_0 )]=[■(*&*&*@*&*&*@*&*&*)]×[■(X_6@Y_6@Z_6 )]+[■(d_(X_0 )@d_(Y_0 )@d_(Z_0 ) )]           （式3-6）
化为齐次形式为：
P_0=T*P_6                     （式3-7）
[■(X_0@Y_0@■(Z_0@1))]=[■(*&   *&   ■(*&d_(X_0 ) )@*&   *&■(   *&d_(Y_0 ) )@■(*@0)&■(   *@   0)&■(■(   *&d_(Z_0 ) )@ ■(0&  1)))]×[■(X_6@Y_6@■(Z_6@1))]            （式3-8）
如上，机械臂的末端位姿有两部分组成：
(R_06，t_0 )                    （式3-9）
可以理解为一个是末端原点的坐标t_0也就是式3-7中的T中的最后一列前三个，一个是旋转量R_06（或者可以用欧拉角序列、翻滚角-俯仰角-偏航角序列等表示）
在机械臂中，可以控制的只有各个关节的电机角度，六轴就是六个电机的角度[q_1,q_2,q_3,q_4,q_5,q_6]，通过设定六个电机角度，可以把机械臂的末端送到目标的位置。这个过程，数学上相当于机械臂基座的坐标系，通过一些列的旋转平移变换到了末端，由如下的这种机制：
T_60=T_65 T_54 T_43 T_32 T_21 T_10            （式3-10）
两边取逆得到：
〖T_60〗^(-1)=〖T_10〗^(-1) 〖T_21〗^(-1) 〖T_32〗^(-1) 〖T_43〗^(-1) 〖T_54〗^(-1) 〖T_65〗^(-1)     （式3-11）
即：
T_06=T_01 T_12 T_23 T_34 T_45 T_56            （式3-12）
机械臂的建模就是基于类似这样的机制，学者Denavit和Hartenberg经过研究简化后，提出了机器人的DH（Denavit-Hartenberg）建模理论[44]。于是，DH建模所用到的基础旋转矩阵就变为：
绕x轴旋转θ_x
R_x (θ_x )=[■(1&0&0@0&cosθ_x&-sinθ_x@0&sinθ_x&cosθ_x )]             （式3-13）
绕y轴旋转θ_y
R_y (θ_y )=[■(cosθ_y&0&sinθ_y@0&1&0@-sinθ_y&0&cosθ_y )]             （式3-14）
绕z轴旋转θ_z
R_z (θ_z )=[■(cosθ_z&-sinθ_z&0@sinθ_z&cosθ_z&0@0&0&1)]             （式3-15）
在机器人学和机械臂设计领域，有两种常用的建模方法：标准Denavit-Hartenberg（SDH）和改进Denavit-Hartenberg（MDH）。为了简化建模过程并提高效率，本文采用MDH规则进行模型构建。MDH方法提供了一种优化的坐标系定义方式，它将坐标系定位在每个连杆的近端，而不是远端，这样做有助于简化计算和减少误差[45]，其主要的原理是这样的，以遨博AUBO-i7H协作机器人为例：
	先确定Z轴（各关节的电机转轴）
	逐步从固定支座坐标系F0，确定X轴的方向，原则是X轴要是本坐标系Z轴和下一个坐标系Z轴的公垂线。如下图，X0轴应该垂直于Z0，和Z1，那么可以这么定：X0垂直于轴Z0和Z1，X1轴垂直于Z1和Z2，X2应该垂直于Z2和Z3…
 
图3-6  六轴机械臂各坐标系
	根据右乘原理，MDH中规定当前关节i的参数先后的顺序是：
Alpha	a	Theta	d
以上面的坐标系F1为例，四个参数代表是坐标F0系，先以X0轴旋转Alpha，再沿着X0轴方向移动a（负方向移动为负数），再以Z0为轴旋转Theta，最后沿着Z0方向移动d，最后得到F1坐标系。此处，Alpha=0，X0不需要旋转，a=0，沿着X0没有平移，Theta=-3/2 π，沿着Z0逆时针旋转145度，X0轴转到了X1轴的位置，然后d=122mm，沿着Z0正方向移动了122mm，这样经过连续的旋转加平移后，就完成了关节1的参数建模。以此类推，逐步确定其余5组参数。所有的参数确定，如下图所示：
 
图3-7  六轴机械臂的坐标系变换传递
可得到MDH的基本变换矩阵为：
A_iMDH=[■(cosθ_i&-sinθ_i&■(0                 & a_i )@sinθ_i*cosα_i&cosθ_i*cosα_i&■(-sinα_i&-d_i*sinα_i )@■(sinθ_i*sinα_i@0)&■(cosθ_i*sinα_i@0)&■(■(   cosα_(i      )&d_i*cosα_i )@■( 0                   &1)))]（式3-16）
即可完成正向求解，所谓正向模型就是输入6个电机的旋转角度及各机械臂段的固定段长，可以得出末端的位姿，这里可以用位姿矩阵表示，。我们根据机械臂实际的尺寸，推导出的正向模型：
A_MDH=A_1MDH*A_2MDH*A_3MDH*A_4MDH*A_5MDH*A_6MDH （式3-17）
六轴机械臂的逆向解是指给定机械臂末端执行器（例如夹爪或工具头）在空间中的位置和姿态（位姿），求解机械臂各关节的角度，使得末端执行器能够达到这个特定的位姿。简而言之，逆向解就是从末端执行器的位姿反推关节角度的过程。在实际应用中，逆向解非常重要，因为通常我们关心的是机械臂末端执行器需要到达的位置和姿态，而不是关节的具体运动。逆向解使得机械臂能够根据任务需求来规划其运动路径。
逆向解的求解其实就是正向模型设置6个未知数，然后根据正向方程解未知数，过程通常涉及到线性方程组或非线性方程组的求解。逆向解的求解可以是解析解或数值解。解析解是指通过数学公式直接求解得到的精确解，而数值解则需要通过迭代算法如梯度下降法逐步逼近解。解析解通常更稳定，但并不是所有机械臂模型都能得到解析解，有时需要使用数值方法来求解。这里用python开源库pytorch的梯度下降法来求解，可以很方便地构建张量计算图并运用反向传播的思想，调用电脑GPU加快求解速度。
 
图3-8  使用梯度下降法求六轴机械臂的逆解，误差图
 
图3-9  六个电机角度逆解
可以求得机械臂六个电机的转动角度：
q_1=2.1372rad
q_2=0.2629rad
q_3=0.2045rad
q_4=0.8672rad
q_5=2.1497rad
q_6=-0.2768rad
据此求出与目标点的误差为：
dx=0.042694091796875mm
dy=0.00885009765625mm
dz=0.01141357421875mm
可以看出误差很小，基本可以满足大部分工业场景；
在实际应用中，逆向解的求解可能面临多个解的问题，因为机械臂可能有多个不同的关节角度配置可以使得末端执行器达到相同的位姿。此外，逆向解的求解还可能遇到奇异点问题，即某些关节角度配置使得机械臂的某些部分相互交叉或无法达到目标位姿。逆向解在机器人学、自动化、制造业等领域有着广泛的应用，是机械臂控制和路径规划的基础。
对于交互接口建模来说，交互接口可以用json结构体表示。这里定义了一些消息体：




基本消息体包含type_id、data两个字段。其中type_id是32位整数，不同的type_id有不同的data。如下图所示为type_id各功能段的定义
 
图3-10  接口type_id字段各功能段
如下所示为几个示例，这里把设备注册及在线监测的类型域设为001，设备注册帧、设备登录帧、上位机下发心跳帧、下位机心跳回复帧的类型码分别为0001,0010,0011,0100。



















	
	


这里把设备数据传输类型域设为010，设备数据上报、设备状态上报类型码分别为0001,0010



	
	


	
	



这些建模方法相互依赖，互为补充，成为一个整体。交互接口建模给行为建模提供基础，而行为建模需要数学建模的参与，具体的可视化和空间模拟实现还需要几何建模，而在一个场景中则需要物理建模来渲染和进行碰撞检测。关于电气建模，则涉及到设备的健康检测与维护，即4.1节所述模型，这也和行为建模有关。
3.4 智能产线建模
产线建模是数字孪生技术在制造业中的重要应用，它涉及创建一个生产线的虚拟副本，以便在虚拟环境中模拟、监控和优化生产过程。产线建模不仅有助于提高生产效率和产品质量，还能降低运营成本并提高企业的竞争力。产线建模的核心在于构建一个能够准确反映实际生产过程的数字模型。对于产线整体的建模，现有的研究主要有两种产线模型，本文主要介绍这两种产线模型，如下文所述。
3.4.1 产线流水线模型
 
图3-11  3机器3工序FSP产线模型示意
流水线调度问题（Flow Shop Scheduling Problem，FSP）是生产调度领域中的一个经典问题，主要研究的是如何在流水线环境中有效安排多个作业的加工顺序，以优化特定的性能指标，如总完工时间、最大完工时间等[46]。
在FSP中，有n个独立的作业需要在m台机器上按一定的顺序进行加工处理。每个作业包含多个工序，这些工序必须在不同的机器上依次完成，且每个工序仅能加工一次。目标是找到一个作业的最优加工顺序，使得所有作业的特定性能指标最小化。FSP可以根据机器的数量（m）、作业的数量（n）、加工时间的特性（确定或随机）、是否允许机器空闲等条件进行分类。常见的分类包括Johnson's Rule：针对两台机器的FSP，提供了一个封闭形式的最优解算法[47]；Permutation Flow Shop：作业的加工顺序在所有机器上都是相同的，即作业1总是在作业2之前加工，以此类推[48]；Job Shop：与FSP不同，作业可以有不同的加工顺序，每个作业有一个特定的工序序列。
FSP的主要优化目标包括[49]：最小化总完工时间是所有作业完成加工的总时间最小；最小化最大完工时间是最后一个作业完成加工的时间最小；最小化总延迟时间是对于有截止日期的作业，延迟时间是超过截止日期的部分。对于这些优化目标，FSP的求解方法包括[50]：
精确算法：如分支定界法、动态规划法，适用于规模较小的问题；
启发式算法：如最短加工时间规则、Johnson's Rule等，适用于中等规模的问题；
元启发式算法：如遗传算法（Genetic Algorithm, GA）、模拟退火（Simulated Annealing, SA）、粒子群优化（Particle Swarm Optimization, PSO），适用于大规模问题。
FSP在制造业、半导体制造、钢铁生产、汽车组装等领域有广泛的应用，特别是在需要优化生产流程和提高生产效率的场景中[51]。FSP是一个典型的NP-hard问题，对于大规模的实例，找到精确解是非常困难的，因此研究者和实践者通常寻求近似解或启发式解，以在合理的时间内获得满意的调度方案。
3.4.2 混合流水线模型
  
图3-12  10机器4工序HFSP结构示意图
混合流水车间调度问题（Hybrid Flow Shop Scheduling Problem, HFSP）是生产调度领域中一个重要的优化问题。它综合了经典流水车间和并行机两种调度的特点，更符合实际生产的要求，具有很高的研究价值和应用背景[52]。HFSP涉及将一组工件在包含多个加工阶段的车间中进行调度。每个阶段可能包含一台或多台并行机器，工件需要按一定的工艺顺序通过各个阶段进行加工。目标是找到最佳的加工顺序和机器分配方案，以优化特定的性能指标，如总完工时间或最大完工时间最小化[53]。
HFSP可以根据并行机器的类型分为并行同速机：各阶段的每台机器上的加工时间相同；并行异速机：各阶段的并行机功能相同但加工速度不同，导致加工时间不同；不相关并行机：各阶段的机器功能不同，加工时间也不同。HFSP的求解算法包括[54]：
精确算法：如整数规划，适用于小规模问题；
启发式算法：基于规则的方法，如最短加工时间优先；
元启发式算法：如遗传算法、模拟退火、粒子群优化等，适用于大规模问题[55-56]；
学习型算法：利用历史数据和机器学习技术来指导搜索过程。
HFSP问题也是一个典型的NP-hard问题，寻找最优解在计算上非常复杂，因此研究者和实践者通常寻求启发式解或采用学习型算法求精确解，以在合理的资源分配下获得满意的调度方案。
第四章 产线设备检测与调度优化
4.1 产线设备故障检测
在基于数字孪生的智能产线中，产线设备的健康运行管理是一项至关重要的任务，它关系到生产效率、产品质量以及生产安全。数字孪生技术通过采集设备电气数据并采用特点方法创建物理设备的虚拟副本，使得设备管理更加智能化和精细化。以下是关于产线设备健康运行管理的几个关键点：
	实时监控与状态评估：通过在设备上安装传感器，可以实时收集设备的运行数据，如温度、振动、压力等。这些数据被传输到数字孪生模型中，用于实时监控设备状态。通过对这些数据的分析，可以评估设备的健康水平，及时发现异常情况，预防故障的发生。
	预测性维护：利用历史数据和机器学习算法，可以对设备的未来状态进行预测。预测性维护不仅能够帮助提前发现潜在的故障风险，还能够在问题发生前制定维护计划，减少意外停机时间，提高生产连续性和稳定性。
	故障诊断与分析：当设备出现故障时，数字孪生模型可以用于模拟故障发生的过程和原因。通过对故障模式的深入分析，可以找出根本原因，并制定针对性的解决方案，避免同类故障的再次发生。
	设备寿命管理：数字孪生技术可以帮助追踪设备的使用情况和磨损程度，通过分析设备的寿命数据，可以为设备的更新换代提供决策支持。这有助于确保产线上总是使用性能最佳的设备，从而提高整体生产效率。
	维护与优化策略：基于数字孪生模型的分析结果，可以制定更加精确和有效的维护策略。同时，通过模拟不同的维护方案，可以找到最佳的维护计划和优化措施，减少维护成本，提高维护工作的效率。
 
图4-1  设备故障检测流程
在加工中心和机械臂等运动部件的旋转部分，轴承扮演着至关重要的角色。轴承的健康状况直接影响到加工中心和机械臂的运行效率和精度，因此对其进行故障检测尤为重要。轴承的常见故障类型包括内圈故障、外圈故障和滚珠故障。这些故障的发生，通常是由于滚珠与外圈或内圈的局部损坏部分相互撞击，或者损坏的滚珠与内外圈发生撞击，从而激发出轴承与响应传感器之间的高频共振。通过使用加速度计采集轴承的振动信号，利用机器学习、深度学习的方法对采集的数据进行识别判断，可以有效地实现对这些故障的诊断。
 
图4-2  轴承结构示意图
此外，对机械臂的运行温度、电机驱动电压和电流以及位置位姿等参数的监测，也是判断其运行状态的重要手段。通过收集这些数据，并分析其所处的范围及发展趋势，可以及时识别潜在的问题，从而采取相应的维护措施，确保加工中心的稳定运行。
4.1.1 设备数据采集与增强
本文采用了凯斯西储大学开源的轴承故障诊断数据集[57]，该数据集包含了九种不同故障类型的振动信号数据。每种故障类型均涵盖了驱动端（DE_time）、风扇端（FE_time）和基座（BE_time）三个维度的测量数据，为研究提供了全面的数据分析基础。
 
图4-3  凯斯西储大学轴承故障检测试验台[57]
具体来说，数据集中的每种故障类型都包含了约85,000条数据，如图4-4，这些数据以红色、绿色和蓝色分别表示DE_time、FE_time和BE_time，以便进行直观的可视化分析。通过对这些数据的深入分析，我们可以更准确地诊断轴承的健康状况，从而为加工中心机械臂等关键运动部件的维护提供科学依据。
 
图4-4  轴承振动数据[57]
短时间傅里叶变换（Short-Time Fourier Transform，STFT）是一种分析信号频率随时间变化的方法，它是傅里叶变换的一个变种，适用于非平稳信号。STFT通过将信号分割成短时间的片段，然后对每个片段进行傅里叶变换，从而得到信号的时频表示，如下图所示为驱动端数据在12k采样率，2s内的时频图。
 
图4-5  轴承振动数据驱动端时频图
为了提升轴承故障检测的准确性和鲁棒性，本研究对数据集进行了增强处理。具体而言，采用了重叠采样的方法来扩充训练数据集。该方法在从原始信号中提取训练样本时，巧妙地设计了每一段信号与其后继信号之间存在一定比例的重叠部分。这种重叠策略不仅保留了信号的连续性和上下文信息，而且有效地增加了数据集的大小，使训练数据的数量提升了14.19%。通过这种方式，模型能够接触到更多的数据变化，从而提高了其在实际应用中的泛化能力和故障诊断的准确性。
 
图4-6  重采样数据增强示意图
4.1.2 基于卷积神经网络的故障检测
本文首先构建了一个基于CNN的模型，用于自动特征提取和轴承故障分类。该CNN模型包含5个卷积池化层，每层的核形状依次设置为64、16、8、3、3，这样的配置旨在从原始信号中逐层提取出越来越抽象的特征表示。通过这些层次化的卷积操作，模型能够捕捉到轴承振动信号中的局部特征，并逐渐整合成全局性的特征表征，为故障诊断提供了强有力的特征支持。
此外，该模型的总训练参数数量为54,793，这表明模型在保持相对轻量化的同时，也具备了足够的参数来学习复杂的故障模式。这一模型设计不仅提高了故障检测的效率，也使得模型更易于训练和泛化到不同的轴承故障数据集上。
 
 
 
图4-7  CNN模型结构
对所提出的CNN模型进行了充分的训练，以达到最佳的轴承故障诊断效果。整个训练过程共设置了20个Epoch，即对整个数据集进行了20轮的遍历学习。在第8个Epoch时，模型的性能达到了一个显著的结果，此时模型的诊断准确率和泛化能力均表现良好。这一观察结果表明，该CNN模型在经过相对较少的训练周期后，就能快速收敛并捕捉到轴承故障数据中的关键特征。这种快速收敛的特性不仅提高了模型训练的效率，也减少了过拟合的风险，使得模型在实际应用中更加稳定和可靠。在第8个Epoch之后，我们继续训练模型，以确保其在不同阶段都能保持较好的性能，最终在所有设定的Epoch完成后，我们获得了一个在轴承故障诊断任务上表现较好的模型。
  
图4-8  CNN结果示意，左为Loss，右为Accuracy
4.1.3 基于循环神经网络的故障检测
本研究还探索了两种循环神经网络架构——LSTM [58]和GRU [59]，它们均与CNN结合，以评估哪种架构在轴承故障诊断任务上表现更优。以下是对这两种模型架构的详细描述：
LSTM+CNN模型：
	蓝色方框（CNN层）： 该模型的CNN部分由多个卷积层组成，各层的核形状分别为64、3、3、3、3。这种配置使得模型能够从原始信号中提取局部特征，并将这些特征转换为更高级的表示，为后续的时序分析提供丰富的特征输入。
	红色方框（LSTM_layer1）： 在CNN层之后，我们引入了第一个LSTM层，用于处理时间序列数据并提取时序特征。
	橙色方框（LSTM_fc1）： 这是一个全连接层，位于LSTM层之后，用于进一步整合特征并为最终分类做准备。
	黄色方框（LSTM_layer2）： 第二个LSTM层，它继续处理来自前一个LSTM层的输出，以捕捉更复杂的时序依赖关系。
	绿色方框（LSTM_fc2）： 最后一个全连接层，它将LSTM层的输出转换为最终的分类结果。
GRU+CNN模型：
	蓝色方框（CNN层）： 与LSTM+CNN模型相同，GRU+CNN模型的CNN部分也由核形状为64、3、3、3、3的卷积层组成。
	红色方框（GRU_layer1）： 这是GRU模型的第一个层，它与LSTM类似，但结构更简单，参数更少，用于处理时间序列数据。
	橙色方框（GRU_fc1）： 这是一个全连接层，位于第一个GRU层之后，用于整合特征。
	黄色方框（GRU_layer2）： 第二个GRU层，它进一步处理时间序列数据，捕捉深层次的时序特征。
	绿色方框（GRU_fc2）： 最后一个全连接层，它将GRU层的输出转换为最终的分类决策。
 
图4-9  LSTM+CNN或GRU+CNN模型示意
上述模型的CNN部分均由五个卷积池化层组成，每层的卷积核形状分别设置为64、3、3、3、3，这些层共同作用于输入数据，有效地提取了轴承振动信号中的空间特征。这利用了CNN在图像处理中的优势，通过卷积层的层次化特征提取，从输入的轴承振动信号中提取空间特征。通过设计的卷积层，模型能够捕捉到信号中的局部模式和纹理信息，为后续的时序分析提供了丰富的特征表示。
在CNN层之后，模型转入LSTM部分，这一部分由两个LSTM层和两个全连接层组成。第一个LSTM层（红色方框）开始处理时间序列数据，捕捉信号中的长期依赖关系。随后，第一个全连接层（橙色方框）对LSTM层的输出进行进一步的特征整合。第二个LSTM层（黄色方框）继续深入处理时间序列数据，而第二个全连接层（绿色方框）则将这些信息综合起来，为最终的故障分类提供决策支持。通过这种CNN和LSTM的结合，模型不仅能够捕捉到轴承振动信号的局部特征，还能够理解这些特征随时间的演变，从而实现对轴承故障类型的有效识别。在20个Epoch的训练过程中，模型在第4个Epoch就达到了较好的诊断效果，这表明了模型的快速收敛性和对故障特征的敏感性。
   
图4-10  LSTM+CNN结果，左为Loss，右为Accuracy
在CNN+GRU模型紧接着CNN部分的是GRU网络结构。GRU层（红色方框）的作用是处理时间序列数据并提取时序特征。GRU是一种高效的循环神经网络变体，它通过引入更新门和重置门来控制信息的流动，从而有效地捕捉长距离依赖关系。在GRU层之后，加入了一个全连接层（橙色方框），进一步整合特征，为分类提供更丰富的特征表示。为了增加模型的深度并提高分类的准确性，我们在第一个GRU层之后又添加了一个GRU层（黄色方框），以及另一个全连接层（绿色方框）。这样的设计使得模型能够更细致地学习信号中的时间动态变化，进一步提升了故障诊断的准确性。在20个Epoch的训练过程中，GRU+CNN模型在第3个Epoch就展现出了较好的性能，这表明模型能够快速学习并识别轴承的故障特征。
   
图4-11  GRU+CNN结果示意，左为Loss，右为Accuracy
4.1.4 基于自注意力机制的故障检测
本文还采用了一种新颖的混合模型，该模型将Self-Attention与CNN的优势相结合[60]，以提高轴承故障诊断的性能。模型中自注意力部分的多头数设置为8，这允许模型在不同表示子空间中并行地捕捉信息，增强了模型对数据的理解和处理能力。
 
图4-12  self-attention和multi heads self-attention结构示意[61]
Self-Attention的原理是基于输入序列计算表示，它将单个序列的不同位置关联起来。这种机制能够捕捉序列内部的依赖关系，允许模型在处理一个元素时考虑到其他元素，从而更好地理解整个序列的上下文信息。在Self-Attention中，每个元素都会计算出一个注意力分数，这些分数决定了在生成输出表示时，每个元素应该被赋予多少权重[61]。
 
图4-13  Self-Attention+CNN模型示意
通过这种结合，我们的模型不仅能够利用CNN强大的空间特征提取能力，还能够通过自注意力机制捕捉到更深层次的序列特征和上下文信息。这种混合方法提高了模型对轴承振动信号的分析能力，从而更准确地诊断轴承的故障状态。实验结果表明，该模型在轴承故障诊断任务上表现出了优异的性能，证明了自注意力与CNN结合的有效性和潜力。
   
图4-14  Self-Attention+CNN结果示意，左为Loss，右为Accuracy
该模型在训练过程中，在第3个Epoch时，便达到了较好的诊断效果，显示出模型的快速学习能力和高效性。
通过这种结合，该模型不仅能够利用CNN强大的空间特征提取能力，还能够通过自注意力机制捕捉到更深层次的序列特征和上下文信息。这种混合方法提高了模型对轴承振动信号的分析能力，从而更准确地诊断轴承的故障状态。实验结果表明，该模型在轴承故障诊断任务上表现出了优异的性能，证明了Self-Attention与CNN结合的有效性和潜力。
4.1.5 模型评估
对上述四种不同的模型进行了综合比较，包括传统的CNN模型、LSTM+CNN模型、GRU+CNN模型以及Self-Attention+CNN模型。比较的指标包括训练时间、准确率和收敛的Epoch数。
模型	CNN	LSTM+CNN	GRU+CNN	Self-Attention+CNN
训练时间/(S)	21. 00	855.73	729.28	31.58
准确率	较高	高	高	高
表4-1  模型性能指标
通过这一对比分析，可以发现Self-Attention+CNN模型在多个方面表现出色。
	训练时间：Self-Attention+CNN模型由于其高效的并行计算能力，相较于序列模型如LSTM和GRU，展现出了更短的训练时间。这使得它在实际应用中更具优势，尤其是在需要快速部署和响应的场景中。
	准确率：在准确率方面，Self-Attention +CNN模型同样表现不俗。通过自注意力机制，模型能够更好地捕捉轴承振动信号中的长距离依赖关系，这对于那些具有复杂时序特性的故障模式尤为重要。此外，CNN部分的引入进一步增强了模型对空间特征的提取能力，使得整体的故障诊断准确率得到了显著提升。
	收敛Epoch：在模型的收敛速度上，Self-Attention +CNN模型在第3个Epoch时便达到了较好的效果，显示出了快速的学习能力。这一特性意味着模型能够在短时间内适应新的数据，对于在线学习和实时监测系统来说，这是一个非常有价值的特性。
综合考虑以上因素，Self-Attention +CNN模型在轴承故障诊断任务中展现了其独特的优势。它不仅能够快速学习并准确识别出不同的故障类型，还能够在较短的时间内完成训练，这对于提高生产效率和降低维护成本具有重要意义。因此，本文认为Self-Attention +CNN模型是一个值得进一步研究和应用的有力工具。
4.2产线调度优化
智能工厂中的FSP是生产调度领域的经典问题。它涉及将一系列独立的作业（或称为工件、任务）在多台机器上进行调度，以优化性能指标，如总完工时间、最大完工时间、总拖延时间等。在FSP问题中，有n个作业需要在m台机器上加工，每个作业必须经过所有机器，且加工顺序在各机器上保持一致。每个作业在每台机器上的加工时间是已知且确定的，作业不可中断且不能并行处理。目标是确定一个作业的加工顺序，以实现性能指标的最优化。FSP问题在制造业、交通运输、物流等多个领域都有广泛应用，特别是在需要多步骤加工且加工顺序固定的场合。有效的调度策略可以显著提升生产效率，降低成本，增强企业的竞争力。
4.2.1 基于均值聚类划分父本母本的遗传调度方法
遗传算法是一种模拟生物进化过程的搜索启发式算法。它是由约翰·霍兰德在20世纪70年代初提出的，灵感来源于达尔文的自然选择和遗传学理论[62]。遗传算法通常用于解决优化和搜索问题，尤其是在问题的搜索空间很大或者问题本身很难用传统方法解决时。其一般步骤为：编码、初始种群、计算适应度、执行选择淘汰、交叉、变异。其应用在FSP [63]和HFSP [64]中能取得不错性能。
传统遗传算法的基本流程可以概括为以下几个主要步骤：
	编码：将问题的可能解转换为染色体（或个体）的基因型形式，这些染色体构成了遗传算法操作的基础；
	初始化种群：随机生成一个初始种群，这个种群包含了问题潜在解的多样性；
	适应度评估：对种群中的每个个体计算其适应度值，以评价其解决问题的能力；
	选择操作：根据个体的适应度值，采用特定的选择策略挑选出优秀的个体作为父代；
	交叉操作：以一定的概率将选中的父代个体的部分基因互换，产生新的子代；
	变异操作：以一定的概率改变子代个体的某些基因位，进一步增加种群的多样性；
	终止条件判断：检查是否满足预设的终止条件，如达到最大迭代次数或解的质量达到预定标准；
	迭代：如果未满足终止条件，算法将返回到选择操作步骤，继续迭代；如果满足，则算法终止；
	输出结果：算法结束时，输出当前找到的最优解作为问题的全局最优解。这个过程通过模拟自然选择和遗传机制，不断迭代优化，逐渐引导种群向更好的解进化。
遗传算法的这种迭代过程旨在逐步提升种群的整体适应度，最终找到问题的最优或近似最优解。下面是流程图：
 
图4-15  传统遗传算法流程
遗传算法的交叉操作在遗传算法中的重要性如下，增加多样性： 交叉操作通过组合两个父代个体的遗传信息来产生后代，这增加了种群的遗传多样性。多样性是遗传算法能够持续搜索解空间并避免陷入局部最优的关键因素；探索新解空间：通过交叉，遗传算法能够探索父代个体所代表的解空间之外的新区域。这种探索能力有助于算法发现之前未被考虑的潜在解，从而有可能找到更优的解；组合优势：交叉操作可以组合两个父代的优秀特征，产生具有这些特征的后代。这种组合有助于加速算法向最优解的收敛，因为优秀的特征可以在种群中快速传播；维持有益基因：在交叉过程中，如果父代个体中含有对适应度有益的基因，这些基因可以通过交叉操作传递给后代，从而有助于维持和强化这些有益特征[65-66]；
然而现有交叉操作多是从种群中随机选择两个个体进行基因的交换，若是选择了两个相似的个体，则其基因也有一定的相似性，就犹如近亲结婚后代容易出现智力低下、先天性畸形、体质差等问题一样。这样交叉出来的后代个体很大可能不具有更优的基因，反而会让好的基因重组消逝，从而降低收敛的速率。故本论文提出一种基于均值聚类划分父本母本的方法，通过个体之间的余弦相似度（也就是基因的相似度）来划分父本和母本，确保父本母本的相似度低以完成基因交叉操作，这样可以加快迭代速度，加快种群进化速度，更快的繁殖出最优个体，也即得到近似最后或最优解，流程框图如下：
 
图4-16  K-means划分父本母本的遗传算法流程图
余弦相似度是一种衡量两个非零向量之间角度的相似性度量方法。它通过计算两个向量之间的夹角的余弦值来确定它们之间的相似性。余弦相似度的范围从-1到1，其中：
	1 表示向量完全相同的方向（完全相似），
	0 表示向量之间是正交的，即不相关，
	-1 表示向量完全相反的方向（完全不相似）。
余弦相似度的计算公式如下：
Similarity(A,B)=(A∙B)/(||A||×||B||)=(∑_(i=1)^n▒〖(A_i×B_i)〗)/(√(∑_(i=1)^n▒A_i^2 )×√(∑_(i=1)^n▒B_i^2 ))
其中：
	A∙B是向量A和B的点积。
	||A||是向量A的欧几里得范数（即向量的长度或大小）。
	||B||是向量B的欧几里得范数。
由于遗传算法编码的基因在大多数时候都可以是一个数值矩阵，也即是一个向量，所以可以通过计算余弦相似度来度量个体之间的基因相似度；
K-means是一种经典的聚类算法，用于将数据集中的样本划分为K个聚类，其中每个样本都属于最近的均值（即聚类中心）所代表的聚类[67]。该算法的目标是最小化每个点到其聚类中心的距离平方和，这被称为惯性（Inertia）或Within-Cluster Sum of Squares (WCSS)。K-means算法的基本步骤如下：
	初始化：随机选择K个数据点作为初始的聚类中心（质心）。
	分配：对于数据集中的每个点，根据其到各个聚类中心的距离，将其分配给最近的聚类中心所代表的聚类。
	更新：重新计算每个聚类中所有点的均值，并将该均值设置为新的聚类中心。
	迭代：重复步骤2和步骤3，直到满足某个终止条件，如达到最大迭代次数、聚类中心的变化小于某个阈值或聚类结果的变化不再显著。
	输出：最终的聚类中心和每个数据点所属的聚类。
根据余弦相似度和K-means算法选出父本母本后就执行基因交换操作产生后代，进行遗传迭代。
本智能工厂生产线有4个机器，需要加工100个工件，这是一个FSP，需要对100个工件进入产线的顺序进行排序以达到加工时间最小化的目的。为此采用上述改进的遗传算法，具体输入该算法的数据为100个工件在4个机器上的加工时间。100个工件在4个机器上的加工时间如下表所示：


表4-2  100个工件在4个机器上的加工时间
Job_name	M1_processtime/s	M2_processtime/s	M3_processtime/s	M4_processtime/s
J1	7	19	71	73
J2	12	13	29	31
J3	98	14	8	82
J4	72	7	90	56
J5	43	53	1	74
J6	51	17	26	1
J7	59	32	76	49
J8	39	46	53	80
J9	10	60	96	42
J10	16	88	59	87
J11	9	41	40	90
J12	9	52	56	69
J13	18	2	38	53
J14	46	13	13	19
J15	66	85	24	64
J16	1	99	44	90
J17	5	84	70	50
J18	29	15	43	95
J19	70	53	38	27
J20	65	49	35	7
J21	77	83	40	72
J22	59	13	49	41
J23	67	31	90	20
J24	49	28	43	19
J25	2	11	43	68
J26	6	96	93	95
J27	30	70	78	57
J28	56	18	96	97
J29	65	80	26	43
J30	32	87	71	99
J31	87	59	73	11
J32	57	65	3	40
J33	53	39	43	89
J34	97	31	59	45
J35	57	34	54	53
J36	44	77	34	2
J37	49	76	33	19
J38	73	96	38	87
J39	27	48	19	13
J40	53	87	68	13
J41	35	98	33	61
J42	30	36	7	51
J43	69	95	74	68
J44	16	40	85	2
J45	10	69	77	92
J46	54	19	88	26
J47	89	40	90	64
J48	55	89	56	69
J49	80	46	76	89
J50	14	54	62	60
J51	28	62	71	46
J52	86	80	60	42
J53	80	76	87	74
J54	4	91	86	29
J55	30	43	65	4
J56	55	82	78	67
J57	61	6	43	42
J58	5	12	60	38
J59	49	71	42	95
J60	40	47	41	57
J61	93	84	40	38
J62	31	83	7	29
J63	79	95	14	30
J64	82	2	62	18
J65	3	61	91	35
J66	30	81	77	9
J67	81	6	73	48
J68	97	31	18	50
J69	21	86	73	9
J70	22	7	5	72
J71	57	52	78	96
J72	63	74	75	39
J73	91	26	77	45
J74	23	83	94	53
J75	93	24	7	92
J76	14	53	16	41
J77	34	31	23	31
J78	20	69	55	28
J79	19	59	36	51
J80	27	63	59	83
J81	43	68	26	4
J82	6	51	61	57
J83	44	41	41	11
J84	26	46	94	39
J85	89	97	56	31
J86	62	9	80	38
J87	55	7	57	76
J88	45	58	64	55
J89	37	3	56	45
J90	87	46	2	21
J91	67	65	53	41
J92	79	55	74	1
J93	43	53	93	30
J94	56	41	26	26
J95	86	33	59	15
J96	33	9	68	12
J97	57	1	97	86
J98	12	22	18	61
J99	90	48	84	5
J100	76	26	33	26










个体基因的编码即为工件的不同输入顺序，目标函数也即适应度就是这一工件序列完全加工完所需的时间，可以看出适应度越高，目标函数的值越小。如图4-17所示传统的遗传算法，可见迭代到40epoch时不再收敛
 
图4-17  传统遗传算法迭代结果
余弦相似性度量方式对于评估高维空间中点的相似度特别有用，因为它忽略了向量的大小，只关注它们的指向。下图所示为根据余弦相似度采用k-means划分父本母本，黄色为父本，数量为91，紫色为母本，数量为109，可见该两簇有着明显的分界线。
 
图4-18  K-means划分父本母本
从上述父本母本中分别选择两个个体进行交叉操作，并迭代，结果如下图所示，20epoch就完成了收敛，可见提高了收敛速度；
 
图4-19  K-means划分父本母本的遗传算法迭代结果
在提出的遗传算法中，初始种群是随机生成的，每个个体都代表了一个潜在的解决方案。通过计算种群中个体之间的余弦相似性，算法能够识别出相似的个体，并将它们分为不同的簇。这些簇作为父本和母本，通过交叉和变异操作产生新的后代，增加了种群的多样性。这不仅提高了收敛速度，而且也提高了算法的全局搜索能力和局部搜索精度。
总的来说，本论文提出的基于余弦相似性结合K-means聚类的遗传算法，为解决复杂的优化问题提供了一种有效的途径，特别是在需要处理大量数据和高维空间搜索的应用场景中。
4.2.2 基于深度强化学习和多瞥见机制的调度方法
FSP是一个NP-hard问题，传统的解决方法多为启发式算法和元启发式算法，尽管启发式和元启发式算法在处理复杂优化问题时非常有效，但它们通常需要仔细的参数调整和多次试验，以达到较好的性能。此外，这些算法通常不能保证找到全局最优解，而是提供近似解。本论文提出一种基于深度强化学习和多瞥见机制的方法来得到FSP的最优解。
强化学习是机器学习的一个重要分支，它主要关注如何在环境中采取行动以最大化某种累积奖励[68]。强化学习的核心思想是智能体通过与环境的交互来学习最佳策略，即在给定状态下选择最佳动作的规则。强化学习的基本组成部分：
	智能体：智能体是学习过程中的主体，它通过感知环境状态并执行动作来实现目标。
	环境：环境是智能体所处和互动的外部世界，它可以是真实世界，也可以是模拟环境。
	状态：状态是对环境在某一时刻的描述，智能体根据状态来决定下一步的动作。
	动作：动作是智能体在给定状态下可以执行的行为，动作的执行会导致环境状态的变化。
	奖励：奖励是智能体执行动作后从环境中获得的反馈信号，它指示动作的好坏或对目标的接近程度。
 
图4-20  强化学习示意图
深度强化学习是深度学习和强化学习相结合的一个领域。深度学习是一种机器学习方法，它使用多层（深层）神经网络来学习数据的高层次特征表示[69]。强化学习是一种学习范式，其中智能体通过与环境互动来学习如何做出决策，以最大化某种累积奖励。
深度强化学习的关键组成部分：
	智能体：智能体是与环境互动的实体，它通过执行动作并观察环境的反馈（如奖励和新状态）来学习策略。
	环境：环境是智能体所处和互动的外部世界。它可以是真实世界，也可以是模拟世界，如视频游戏或仿真软件。
	观察：相当于智能体的感知器官，通过这些器官来获取环境的初始信息，并进行深度学习特征提取。
	动作：动作是智能体在给定状态下可以执行的行为。动作的执行会导致环境状态的变化，并可能带来奖励。
	奖励：奖励是智能体执行动作后从环境中获得的反馈信号，它指示动作的好坏。智能体的目标是最大化长期累积奖励。
	学习：学习是从观察的深度神经网络中学习规律，接收环境给予的奖励，并输出强化学习的决策。
 
图4-21  深度强化学习示意图
指针网络是一种基于序列到序列的深度网络模型，它在2015年由Oriol Vinyals等人提出。指针网络的核心思想是利用神经网络直接预测输出序列中的元素，这些元素是输入序列中元素的索引，从而实现对输入序列的“指针”功能[70]。用指针网络作为深度强化学习的深度网络可以用来实现组合优化问题的求解，且有不错的效果[71-72]。本论文参考指针网络并进行改进提出多瞥见机制（MGM）的方法具体如下：
输入工件数据特征增强：对于每一个输入工件序列的单个工件来说，其数学表示为[process_time1, process_time2, process_time3, process_time4],为一浮点数列表，代表该工件分别在4个机器上的加工时间。为了使每个工件输入特征更加丰富多样，本发明使用一种特征增强方法。即将每个工件表示为：[process_time1, process_time2, process_time3, process_time4,ρ,σ],其中ρ=atanh (process_time1)/(process_time2)、σ=atanh (process_time3)/(process_time4)，由原来4个特征扩展到6个特征。
输入初始嵌入：每个工件的特征经过特征增强后为6个维度，将这些特征与嵌入矩阵相乘进行输入嵌入。具体定义了一个维度为input_dim×embedding_dim的嵌入矩阵，input_dim=6，embedding_dim=256。并且这个矩阵的数值是可以进行反向传播算法学习的，以提取适应目标函数所需要的高维特征表示。
编码器：考虑到智能产线现场的时间紧迫性，采用一GRU进行编码。由于GRU是LSTM的简化版本，它将LSTM中的遗忘门和输入门合并为一个更新门，并且将细胞状态和隐藏状态合并为一个单一的状态。这意味GRU参数数量较少，因此在训练时更快，GRU编码器的hidden_dim为256。通过编码器即可得到输入工件序列的上下文向量e
解码器：为了保持精度，解码器首先采用一LSTM。本论文采用多瞥见机制MGM，LSTM输出当前解码器的隐藏状态d_i，MGM通过多次循环采用Attention机制用当前解码器的隐藏状态d_i和上下文e迭代特定次数，这意味着在每一步解码过程中，解码器可以多次查看（或“瞥见”）编码器的输出，以更好地捕捉上下文中的信息。具体为：



其中Attention的返回值ref为e与一矩阵的乘积，表示为W_1^n e，nϵ[0,…,n_glimpses - 1],并且该矩阵是可以学习的，Attention的返回值logits为输出工件的概率，最后采用一Attention输出下一个工件的预测概率，重点公式为：
u_i=v^T  tanh⁡(W_1 e+W_2 d_i )                 式（4-1）
[p(C_1)……p(C_j)]=softmax(u_i)             式（4-2）
C_1….C_j表示的是输入序列，p(C_j)表示的是当前解码器输出为C_j的概率。其中v、W_1 、W_2是可以学习的参数，e是输入工件序列编码后的隐状态，d_i是当前解码器的隐状态，注意该隐状态d_i 在多瞥见机制（MGM）里更新了n_glimpses次。之后获取最大输出概率的工件作为当前解码器输出，并通过LSTM更新当前解码器状态d_(i+1)，采用掩码机制MASK防止当前输出工件在后续操作中重复选择，执行j次即可得到输出工件序列，j为工件个数。如下图所示为深度网络的示意图：
 
图4-22  多瞥见机制深度网络
在解码策略中分别采用了两种方法，一种是选择预测输出概率最大的工件作为解码器输出工件，二是每次选择概率最大的输出序列，这个方法考虑到了前面工件序列和当前输出工件的组合概率。
由于该FSP，每次从输入工件序列中选择一个最大概率的工件到输出工件序列，而不能重复选择选过的工件，故本方法还添加了一个MASK向量，其维度为输入工件个数，值为0或1，每次只选择MASK值为0对应的工件集合中的最大概率所对应的工件，并更新该工件对应的MASK值为1，之后计算剩余MASK为0对应工件的输出概率，重复操作直到所有工件都被输出为止，最后计算奖励函数，同时根据奖励函数和历史训练信息使用梯度下降法更新相应网络的权值，这样就完成了一个输入工件序列到输出工件序列的一次训练。
对于输入工件序列，我们很容易随机打乱输入工件序列，这样就可以得到数量合适的训练样本。本方法随机打乱输入工件序列得到1000000样本，用这些样本训练网络，最终可以使网络收敛到一个不错的水平。后面可以调用该训练后的网络，对于任意顺序输入的工件序列，基本上可以输出一个一致顺序的工件序列，这样就完成了对输入工件序列的排序，且该排序基本上可以认为是最优排序。
本方法将输入序列通过一个深度网络映射到高维空间，以捕获更高维度，更难以理解，难以用数学公式描述的特征及规律，并且强化学习网络根据这些特征规律学习优化自己的决策行为，不断迭代，直到自己的每一步行为达到最优，输出收敛。表现为根据输入序列的数字特征输出一个最优排序。
本智能产线由于定制化的需求，每一个工件在以下4个机器上的加工时间都不同。某天该产线来了20个订单。
 
图4-23  产线示意图
即20个工件在4个机器上的加工时间如下表：
表4-3  20个工件在4个机器上的加工时间
Job_name	M1_processtime/s	M2_processtime/s	M3_processtime/s	M4_processtime/s
J1	27	13	83	93
J2	36	33	95	18
J3	55	61	27	7
J4	45	86	52	44
J5	93	54	30	4
J6	71	59	43	88
J7	41	55	56	74
J8	75	69	79	41
J9	65	75	11	65
J10	68	32	23	85
J11	60	32	22	28
J12	71	7	2	27
J13	74	84	32	63
J14	65	68	96	70
J15	91	77	75	66
J16	82	68	45	74
J17	24	87	73	49
J18	94	41	7	32
J19	53	40	6	24
J20	37	24	23	33
以该20个工件的数据执行上述深度强化学习和多瞥见机制（MGM）算法可以得到如下结果，20工件深度强化学习和多瞥见机制的动作损失如图4-24所示，可见经过一定次数的训练迭代后，动作损失降到了很低的水平，为0.00872657。
 
图4-24  20工件深度强化学习和多瞥见机制网络的动作损失
20工件深度强化学习和多瞥见机制网络的奖励函数，即为加工时间如图4-25所示，实际奖励函数为加工时间的倒数，一定迭代次数后加工时间收敛到了1263s。
 
图4-25  20工件深度强化学习和多瞥见机制网络的加工时间
训练后即可得到一个基本最优的工件排序调度方案，最终20个工件加工完成时间为1263s，可输出甘特图排程如4-25所示。
 
图4-26  20工件深度强化学习和多瞥见机制网络的排程甘特图
4.2.3 基于遗传算法的混合流水线调度方法
对于上述的FSP问题，该智能产线有4道工序4个机器，我们可以增加相关工序的机器数量来缩短加工时间。类似于河流，我们需要扩宽河道来增加流量。具体为第一道工序3个机器，第二道工序2个机器，第三道工序3个机器，第四道工序2个机器，共十个机器，如下图所示：
 
图4-27  10机器4工序HFSP结构示意图
该问题即为HFSP的并行同速机问题，采用遗传算法对该问题进行迭代求解，遗传算法原理思想在4.2.1节已经阐述，这里具体而言就是基因的编解码不同，不在赘述，可以得到如下结果，可见加工时间减少了一半以上：
 
图4-28  10机器4工序HFSP迭代结果
如图4-29所示为10个机器的HFSP排程甘特图。
 
图4-29  10机器4工序HFSP排程甘特图
可以对比一下几种方法的适用范围，简单的FSP遗传算法求解方案适用范围广，可以得到一个较优的解决方案；而基于深度强化学习的调度方案前提是需要一定时间来训练模型，这取决于可用计算资源的大小，该方案一般能得到一个全局最优解；HFSP的遗传算法需要投入资金来购买增加相应机器数量，此方法可大幅减少一批工件的加工时间；
第五章 系统实现
5.1 设备模型建立
按照第三章所述方法对产线设备模型进行数学建模、行为建模、电气建模、交互及接口建模，因篇幅有限，本论文只对机械臂进行了建模，其余设备不在赘述，下面进行机械臂几何建模和物理建模，主要有：
3D Max模型建立：3DMax，全名3D Studio Max，是一款由Autodesk公司开发的3D设计和渲染软件。这款软件以强大的功能，用户友好和灵活性而著名。3DMax被广泛应用于电影，电视，游戏，并广泛用于建筑可视化，工业设计以及其它3D设计领域。3DMax以其多功能性，灵活性和易于学习而受到业界的广泛欢迎。它被广泛应用于创意设计和视觉特效行业，使设计师能够模拟，呈现出强大和逼真的3D设计[73]。
模型面数优化：要确保合理的多边形数量，过多的多边形将使模型变得过于复杂，可能导致计算机处理能力不足。保证只在细节需要时添加更多的多边形，并在不影响视觉效果的前提下删除不必要的多边形。可以使用3D Max的“优化”工具来减少多边形的数量。这个工具可以将模型中的多个面合并成一个面，不会影响模型的外观[74]。
材质纹理处理[75]：将优化好的3D Max的模型保存为.fpx文件并导入到Unity 3D中进行材质及纹理的添加处理。如下图所示为机械臂颜色纹理贴图参数示意图。
 
图5-1  unnity材质调整设置
如图5-2所示为组成机械臂的各个关节零件，图5-3所示为机械臂组装完整示意图。
 	 
 	 
 	 
 	 
  



















图5-2  机械臂装配示意图

                                                                                                              
 
图5-3  机械臂完整示意图
5.2 数据中台建立	
数据中台的实现采用SSM的架构。SSM框架，即Spring、SpringMVC和MyBatis的集成，是一种流行的Java EE企业级开发解决方案，遵循MVC设计模式。SSM整合了Spring的依赖注入和AOP功能、SpringMVC的Web请求处理能力以及MyBatis的数据持久化技术，旨在提高开发速度、灵活性，减少代码依赖，并提升工作效率。具体来看，Spring框架提供了一个轻量级的IoC容器，负责对象生命周期管理、依赖注入和AOP。SpringMVC作为基于Spring的Web框架，实现了分层架构，有效处理Web请求和响应。MyBatis则作为一个数据持久层框架，实现了数据库表与Java对象之间的映射。利用SSM框架，能够根据需求调整配置，同时有效利用框架提供的功能简化开发工作。SSM框架还包含了诸如事务处理、缓存管理、日志记录等实用特性。
如图5-4所示为数字孪生智能产线协议库管理界面，可以新增、删除、管理各协议并进行相关配置，通过配置接入各数据源，该协议管理可以得到多源数据的统一接口，以便后续数据的存储与利用。
 
图5-4  数字孪生智能产线协议库管理界面
如图5-5所示为数字孪生智能产线数据采集点管理界面，可以新增、删除、管理各数据采集点并进行相关配置，通过配置数据采集点的所属机器、数据属性、数据格式、数据频率等元数据属性，实现对数据采集点的个性化配置与利用。
 
图5-5  数字孪生智能产线采集点管理界面
如图5-6所示为数字孪生智能产线数据显示界面，可以新增、删除、管理各数据并进行相关配置，通过可视化数据（一般为时序数据），可以直观地看出数据变化的趋势。




 
图5-6  数字孪生智能产线数据实时显示界面
如图5-7所示为数字孪生智能产线数据转发界面，可以新增、删除、管理各数据转发项并进行相关配置，通过数据转发，可以实现数据的多平台、多功能、多视角利用，也就是按需接入，按需转发。









图5-7  数字孪生智能产线数据转发界面
如图5-8所示为数字孪生智能产线数据存储界面，可以新增、删除、管理各数据存储项并进行相关配置，如一个设备可以配置一个表，不同采集点位的数据可以实现为一个表头字段，可以说，该表就是该设备的数据模型，通过数据存储，可以很方便的调用历史数据，按4.1节所述方法对历史数据进行特征提取并分析，对未来情况进行一定程度的预测。




	如下图所示为数字孪生智能产线设备维护界面，可以采集接入到设备的电压、电流、震动水平等动态电气数据并进行可视化展示，同时可以利用这些数据采用4.1节的模型对数据进行特征提取并分析，得到故障预测结果或健康曲线。
图5-8  数字孪生智能产线数据存储界面

如图5-9所示为数字孪生智能产线设备维护界面，通过对历史数据以及实时数据，包括电压、电流、震动水平进行分析，如采用4.1节的方法可以得到设备的健康状况，进行预测维护。
 
图5-9  数字孪生智能产线设备维护界面
如图5-10所示为数字孪生智能产线设备故障分析界面，可以统计分析设备的故障次数以及设备的报警信息等，还可以对产线报警分析进行统计。
 
图5-10  数字孪生智能产线报警统计界面
5.3 算法接口设计
对于第四章所述的算法，包括故障检测模型、遗传算法调度模型、深度强化学习调度模型、混合流水线调度模型。其中收集数据对故障检测模型、深度强化学习调度模型进行模型训练得到如下模型：
 
图5-11  数字孪生智能产线算法模型权重文件
.pth和.pt文件是与PyTorch深度学习框架相关的文件格式：
	.pth文件是PyTorch模型的保存格式，通常用于保存模型的参数（权重和偏置）。这种格式可以保存模型的状态字典（state dictionary），其中包含了模型的参数。.pth文件常用于模型的保存和加载，以便于后续的模型训练、评估或推理。
	.pt文件是PyTorch的张量（Tensor）保存格式，它是一个序列化的PyTorch张量。这种格式可以用来保存单个张量或者张量的集合。.pt文件通常用于保存中间计算结果或者用于数据的持久化存储。

FastAPI 是一个现代、快速（高性能）的 Web 框架，用于构建 API，使用 Python 3.6 及以上版本。它基于标准 Python 类型提示，并且利用了 Python 类型提示的功能来自动生成文档。FastAPI 旨在成为一个快速且易于使用的框架。
采用FastAPI组件将算法发布成接口，具体流程为加载模型，从数据库中调取相关数据输入模型，模型输出一个预测结果。
对于遗传算法调度模型和混合流水线调度模型则采用Python进行相关代码设计。也采用FastAPI组件发布成接口，部分代码如下：
 
图5-12  数字孪生智能产线算法接口
Docker 是一个开源的应用容器引擎，它允许开发者打包他们的应用以及应用的依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，主要特点有容器化、隔离性、轻量级、可移植性等，采用Docker将上述接口部署到相关服务器，其中Dockerfile内容如下：




5.4 产线模型建立
整个智能产线有起点堆垛机、传送带、数控铣床1、机械臂1、数控铣床2、机械臂2、西门子加工中心、机械臂3、终点堆垛机等设备。我们根据实际设备的几何大小进行模型建立，而且需要对各个设备的不同零件进行单独建模以支持后续的实时仿真运动。对产线设备进行建模完毕后，需要把设备整合为一个场景，实现产线建模。Unity 3D 作为一种强大的游戏开发引擎，也被广泛应用于工业制造和可视化领域[76]。数字孪生技术通过创建物理实体的虚拟副本，使得产线的设计、监控和优化能够在虚拟环境中进行。
 
图5-13  数字孪生场景搭建示意图
利用Unity 3D进行数字孪生智能产线可视化可以达到高度逼真的视觉效果、实现交互性和实时性，而且Unity 3D多平台兼容且易于集成和扩展。 Unity 3D支持创建高质量的三维模型和场景，可以精确地模拟真实世界中的生产线环境，包括设备、人员、物料等。通过逼真的视觉效果，用户可以在虚拟环境中进行沉浸式的体验，更好地理解和分析生产流程。Unity 3D提供了强大的交互功能，用户可以通过模拟操作来控制数字孪生模型，如启动机器、调整参数等。同时，Unity 3D支持实时数据的集成，可以将实时的生产数据反馈到虚拟模型中，实现实时监控和响应[77]。Unity 3D开发的应用可以跨平台运行，无论是在桌面、移动设备还是VR/AR设备上，都能提供一致的用户体验。这使得数字孪生智能产线的可视化可以灵活地应用于不同的场景和设备。 Unity 3D具有良好的扩展性和兼容性，可以与其他工业软件和控制系统进行集成。通过API接口，可以将ERP、MES等系统的数据导入到Unity 3D中，实现数据的无缝对接和分析。
使用Unity 3D进行数字孪生智能产线可视化，需要：
	创建或导入三维模型：首先，需要创建或导入生产线的三维模型。这些模型可以是设备、传送带、机器人等，它们是构成数字孪生智能产线的基础。
	设计交互逻辑：接着，设计用户与数字孪生模型之间的交互逻辑。这包括用户如何通过界面与模型互动，以及模型之间的相互作用。
	集成实时数据：将生产线的实时数据集成到Unity 3D中，这可以通过编写脚本来实现。实时数据可以是生产速度、设备状态、质量检测结果等，它们将使数字孪生模型更加精确和实用。
	测试和优化：在开发过程中，不断测试和优化数字孪生模型的性能和用户体验。确保模型的准确性和响应速度，以及用户界面的友好性和易用性。
	部署和应用：最后，将完成的数字孪生智能产线可视化应用部署到目标平台，如桌面、移动设备或VR/AR设备，并在实际生产环境中进行应用。
 
图5-14  数字孪生智慧产线俯视图
如图5-14所示是该智能产线场景模型的俯视图，左边为起点，其中用不同颜色的方框标出了各个逻辑上的部件。对于相关设备的数据模型及交互，采用C#编程，具体函数对象定义如下：
	两个红色方框标出的是料仓，对应MulitSensorPartMotion；
	两个黄色方框标出的是堆垛机，轴运动对应JointsPartMotion，夹爪转向对应Sensor2MovePartMotionBase，夹爪上的物料对应SensorPartMotionBase；
	三个绿色方框标出的是机械臂，轴运动对应JointsPartMotion，夹爪对应GripperPartMotion；
	三个紫色方框标出的是机床，轴运动对应JointsPartMotion，刀库运动对应RotatePartMotionBase；
	五个橙色方框标出的是输送线的停止点，第一个停止点是单层停止点，对应LinePointPartMotion，第2、3、4个停止点是双层停止点，对应LinePoint2PartMotion，第五个停止点由于没有后继停止点，所以对应SensorPartMotionBase，停止点中的阻挡气缸和升降运动对应Sensor2MovePartMotionBase，夹紧气缸对应GripperPartMotion，第一个停止点只有一个阻挡气缸，第2、3、4个停止点有由阻挡气缸、升降气缸、夹紧气缸，第五个停止点没有气缸；
如图5-15所示为智能产线Unity3D场景搭建正面漫游图。主要有设备部件、设备台账、设备维护、生产数据等几个部分。
 
图5-15  数字孪生管理平台
设备部件：这个模块包含一个设备的所有部件的信息，包括部件名称、型号、规格、位置、制造商、采购日期、故障记录等。实时更新的部件信息可以帮助运营人员了解设备的当前状态和耐用程度、预测可能的故障，并做出相应的维护和更换策略；
设备台账：设备台账模块是对所有设备的汇总管理，记录设备的所有必要信息（如名称，型号，位置，厂商，购入日期等）。 这种集中式的管理方式可以帮助运营人员快速查找设备信息，理解设备的使用状态，并制定维护策略。同时，便于进行设备的资产管理，计算设备的折旧、报废、升级等成本；
设备维护：设备维护模块主要用于计划和记录设备的维修和保养工作。这包括安排例行维护，解决设备故障，更换部件，更新设备软件等。该模块可以提醒工作人员何时执行维护任务，及时应对设备故障，确保设备处于最佳状态；
生产数据：这个模块收集并分析实时生产数据，如生产量、设备工作时间、故障率和废品率等。这些数据可以帮助运营人员了解生产过程的效率、品质、成本，找出可能的问题，并寻找改进的方法；
场景漫游：实现数字孪生场景中的漫游，更加具体全面的观察产线的运行情况；
数据绑定与实时仿真：将现实世界中的数据通过文章上述方法采集上平台并与孪生场景中的设备相关数据点进行绑定，反映产线实际运行情况。 
 
图5-16  数字孪生智能产线场景1
 
图5-17  数字孪生智能产线场景2
第六章 总结与展望
6.1 论文总结与结论
本研究以数字孪生技术为核心，针对智能产线的设计与实现进行了深入的探讨和实践。通过对国内外数字孪生技术的研究现状进行分析，本论文明确了数字孪生技术在智能产线设计和实现中的重要性，并指出了当前研究中存在的挑战和问题。在此基础上，本研究提出了基于数字孪生的智能产线总体设计方案，包括智能产线的总体设计、多源异构数据采集与融合、设备与产线的数字孪生模型建立、产线设备故障检测、以及产线调度优化等关键技术。
在智能产线的总体设计方面，本研究详细阐述了需求分析、性能要求和系统架构设计，为构建高效、可靠和可扩展的智能产线提供了理论基础和实践指导。特别是在多源异构数据采集与融合方面，本研究提出了一种基于知识图谱的多源异构数据融合架构和方法论，为数据集成和互操作性提供参考借鉴，为构建准确的数字孪生模型提供了方向支持。
在数字孪生模型建立方面，本研究通过面向对象的多模态数据融合建模方法，实现了对物理实体的几何建模、物理建模、行为建模、电气建模、数学建模、交互及接口建模，实现了对物理实体的多维度描述，并且这些描述是相互依赖融合一体的。同时，本研究还探索了智能产线建模技术，包括流水线调度模型和混合流水车间调度模型，为智能产线的优化调度提供了解决方案。
在产线故障检测与调度优化方面，本研究提出了一系列基于深度学习的故障检测方法，实现对设备的健康检测；提出了基于均值聚类划分父本母本的遗传算法和基于深度强化学习及多瞥见机制的方法来实现智能产线的调度优化。通过实验验证，这些方法能够有效地检测设备的故障和提高产线的运行效率，降低了维护成本和时间成本。
系统实现方面，本研究利用Unity 3D构建了智能产线的数字孪生可视化平台，实现了对智能产线的实时监控和动态仿真；采用SSM架构构建了数据中台，实现了对数据的跨时间、跨空间利用；使用FastAPI进行相关优化算法的接口设计。该系统不仅提高了用户对产线运行状态的理解和控制，也为产线的优化提供了直观的决策支持。
综上所述，本研究在数字孪生智能产线的设计与实现方面取得了一定的成果，为推动我国制造业的数字化转型和智能化升级贡献了绵薄之力。
6.2 不足与未来展望
尽管本研究在数字孪生智能产线的设计与实现方面取得了一定的进展，但仍存在一些不足之处，需要在未来的研究中进一步探讨和完善：
	模型精确性和实时性的提升：虽然本研究提出了基于多模态数据融合的数字孪生建模方法，但在模型的精确性和实时性方面仍有提升空间。未来研究可以探索更先进的数据融合技术和建模算法，以提高模型的准确性和响应速度。
	数据分析和处理的高效性：随着产线数据量的不断增加，如何实现更高效的数据分析和处理成为亟待解决的问题。未来研究可以利用大数据分析和人工智能技术，提高数据处理的效率和准确性。
	智能产线的安全性和可靠性：智能产线的安全性和可靠性是企业关注的焦点。未来研究可以探索更多的安全策略和可靠性评估方法，以确保智能产线的稳定运行。
	跨学科技术的融合：数字孪生技术涉及多个学科领域，未来研究可以加强跨学科技术的融合，如物联网、云计算、人工智能等，以实现更全面和深入的智能产线解决方案。
	实际应用和案例研究：本研究虽然在理论和技术上进行了探索，但实际应用案例较少。未来研究可以结合具体的工业场景，开展更多的案例研究，以验证和优化智能产线设计方案的实际效果。
通过不断的研究和实践，数字孪生技术在智能产线中的应用将更加广泛和深入，为制造业的数字化转型和智能化升级提供更强的动力。






















缩略语表
英文缩写	英文全称	中文全称
IoT 	Internet of Things 	物联网
VR	Virtual Reality	虚拟现实
AR	Augmented Reality	增强现实
API	Application Programming Interface	应用程序编程接口
ERP	Enterprise Resource Planning	企业资源计划
MES	Manufacturing Execution System	制造执行系统
ML	Machine Learning	机器学习
FSP	Flow Shop Scheduling Problem	流水车间调度问题
HFSP	Hybrid Flow Shop Scheduling Problem	混合流水车间调度问题
CNN	Convolutional Neural Network	卷积神经网络
LSTM	Long Short-Term Memory	长短期记忆网络
GRU	Gated Recurrent Unit	门控循环单元网络
Self-attention	Self-attention Mechanism	自注意力机制






参考文献
	卢阳光,闵庆飞,刘锋.中国智能制造研究现状的可视化分类综述——基于CNKI(2005-2018)的科学计量分析[J].工业工程与管理, 2019, 24(4):10.DOI:10.19495/j.cnki.1007-5429.2019.04.003.
	Vachalek J , Bartalsky L , Rovny O ,et al.The digital twin of an industrial production line within the industry 4.0 concept[J].IEEE, 2017.DOI:10.1109/PC.2017.7976223.
	中国信息通信研究院. 数字孪生产业技术白皮书（2022版）[Z]. 2022.
	中国移动通信有限公司研究院. 数字孪生技术应用白皮书[R]. 2021-12-08.
	宗学妍. 基于数字孪生的车间作业仿真与监控系统的设计与实现[D].中国科学院大学(中国科学院沈阳计算技术研究所),2021.DOI:10.27587/d.cnki.gksjs.2021.000027.
	中国信息通信研究院，工业互联网产业联盟. 工业数字孪生白皮书（2021）[R]. 2021.
	陶飞,刘蔚然,刘检华,et al.数字孪生及其应用探索[J].计算机集成制造系统, 2018,
	NASA. NASA Technology Roadmaps, "TA 11: Modeling, Simulation, Information Technology, and Processing"[R]. NASA, 2010.
	Glaessgen E, Stargel D. The Digital Twin Paradigm for Future NASA and U.S. Air Force Vehicles[C]. In Proc. 53rd Structures, Structural dynamics and Materials Conference - Special Session on digital Twin, Honolulu, Hawai, USA, 2012.
	张天瀛,姬杭.数字孪生综述[C]//2019中国系统仿真与虚拟现实技术高层论坛.0[2024-11-12].
	胡晶. 工业互联网、工业4.0和“两化”深度融合的比较研究[J]. 学术交流, 2015, (1): 151-158. DOI: 10.3969/j.issn.1000-8284.2015.08.031.
	UHLEMANN T H J, LEHMANN C, STEINHILPER R. The digital twin:Realizing the cyber-physical production system for industry 4.0[J]. Procedia CIRP, 2017, 61: 335-340. DOI: 10.1016/j.procir.2016.11.152.
	GE. The Analytic Engine Behind Digital Transformation[EB/OL]. (2016-05)[2024-11-12]. https://go.digital.ge.com/2016-05-DPP_Digital_Twin-01-Landing-Page.html?scid=7011A000001AMDC.
	GE. Building digital twins[EB/OL]. [2024-11-12]. https://www.ge.com/digital/sites/default/files/download_assets/The-Digital-Twin_Compressing-Time-to-Value-for-Digital-Industrial-Companies.pdf.
	GE. Equipment Downtime Prevention | GE SmartSignal[EB/OL]. [2023-10-09]. https://www.ge.com/digital/applications/asset-performance-management-apm-software/equipment-downtime-prevention-ge-smartsignal.
	基于数字孪生的飞机总装生产线建模[J]. 浙江大学学报(工学版), 2021. DOI: 10.3785/2021-1008-973X-202105005.
	案例赏析：数字孪生在世界著名企业中的应用实践（1）[EB/OL]. (2024-10-18)[2024-11-12]. https://www.clii.com.cn/lhrh/hyxx/202105/t20210512_3949427.html.
	Industrial Digital Twin Association. IDTA – working together to promote the Digital Twin[EB/OL]. (2024-11-05)[2024-11-12]. https://industrialdigitaltwin.org/en/.
	Industrial Digital Twin Association. Members & Partners - Industrial Digital Twin Association[EB/OL]. (2021-02-16)[2024-11-12]. https://industrialdigitaltwin.org/en/about-idta/members-idta.
	中国航发. 中国航发：重塑业务价值 提升核心竞争力[EB/OL]. (2021-01-06)[2024-11-12]. https://www.aecc.cn/xwzx/jqyw/391549.shtml.
	通用航空发动机数字孪生技术研究[J]. https://mp.weixin.qq.com/s?__biz=MzI2ODM5MzM4Ng==&mid=2247504473&idx=2&sn=b9e00b4264345dc364115ddc71baa825.
	腾讯云开发者社区. 重磅｜国内数字孪生成熟度“大考”，腾讯得了第一名！[EB/OL]. (2023-10-31)[2024-11-12]. https://cloud.tencent.com/developer/article/2353367.
	刘青, 刘滨, 王冠, 张宸, 梁知行, 张鹏. 数字孪生的模型、问题与进展研究[J]. 河北科技大学学报, 2019, 40(1):68-78.
	邬贺铨. 数实的“共振”将推动实体经济进一步数字化、网络化和智能化[EB/OL]. (2022-12-01)[2024-11-12]. https://cloud.tencent.com/developer/article/2194973.
	陶飞,马昕,胡天亮,等.数字孪生标准体系[J].计算机集成制造系统, 2019, 25(10):14.DOI:CNKI:SUN:JSJJ.0.2019-10-001.
	陶飞,刘蔚然,刘检华,et al.数字孪生及其应用探索[J].计算机集成制造系统, 2018, 24(1):18.DOI:CNKI:SUN:JSJJ.0.2018-01-001.
	刘大同,郭凯,王本宽,等.数字孪生技术综述与展望[J].仪器仪表学报, 2018, 39(11):10.DOI:CNKI:SUN:YQXB.0.2018-11-002.
	吕汗青. 基于数字孪生的智慧快递工厂生产线的设计与实现[D]. 上海应用技术大学，2022.
	杨一帆，等. 数字孪生技术的研究现状分析[J]. 信息与控制，2022, 51(17): 29-33.
	郭亮，等. 数字孪生在制造中的应用进展综述[J]. 计算机集成制造系统，2020, 26(4): 590-599.
	黄海松，等. 数字孪生技术在智能制造中的发展与应用研究综述[J]. 贵州大学学报(自然科学版), 2020, 37(5): 1-9.
	数字孪生技术应用白皮书[R]. 中国信息通信研究院，2021.
	张鸣. 基于数字孪生技术的智能生产线设计与调试[J]. 电气技术，2023, (4): 1-8.
	数字孪生智能工厂（总体结构、技术架构、MES+ERP）建设方案[EB/OL]. (2024-05-27)[2024-11-12]. https://blog.csdn.net/weixin_44094929/article/details/139220626.
	西门子数字化工厂架构解读：生产数字孪生[EB/OL]. (2022-09-02)[2024-11-12]. https://zhuanlan.zhihu.com/p/560485331.
	裴兴林.基于数字孪生技术的智能产线设计与实现[J].中国新通信, 2023, 25(13):54-56.DOI:10.3969/j.issn.1673-4866.2023.13.020.
	王灵子，姜仁贵，朱记伟，等. 基于数字孪生的铁道工程预制构件生产线智慧管理系统研究[J]. 施工技术（中英文）, 2022, 51(17): 29-33.
	多源异构数据融合，深维数据推动数字孪生工厂落地[EB/OL]. (2021-03-05)[2024-11-12]. https://zhuanlan.zhihu.com/p/354815154.
	制造业生产过程中，多源异构数据是如何产生的？需要如何处理？[EB/OL]. (2022-10-13)[2024-11-12]. https://zhuanlan.zhihu.com/p/510751339.
	车间设备数据采集架构：生产线数据采集的关键要素与实践[EB/OL]. (2024-02-17)[2024-11-12]. https://cloud.baidu.com/article/3051488.
	何帆, 赵秀栩, 何梦旗, 李娇, 朱成辉. 多品种小批量离散制造过程多源异构数据集成与智能运维方法研究*[J]. 现代制造工程, 2024, 529(10): 49-59.
	魏一雄, 郭磊, 陈亮希, 等. 基于实时数据驱动的数字孪生车间研究及实现[J]. 计算机集成制造系统, 2021, 27(2): 352-363. DOI: 10.13196/j.cims.2021.02.004.
	多源知识融合技术研究综述[J]. 云南大学学报(自然科学版), 2019, 41(4): 1-12. DOI: 10.7540/j.ynu.20190481. 
	Denavit J, Hartenberg R S. A kinematic notation for lower-pair mechanisms based on matrices[J]. Journal of Applied Mechanics, 1955. 
	Khalil W, Kleinfinger J. A new geometric notation for open and closed-loop robots[C]// Proceedings of the 1986 IEEE International Conference on Robotics and Automation. IEEE, 1986, 3: 1250-1255.
	马汀. 流水线调度问题研究综述[J]. 计算机集成制造系统，2003, 9(6): 459-466. DOI: 10.3969/j.issn.1006-5911.2003.06.015.
	Johnson S M. Optimal two-stage production schedules with setup times included[J]. Naval Research Logistics Quarterly, 1954, 1(1): 61-68. DOI: 10.1002/nav.3800010109.
	潘泉. 作业车间调度问题的研究[J]. 计算机集成制造系统，1997, 3(3): 1-8. DOI: 10.3969/j.issn.1006-5911.1997.03.001.
	张新国. 流水线调度问题的研究进展[J]. 计算机集成制造系统，2001, 7(5): 387-393. DOI: 10.3969/j.issn.1006-5911.2001.05.037.
	刘宝碇, 杨善朝. 车间调度问题的研究进展[J]. 机械工程学报, 2006, 42(1): 1-11. DOI: 10.3321/j.issn:0577-6686.2006.01.001.
	流水线调度问题在制造业中的应用[EB/OL]. (2024-11-12)[2024-11-12]. https://www.sciencedirect.com/topics/engineering/flow-shop-scheduling-problem.
	Lagrangian relaxation with cut generation for hybrid flowshop scheduling problems to minimize the total weighted tardiness[J]. Computers & Operations Research, 2010, 37(1): 1-15. DOI: 10.1016/j.cor.2009.05.005.
	Jaehwan Yang. A new complexity proof for the two-stage hybrid flow shop scheduling problem with dedicated machines[J]. International Journal of Production Research, 2010, 48(5): 1247-1267. DOI: 10.1080/00207540802387553.
	Ruben Ruiz, Jose Antonio Vazquez-Rodriguez. The hybrid flow shop scheduling problem[J]. European Journal of Operational Research, 2010, 205(1): 1-10. DOI: 10.1016/j.ejor.2010.02.010.
	Thijs Urlings, Ruben Ruiz, Funda Sivrikaya Serifoglu. Genetic algorithms with different representation schemes for complex hybrid flexible flow line problems[J]. International journal of metaheuristics, 2010, 1(1): 45-66. DOI: 10.1504/IJMETA.2010.031457.
	S.M.T. Fatemi Ghomi, J. Behnamian, M. Zandieh. Development of a hybrid metaheuristic to minimise earliness and tardiness in a hybrid flowshop with sequence-dependent setup times[J]. International Journal of Production Research, 2010, 48(5): 1247-1267. DOI: 10.1080/00207540802387553.
	The Case Western Reserve University Bearing Data Center. Data files for Bearing Faults[EB/OL]. (2009)[2024-11-12]. https://csegroups.case.edu/sites/default/files/bearingdatacenter/files/Datafiles/97.mat.
	Hochreiter S, Schmidhuber J. Long Short-Term Memory[J]. Neural Computation, 1997, 9(8): 1735-1780. DOI: 10.1162/neco.1997.9.8.1735.
	Cho K, Van Merriënboer B, Gulcehre C, et al. Learning Phrase Representations using RNN Encoder-Decoder for Statistical Machine Translation[J]. arXiv preprint arXiv:1406.1078, 2014.
	Pan X , Ge C , Lu R ,et al.On the Integration of Self-Attention and Convolution[J].arXiv e-prints, 2021.DOI:10.48550/arXiv.2111.14556.
	Vaswani A, Shazeer N, Parmar N, et al. Attention is all you need[C]. In Advances in Neural Information Processing Systems. Long Beach: NIPS, 2017: 6000-6010.
	Holland J H. Adaptation in natural and artificial systems: An introductory analysis with applications to biology, control, and artificial intelligence[M]. Ann Arbor: The University of Michigan Press, 1975.
	曹杰, 张新国. 遗传算法在流水车间调度问题中的应用研究[J]. 计算机集成制造系统，2002, 8(8): 643-648. DOI: 10.3969/j.issn.1006-5911.2002.08.036.
	张新国, 曹杰. 遗传算法在混合流水车间调度问题中的应用[J]. 计算机集成制造系统，2003, 9(5): 373-378. DOI: 10.3969/j.issn.1006-5911.2003.05.032.
	Holland J H. Adaptation in natural and artificial systems: An introductory analysis with applications to biology, control, and artificial intelligence[M]. Ann Arbor: The University of Michigan Press, 1975.
	曹志刚，李建平. 遗传算法中交叉和变异算子的设计与研究[J]. 计算机科学，2001, 28(3): 47-51.
	MacQueen J B, Michelson M,amp; Boag W S. Some Methods for classification and Analysis of Multivariate Observations[C]// Proceedings of 5th Berkeley Symposium on Mathematical Statistics and Probability. University of California Press, 1967: 281-297.
	Sutton R S, Barto A G. Reinforcement Learning: An Introduction[M]. Cambridge: MIT Press, 1998.
	Mnih V, Kavukcuoglu K. Human-level control through deep reinforcement learning[J]. Nature, 2015, 518(7540): 529-533. DOI: 10.1038/nature14236.
	Vinyals O, Fortunato M, Jaitly N. Pointer Networks[C]. In Advances in Neural Information Processing Systems. Montreal, 2015: 2692-2700.
	Li K W, Zhang T, Wang R, et al. Research progress on combinatorial optimization based on deep reinforcement learning[J]. Acta Automatica Sinica, 2021, 47(11): 1-17. DOI: 10.16383/j.aas.2021.c200547.
	Wang J, Zheng D Z, Liu M. A survey on deep reinforcement learning for flow shop scheduling[J]. IEEE Transactions on Industrial Informatics, 2022. DOI: 10.1109/TII.2022.3202045.
	Autodesk公司. 3ds Max[EB/OL]. (2024-11-12)[2024-11-12]. https://www.autodesk.com/products/3ds-max/overview.
	Loop C T. The technical animator's handbook: a guide to tools and techniques for real-time computer animation[M]. CRC Press, 2019.
	Autodesk公司. 3ds Max Help: Materials and Mapping[EB/OL]. (2024-11-12)[2024-11-12]. https://knowledge.autodesk.com/support/3ds-max/learn-explore/caas/CloudHelp/cloudhelp/2023/ENU/3DSMax-Software/files/GUID-0D0D0D0D-0D0D-0D0D-0D0D-0D0D0D0D0D0D-htm.html.
	3D引擎行业专题研究：下一代互联网的“CAD”[EB/OL]. (2023-12-26)[2024-11-12]. http://mp.weixin.qq.com/s?__biz=MzIyMzYxNDEzMg==&mid=2247661197&idx=2&sn=1291ea0591ddeedbab6320543a9abcb2.
	Unity Manufacture Toolkit | Unity中国官网[EB/OL]. (2024-03-03)[2024-11-12]. https://unity.cn/product/umt.







致 谢
感谢电信科学技术研究院及国投融合课题单位给与的平台与课题支持以完成本论文。希望本论文的研究能给课题单位带来一些价值。



 

本科毕业设计（论文）


应用于高质量信号生成的光电振荡器研究

Research on Photoelectric Oscillator Applied in High Quality Signal Generation


学    院： 电子信息工程学院    
专    业： 通信工程            
学生姓名： 夏华衍              
学    号： 18221115            
指导教师： 武蓓蕾              


北京交通大学
2024年12月
 

学士论文版权使用授权书
本学士论文作者完全了解北京交通大学有关保留、使用学士论文的规定。特授权北京交通大学可以将学士论文的全部或部分内容编入有关数据库进行检索，提供阅览服务，并采用影印、缩印或扫描等复制手段保存、汇编以供查阅和借阅。

（保密的学位论文在解密后适用本授权说明）





学位论文作者签名：                   指导教师签名：

签字日期：2022年 6月 2日                 签字日期：2022 年6月   日












 
中文摘要
摘要：微波光子学是一种新兴的将微波学与光波学结合在一起的跨学科领域，它综合电域和光域的优势，为研制高品质的高频微波信号源打下了理论和技术基础。一般的微波生成技术包括电生微波技术和光生微波技术，然而传统的电生微波技术的相位噪声和振荡频率的平方成正比，一般而言很难在获得高振荡频率信号的同时拥有较低相位噪声。光生微波技术主要包括光谐波法等技术，而在这其中采用光电混合环形腔的光电振荡器以其独特的性能而鹤立鸡群。经过多年的不断研发，光电振荡器现在已经在无线通信系统、微波光子雷达、电子对抗战、传感测量等方面得到了广泛的应用，是光生微波技术的一个热门研究方向。光电振荡器拥有高带宽、高稳定性、高Q值、低抖动、低相位噪声等的一系列特点。本文主要内容如下： 
首先主要对目前的微波光子学背景进行简单说明并对几种传统的光生微波技术进行说明介绍，接着重点对光电振荡器的发展现状以及发展方向、光电振荡器的应用以及基本结构进行分析阐述；
其次对构成光电振荡器的主要电光器件进行简单介绍并重点对单环光电振荡器的振荡原理、相位噪声、振幅振荡、起振条件、频谱特性进行理论建模分析。采用MATLAB仿真软件对单环光电振荡器的部分参数特性进行分析研究，包括频谱特性、相位噪声、模式间隔、滤波器带宽、小信号开环增益、环路延时等并得出结论；
再者介绍双环光电振荡器的起振条件、组成结构、振荡原理、相位噪声等特性并对其中的关键参数及过程进行理论上的建模与分析。采用MATLAB仿真软件对双环光电振荡器的频谱特性、相位噪声、长短环的环长等进行分析研究并得出结论；
最后总结全文，对光电振荡器的未来发展提出见解。

关键词：微波光子学、光生微波、光电振荡器、MATLAB仿真



 
ABSTRACT
ABSTRACT: Microwave photonics is an emerging interdisciplinary field that combines microwave and light waves. It integrates the advantages of electrical and optical domains and lays a theoretical and technical foundation for the development of high-quality high-frequency microwave signal sources. The general microwave generation technologies include electro-generated microwave technology and photo-generated microwave technology. However, the phase noise of the traditional electro-generated microwave technology is proportional to the square of the oscillation frequency. Generally speaking, it is difficult to obtain a signal with a high oscillation frequency while having a lower phase. noise. The photo-generated microwave technology mainly includes the optical harmonic method, among which the photoelectric oscillator using the photoelectric hybrid ring cavity stands out from the crowd with its unique performance. After years of continuous research and development, optoelectronic oscillators have been widely used in wireless communication systems, microwave photonic radar, electronic countermeasures, sensor measurement, etc., and are a popular research direction of photogenerated microwave technology. Optical oscillators have a series of characteristics such as high bandwidth, high stability, high Q value, low jitter, and low phase noise. The main contents of this paper are as follows: 
Firstly, the current background of microwave photonics and several traditional photogenerated microwave technologies are briefly explained. Then, the development status and development direction of photoelectric oscillators, the application and basic The structure is analyzed and explained; 
Secondly, the main electro-optical devices that constitute the photoelectric oscillator are briefly introduced, and the theoretical modeling analysis of the oscillation principle, phase noise, amplitude oscillation, start-up conditions and spectral characteristics of the single-ring photoelectric oscillator is emphasized. MATLAB simulation software is used to analyze and study some parameters of the single-ring photoelectric oscillator, including spectral characteristics, phase noise, mode spacing, filter bandwidth, small-signal open-loop gain, loop delay, etc. and draw conclusions; 
Then, the starting conditions, composition, oscillation principle, phase noise and other characteristics of the double-ring photoelectric oscillator are introduced, and the key parameters and processes are theoretically modeled and analyzed. MATLAB simulation software is used to analyze and study the spectral characteristics, phase noise, long and short ring lengths of the double-ring optoelectronic oscillator, and draw conclusions.
 Finally, the full text is summarized, and the future development of optoelectronic oscillators is put forward.


KEYWORDS：Microwave photonics, optoelectronic oscillators, MATLAB simulation


 
目    录
中文摘要	i
ABSTRACT	ii
目    录	iv
1	绪论	1
1.1研究背景及意义	1
1.2光生微波技术	2
1.3光电振荡器	5
1.3.1光电振荡器研究现状及发展方向	5
1.3.2光电振荡器的应用	8
1.3.3光电振荡器基本结构	9
1.4本文主要内容	10
2	单环OEO性能分析	11
2.1光电振荡器关键器件	11
2.2起振条件	15
2.3响应函数线性化	16
2.4相位噪声	18
3	单环OEO仿真实验	24
3.1仿真思路	24
3.2仿真结果及分析	26
4	双环OEO性能分析及仿真	32
4.1振荡原理	32
4.2起振条件	34
4.3仿真建模	35
5总结与展望	40
参考文献	41
致    谢	44
附    录	45






 
绪论
1.1研究背景及意义
从中国古代的大雁传书到如今遍及全球的电话互联网，人们通信的方式一直在朝着更快更好的方向发展。自上世纪60年代第五次信息技术革命以来，人们要传输的信息量激增，需要更高的传输速度。因为信息的传输速率高低与系统工作带宽大小联系紧密，而3G、4G、Wi-Fi以及目前迅速普及的5G等技术的出现使得低频段的频谱资源不断饱和，所以在信息的传输过程中，信息发送和接受设备的工作频段持续地向微波和毫米波频段移动。因此，研制高质量的高频微波信号源目前显得尤为重要。然而传统的电生微波法存在由于散射、反射以及吸收而造成的衰耗随工作频率的提升而迅速增大的问题和电磁干扰的现象，无法成为一个较高质量的高频微波信号生成方案。如图（1-1）所示，该电学处理结构由于“电子瓶颈”的存在，宽带信号的产生、传输、处理极为复杂甚至在某些方面无法实现[1]。
上世纪七、八十年代以来，在激光二极管、光电二极管、基于电光效应的电光调制器等光电器件被发明与实际应用和各种微波元件、微波电路、微波设备蓬勃发展的背景下，微波技术与光波技术两门学科的部分领域交叉结合，产生了一种新的学科领域——微波光子学(microwave photonics, MWP)[2]。它利用光波技术可以更好地处理一般的电学微波技术难以处理的问题，以更好地实现微波、亳米波以及太赫兹信号的产生、传输、处理和测量。它的概念是在1991年被D. Jager 提出的[3]。该学科融合了上述两门学科的优点，相对于传统微波技术，具有带宽大、传输衰耗小、抗电磁串扰等的优势，为高品质滤波器、快速信息处理、高质量微波信号源等的热点研究方向提供了新的探究思路与实现可能。如图（1-2）所示，该结构拥有电域和光域的优势，近年来相关研究向着智能化和集成化的方向蓬勃发展并逐步进入实际应用。
 
图1-1 电学处理结构示意图






1.2光生微波技术
微波具有高度定向性以及易于集聚成束等的特性，其物理本质是频率在300MHz与300GHz之间的电磁波[4]。在无线通信设备、微波光子雷达、电子对抗战等领域，一个高品质的微波信号源是必不可少的。
传统的电生微波技术通常由交流电或者是直流电通过相关的电子器件来获得微波信号。一般而言，这些电子器件分为两大类：（1）、电真空器件：指利用电子在真空环境状态下进行能量交换的电子器件，也被称作电子管；（2）、半导体器件：是指利用半导体材料独特的导电率完成某些特定任务的电子器件。近年来，随着微波固体器件技术的不断成熟，各类基于半导体器件的振荡器不断涌现[5]。
但是，传统的电生微波源的相位噪声随着频率的增加而迅速增加，输出功率与相位噪声性能的矛盾一直存在，而且大部分有着功耗大、输出功率小、频谱纯度低、频率范围不高的缺点，相关研究人员不得不另辟蹊径。由于微波光子学吸取了光波领域的传输损耗小等的优势，可以用来解决传统微波领域中存在的“电子瓶颈”问题，因此光生微波技术研究成为了一个重要的课题，甚至已经上升到国家科研战略层面。光外差法[6]、光外调制法[7]、光谐波生成法等是常见的光生微波技术。
光外差法：这种方法是光生微波技术中比较简单的方法，基本结构如图（1-3）所示，两个激光器发出的不同频率的激光经由光耦合器耦合在一起并经过一段光纤传输，最后通过光探测器对耦合在一起的两路光波进行拍频，将光信号转换为所需的微波信号。如图（1-4）所示，该微波信号振荡频率为激光器1和激光器2发出激光的频率差值。我们假设两个光信号为：
A_1 (t)=A_1  sin⁡(ω_1+φ_1 )                                                       (1-1)
A_2 (t)=A_2  sin⁡(ω_2+φ_2 )                                                      (1-2)
其中，φ_1和φ_2分别是对应光信号的初始相位，A_1和A_2分别是光波场A_1 (t)和A_2 (t)的振幅， ω_1和ω_2则分别是对应光信号的角频率。则这两个光信号由光耦合器耦合在一起后经过光电转换后，可以根据光电探测器的传输特性得到输出的光电流I(t)为：
I(t)=ρ{(〖A_1〗^2 (t) 〖sin〗^2 (ω_1 t+φ_1 ) ) ̅+(〖A_2〗^2 (t) 〖sin〗^2 (ω_2 t+φ_2 ) ) ̅+(A_1 A_2  sin⁡(∆ωt+φ_2-φ_1 ) ) ̅+(A_1 A_2  sin⁡〖[〖(ω〗_1+ω_2 )t+φ_2+φ_1]〗 ) ̅ }                                            (1-3)
其中，ρ为光电探测器响应度，∆ω=ω_2-ω_1。一般实际应用中取差频项用滤波器滤出，而且采用的两个激光器的φ_1和φ_2一般相等或相干，因此最终的输出光电流为：
I_0 (t)=ρA_1 A_2  sin⁡〖(∆ωt)                                 (1-4)〗
可见其频率为两激光器的频率差。






这种方式生成的微波信号频率范围只受到光电探测器带宽范围的限制，但由于两束光信号的频率改变会使生成的微波信号发生频率抖动，相对相位变化会使生成的微波信号产生较大的相位噪声，所以必须要求两束光信号的相位和频率具有较高的相干性和稳定性，目前比较好的方法是对两激光器的相位进行锁定或采用双波长激光器这一器件。2011年，一个具有线性扫频功能的激光器和一个普通激光器和被台湾中央大学的科研团队用来进行外差拍频实验，产生了载波频率为9.7×10^9Hz，带宽为1.4×10^9Hz的啁啾光信号[8]。清华大学的谢世钟研究团队于2013年成功地在连续光和预啁啾光脉冲之间进行外差拍频实验，获得了时长为3.2ns，带宽为33GHz，中心频率约为20GHz的微波信号[9]，实验结果如图（1-5）所示，图（1-5 a）为微波信号时域图，图（1-5 b）为微波信号时频图。
 
图1-5 （a）为微波信号的时域图，（b）为微波信号时频图[9]

光外调制法：主要运用的原理是使激光器输出的连续光信号通过强度调制器，一般是马赫-曾德尔调制器，从而产生包含了所需的微波信号成分的上下两个边带信号。最后该光信号的特定光边带通过光电探测器后就可以产生有目标频率的微波信号。调制信号、调制器的性能、激光源决定了输出的微波信号。
光谐波生成法：光谐波生成法一般包含光纤非线性效应法、混频干涉法、带宽调制技术法。图（1-6）为光谐波生产法原理示意图。其中，光纤非线性效应法是指利用光纤的非线性特性，产生高阶谐波分量；混频干涉法的原理是使用RF信号和本振信号对激光器进行调制，之后在干涉仪上实现混频以产生所需的微波信号，这个方法受限于激光器的调制带宽，仍处于实验阶段；带宽调制技术是指利用电光调制器的非线性传输特性产生谐波，获得理想的微波信号；这些谐波由适当的带通滤波器滤波，将所需的两个光信号分量送入光电探测器进行光电变换以获得所需的微波信号。A .Wiberg等用光谐波法产生了频率为4.0×10^10Hz，信噪比为50dB的微波信号[10]。
 
图1-6 光谐波法生成装置

以上这些光生微波方法各有各的不足之处。为此，研究人员们不断寻求技术及理论突破，提出了一种近年来受到广泛关注的光电振荡器（Optoelectronic Oscillator，OEO）这一微波产生方法。经过几十年发展，OEO利用滤波器的选模特性和光纤的低损耗高储能特性，可以生成高相位噪声性能、低抖动、高频率、高Q值的微波信号，从而成为人们研究的热点方向，在微波光子雷达、光纤及无线通信系统、测量传感等应用广泛。所以，对OEO进行仿真建模是十分必要的。

1.3光电振荡器
1.3.1光电振荡器研究现状及发展方向
20世纪90年代，在微波光子学领域，利用电-光反馈环路技术，产生了一种新的光生微波技术——光电振荡器（OEO)。该技术利用激光器产生的光能转化为产生的微波信号，并在环状光电混合腔室中实现微波信号的振荡。它可以在数GHz到数百GHz之间输出高质量的微波信号，并且有光、电两种不同物理形式的信号输出。OEO克服了传统的微波振荡器的缺点，在微波和毫米波频段区间内有着出色的表现，并且相位噪声比传统的微波振荡器至少高出3个数量级。由于光电子器件一般带宽比较大，所以OEO可在大带宽范围内工作，能够实现信号处理、接收、产生等多种功能。而且近几年来，光电子器件技术不断地发展进步与成熟应用，OEO利用这些器件的独特特性和长光纤的低损耗高储能特性，生成了与常规电微波源相比的一种更小相位噪声和更高稳定性的微波信号，并且其相位噪声不随频率增大而上升，故而受到研究人员越来越多的重视。
德国哈根大学的Neyer研究团队于1982年第一次提出了OEO的基本组成结构，它通过输出端的微波电信号反馈控制电光调制器的方式来形成闭合回路以达到起振条件并输出微波信号[11]。1994年，姚晓天研究团队在美国喷气动力实验室设计了第一个单环路的光电振荡器的基本组成结构并进行了一系列的实验理论验证[12]。OEO的基本组成通常包括：激光器、电光调制器、光纤、光电探测器、电滤波器或微波光子滤波器、功分器、光耦合器、电放大器等[12]。OEO的器件参数一旦确定后，利用这些光学或电学器件就可以构成一个具有光电混合结构的正反馈闭合环腔，将激光源转换成低相位噪声的高Q值微波信号。OEO的振荡频率由固定的腔长和滤波器的中心频率来确定，环腔的总时延决定了环腔中能够起振的信号的频率，在滤波器的选模特性下，腔内信号在一段时间后实现稳定振荡，输出确定频率的微波信号。1996年，姚晓天研究团队经过多年的研究，从理论上对OEO进行了较为全面的分析，并测试了的OEO相位噪声等性能[13]。之后，OEO技术蓬勃发展，各种新型结构层出不穷（如下文要讨论的双环OEO），而且各种规格的军用、民用OEO产品也逐步测试验证完成并进入了实际运用阶段。由美国专注于OEO研究的OEWaves公司研制的高端OEO，其相位噪声在偏离中心频率1.0×10^4Hz处仅仅只有-163dBc/Hz。传统的OEO基本上是建立在一个闭合的光电环腔上，它的振荡频率范围很小，且存在高Q值和窄模式间隔（Free Spectral Range，FSR）的矛盾。
2000年，姚晓天研究团队提出了一种双环结构的OEO[14]，该双环OEO经过电光调制器调制后的光信号分别进入长短光纤对应的两个闭合环路，之后利用电滤波器滤除不需要的振荡模式。长光纤环路和短光纤环路都会有各自对应的起振条件，同时存在时会出现名为增益竞争的现象，结果仅有在同一时间满足这两个振荡条件的振荡模式才可以正常起振，最终表现为单模起振。双环OEO的长环路保证了振荡微波信号的高Q值低相位噪声，短环路则主要使该OEO结构有一个相对于单独长环路较大的模式间隔，方便后续的滤波操作。这种结构的OEO使得对振荡信号的边模抑制效果更好，更易于获得频率稳定的微波信号，其模式间隔为长短光纤各自对应模式间隔的最小公倍数。随着光纤环路的增加，振荡器单模起振的效果也就越好，但这会使结构的复杂性增大[15]。目前，大多数的双环结构都是采用电域分合路。天津大学江阳研究团队在2007年创造性提出光域分合路双环结构，并且得到了很好的成果[16]。近几年来，随着新观念、新技术的引进，光电振荡器的发展又有了新的生机和活力。通过在光电振荡器中引入参量振荡过程，可以实现稳定的多模振荡；傅立叶域锁模具有良好的模式控制性能，它可以打破常规的模式建立时间的局限，生成线性调频雷达信号，使其具有较大的时间带宽积；利用光子集成技术减小了光电振荡器的体积，使得它更加适用于实际应用；宇称-时间对称技术使得光电振荡器在不需要窄带滤波器的情况下就可以实现单模振荡[17]。如今，OEO技术已经得以在无线通信、微波光子雷达、微波阵列天线等领域得到运用，但任何事情都有它的局限性，OEO目前主要的发展方向如下：
第一，高Q值和单模输出相互冲突。在单环OEO中，随着光纤长度的增加，时间延迟会变长，Q值会提高。但是，因为OEO固有的模式间隔是闭合环路的总延迟时间的倒数，所以增加光纤的长度会增加环路总延迟时间，这就使环路的模式间隔变小。这会给之后的滤波操作带来极大的困难甚至难以实现，导致高的边模抑制比微波信号不易得到甚至会出现模式跳变、多模起振的不好情况。针对这个问题，双环路结构的OEO被提出[14]。在此方案中，由于游标效应，OEO的模式间隔为长环和短环对应模式间隔的最小公倍数，而相位噪声则主要由长环路来改善。虽然双环OEO在一定程度上降低了边模抑制比，但是没有确保得到高质量的单模输出，还存在相位噪声在一定范围内上升的问题[5]。目前，最简便、最有效地处理这一难题的方案是采用例如回音廊谐振器[18]、相位调制器和相移光纤布拉格光栅组成的高性能微波光子滤波器[19]来选定振荡模式，确保单模起振。
第二，频率稳定性。如温度、应力等外界因素的变化会影响到OEO的部分光电子器件的特性和环路光纤的长度，进而导致OEO的闭合环形腔的腔长不稳定，输出微波信号的频率在一定区间内抖动。为了解决这类情况，可以用对温度不敏感的特种光纤（如实芯光子晶体光纤）来替换一般的单模光纤，它能很好地稳定振荡频率，但是采用这种光纤也会出现传输损耗较大的问题，使OEO的相位噪声上升，同时也会提高制造成本。姚晓天建议把OEO放在一个充满泡沫的箱子中，以避免外界环境变化给该系统带来的影响[20]。但是，想要提高频率稳定性，比较好的方法是使用锁相环技术和注入锁定技术，最大限度使OEO的输出微波信号的各个参数保持不变，减少环境对OEO系统的影响。
第三，OEO的集成。目前，新一代无线通信和微波雷达系统对振荡器体积的要求不断提高，如何实现集成小型化是光电振荡器商用化和实用化的关键一步。由于传统的光电元件尺寸较大，难以实现集成化，因此实际应用情况并不理想。而滤波器、光纤，电光调制器等三个器件可以采用回音廊谐振器等的高Q光学器件取代，从而达到使OEO小型化和集成化的目的[5]。这些年来，随着越来越多的人投身于硅基光子集成技术领域，使得微波光子器件的小型化、集成化研究取得了许多重要突破[21]。如图（1-7）所示，为尺寸仅一块硬币大小的集成式硅基光电振荡器[22]，图（1-7）左边为其外观尺寸示意图，图（1-7）右边为其内部构造图，该OEO能产生相位噪声仅为-108dBc/Hz的35GHz的振荡信号。除了传统的硅基光子集成技术外，采用基于铟磷、氮化硅、铌酸锂、有机高分子材料等的光子集成技术也可以实现OEO器件的集成。如图（1-8）所示为一种基于铟磷基混合集成技术的光电振荡器[23]。然而，由于目前集成式光电振荡器仍限于传统的单环路，且相位噪声较大，故改善其储能容量（即 Q值），减小其相位噪声、频率可调和高频输出，将成为集成式光电振荡器的发展趋势[17]。
 
图1-7 基于硅基混合集成技术的OEO[22]
 
图1-8 基于铟磷基混合集成技术的OEO[23]
第四，高频输出。虽然OEO的相位噪声不受振荡频率的影响，但是相比于微波频段，在毫米波频段工作的有源放大器输出噪声大、功率小、效率低，无源器件传输损耗大。此外，传统电光调制器的光电、电光转换器效率较低、响应带宽低，这对毫米波信号在谐振腔中的增益特性有很大影响，难以起振或输出信号的信噪比变低。而谐波注入锁定法和倍频法是目前实现高频OEO的主流方法[24]。
第五，频率可调性，微波信号源的频率可调性是其实现大范围商业化的关键。一般来说，频率调整范围、频率调整步长、相位噪声变化、响应时间是频率带宽可调OEO几个重要指标[24]。由于光纤的色散特性，可以通过调整激光波长来调整OEO回路的有效延迟，以实现小范围的频率可调。Li.W等利用基于相移光纤布拉格光栅的可调谐微波光子滤波器（Microwave Photon Filter，MPF）在OEO环路中进行滤波处理，产生了频率从3GHz到28GHz的大范围可调微波信号[25]。渥太华大学的潘时龙研究团队于2010年使用法布里－珀罗激光器和马赫-曾得尔调制器构成微波光子滤波器，并通过调节激光波长或法布里－珀罗激光器的纵模来改变微波光子滤波器的传输峰值，从而实现OEO振荡频率的调节功能[26]。北京大学谢晓鹏研究团队于2013年采用了相位调制器和可调谐光滤波器构成微波光子滤波器并应用于OEO，在此基础上调整了可调谐光滤波器的频带，获得调谐范围为4.74GHz到38.38GHz的大范围可调微波信号[27]。
1.3.2 光电振荡器的应用
如上所述，通常OEO被用于生成一个高频率且低相噪的微波信号。这被广泛应用于信号生成技术，这种微波源可以作为无线通信系统的载波信号、触发信号，微波光子雷达的本振信号、参考信号等。研究人员不断改进技术和方案以得到更高质量的微波信号源，如双环OEO、注入锁定OEO等。OEO在注入锁定模式下被广泛应用于信号处理技术中。2010年，S.Pan研究小组提出了一种利用倍频OEO进行一系列的信号处理包括时钟恢复、非归零、归零或载波抑制归零格式转换、串并联转换和光再生等操作的方案[28]。
此外，OEO还可以用于测量传感领域。可以高精度测量温度、应变压力、折射率、光功率等。其基本原理是将被测量的变化所引起的光纤长度变化等的变化转化为OEO输出振荡信号频率的变化，再用频谱分析仪进行观测。频谱分析仪具有大带宽、高分辨率、快速响应等的特点。这种方案将测量量由光域变换到电域，充分利用现有的成熟高效高质量的电域处理技术。由于OEO振荡频率的高频特性，被测量所引起的频率变化占原始振荡频率的百分比很小，因此，基于OEO的传感测量系统有着高分变率的特点，广泛应用于传感与测量领域中。
线性扫频信号广泛应用于军事雷达中，其频率随时间线性增长，具有比较大的时间带宽积。因为常规OEO产生的微波信号通常具有固定的频率，所以要生成线性扫频信号，必须选择具有线性扫频特性的滤波器。中科院半导体研究所的李明研究团队用基于傅里叶锁模的方法突破了OEO中模式建立时间的制约，设计了一种线性扫频信号，其啁啾率为0.34GHz/us，时间带宽积为166650[29]。
1.3.3 光电振荡器基本结构
如图（1-9）所示：激光器、电光调制器、光纤、光电探测器、放大器、带通滤波器是经典的单环OEO的基本组成器件。其振荡原理如下：激光器发出的光信号进入电光调制器并在调制信号的作用下进行调制，再经过一段光纤传输后进入光电探测器，光信号被光电探测器转变为电信号后进入窄带通滤波器执行选频操作，抑制不需要的杂质微波，之后放大器将微波信号进行放大处理，最后该微波信号作为调制信号输入电光调制器，这样也就形成了一闭合正反馈回路[12]。微波信号在该OEO环路中多次循环反复，经过不断的电光转换、滤波放大以及反馈过程。随着振荡信号的增强以及电光调制器的饱和增益调制效应，OEO环路的非线性效应越来越显著，最后环路增益维持在1，使得微波振荡信号不再增强，从而形成稳定的单一频率自激振荡。值得注意的是，OEO的最初的起振信号来源于闭合环形腔中的一些噪声，一般包含相对强度噪声（Relative Intensity Noise，RIN）、约翰逊-奈奎斯特噪声（Johnson-Nyquist noise）、散粒噪声（Shot noise）、闪烁噪声（Flicker noise）等[30]。
相对强度噪声是由激光输出的光功率的起伏引起的。
约翰逊-奈奎斯特噪声，又称为热噪声，是指当热扰动使导体中的载流子处于均衡状态时产生的电子噪声，理想的电阻器热噪声接近白噪声。该定义也适用于光电探测器这类的导电介质，而不只是电阻，其单边功率谱密度为：
(v_n^2 ) ̅=4K_B TR                                                               (1-5)
这里有一个玻尔兹曼常数K_B（单位用J/K表示）、T是电阻的绝对温度（单位用K表示）、R是电阻值（单位用Ω表示）。
散粒噪声是由电子设备中的相关导线中的电流产生的，也就是由带有电流的离散载流子引起的。散粒噪声是一个泊松过程，其起伏标准差为：
σ_i=√2qIΔf                                                                    (1-6)
其中q是元电荷，通常取q= 1.602×10^(-19) C，I是通过电子器件的平均电流，Δf是测量噪声所覆盖的频带区间。
闪烁噪声是在光电阴极表面等的器件局部波动导致发射电子产生缓慢的随机波动现象。其功率谱密度与1/f成正比，一般在此功率谱下，可见光的视觉颜色是红色，于是闪烁噪声又被称为“红”噪声。在电子器件中,闪烁噪声主要集中在低频段处[31]。
 
图1-9 光电振荡器基本组成结构
1.4本文主要内容
第一章主要阐述了微波光子学这一学科的形成及发展，之后简单分析了一些传统的光生微波技术——谐波生成法、光外差法、光外调制法的原理及优缺点，接着对微波光子振荡器的发展现状及发展方向、基本应用领域、结构组成原理等进行介绍。
第二章对OEO的关键器件——光电探测器、激光器、滤波器、电光调制器进行简单介绍与基本参数分析，接着对单环OEO的起振条件、响应函数线性化、相位噪声、振荡幅度及频率、噪声来源等进行理论分析计算。
第三章介绍基本的仿真思路及原理并对单环OEO进行MATLAB建模，对OEO的关键参数进行MATLAB仿真分析，包括：振荡信号的时域和频域图特性、相位噪声与环路延迟的关系、振幅振荡与滤波器带宽的关系、振幅振荡与小信号开环增益的关系。
第四章对双环OEO的振荡原理、起振条件等进行理论建模分析。接着对其关键参数进行MATLAB仿真建模分析，包括：振荡信号的频域特性、长短环的长度及之间比例对环路相位噪声的影响。
第五章为总结，总结全文的研究过程及结果，并对OEO的未来发展提出个人见解。

 
单环OEO性能分析
光电振荡器关键器件
激光器：激光器为OEO中的电光调制器提供高品质的载波光信号。与电子振荡器类似，如图（2-1），传统的激光器结构主要由谐振腔、增益介质、泵浦源组成。泵浦源将能量送入增益介质以使其相关粒子从基态泵送至高能级态并实现粒子数反转。之后增益介质中会产生光的受激辐射放大作用，其中产生的光辐射由于反射镜的存在可以多次经过介质，提供稳定的光学正反馈；最终由受激辐射所提供的光增益比多次反射的光损耗要大，从而形成一个稳定的自激振荡并通过部分反射镜输出激光。OEO要求激光器有较高的频率稳定性和较好的耦合性。








在激光器的参数特性中，一般考虑相对强度噪声（RIN），也就是激光器光功率抖动的均方差和其平均光功率的比值。激光的功率可以由以下公式表达：
P(t)=P ̅+δP(t)                                                     (2-1)
其中包含功率平均值P ̅和功率波动值δP(t)，其中δP(t)的平均值为0。相对强度噪声就是δP(t)除以P ̅，这一比值在下面称为I。由此，可以通过功率谱密度（power spectral density，PSD）统计来描述相对强度噪声：
S_I (f)=2/P ̅^2  ∫_(-∞)^(+∞)▒〖δP(t)∙δP(t+τ)∙e^i2πfτ dτ〗                                        (2-2)
它依赖于噪声频率f。相对强度噪声（RIN）的功率谱密度的单位为〖Hz〗^(-1)，但是常常取它以10为底的对数再乘以10来表示，单位为dBc/Hz。通过对PSD在噪声频率区间 [f_1, f_2]上积分来得到相对强度噪声的均方根为：
〖δP/P ̅ |〗_rms=√(∫_(f_1)^(f_2)▒〖S_I (f)df〗)                                                   (2-3)
电光调制器：从理论和试验结果来看，当电场施加于具有电光效应的材料时，会改变材料束缚电荷的分布情况，进而使晶体的离子晶格发生细微的形变，并最终改变晶体的折射率[32]。组成OEO的电光调制器通常是马赫-曾德尔调制器(Mach-Zehnder Modulator，MZM)，该调制器结构如下图（2-2）所示。通过耦合器将输入光分为两个具有同样强度的光，通过上、下两个分支传输，在外加调制电压作用下MZM中的电光晶体（〖LiNbO〗_3）会受到其自身线性电光效应的作用，从而导致其晶体的折射率发生改变，进而对上下两支路的光信号进行相位调制，最后两路光合并在一起并输出。由于两路信号经过电光晶体后相位不同，之后叠加产生干涉现象，整体就表现为强度调制，也就是把电信号调制加载在光载波上。MZM的传输函数如图（2-3）所示，表现为一正弦型，V_π是半波电压，也就是当调制器中的上、下光信号在光程差为半个波长时所加的调制电压。当工作在正交偏置点附近时，归一化传输函数近视为线性函数。其插入损耗一般与输入波长和调制器的状态有关，定义为:
α=-10 log⁡(P_o/P_i )                                                   (2-4)
其中P_i是输入光功率，P_o是输出光功率。单位是dB。















假设输入马赫-曾得尔调制器（MZM）的光信号为：
A_in (t)=A_0 cos⁡(ω_c t)                                                   (2-5)
其中，A_0为输入光波信号的幅度，ω_c为其角频率，则进入上下两个分支的光信号应该相等，且为：
A_a (t)=A_b (t)=A_0/√2 cos⁡(ω_c t)                                           (2-6)
经过上下两支路的相位调制并合并，则可以得到输出光信号为：
                 A_out=A_0/2 [cos⁡(ω_c t+φ_a )+cos⁡(ω_c t+φ_b ) ]=A_0  cos⁡(ω_c t+(φ_a+φ_b)/2)  cos⁡((φ_a-φ_b)/2)                                                    (2-7)
其中，φ_a和φ_b分别为光经过上下两支路的相位改变量，一般设为：
φ_a≈〖-φ〗_b                                                        (2-8)
由此形成了一种推挽结构的MZM，于是有：
A_out=A_0  cos⁡(ω_c t)  cos⁡〖∆φ/2                                                  (2-9)〗
其中：∆φ=φ_a 〖-φ〗_b，我们可以得出输出光强为：
I=I_max 〖cos〗^2 (∆φ/2)=1/2 I_max [1+cos⁡(∆φ)]                                    (2-10)
其中，I_max是进入MZM的光载波的光强。如下图所示，当∆φ取值范围为0.5π附近时，可以近似为一线性调制过程。










∆φ不仅包括直流偏置，还包括调制信号所引起的相位变化，一般为余弦型，则有下式：
∆φ=(πV_m cosω_m t)/V_π +(πV_DC)/V_π =δ^' cosω_m t +Φ_DC                                 (2-11)
其中V_m和ω_m是调制信号的幅度和频率，V_π是MZM的半波电压，V_DC是加在MZM上的直流偏置， Φ_DC为直流偏置所引起的相位变化，δ^'=πV_m/V_π，δ^' cosω_m t为调制信号所引起的相位变化。
光探测器：光探测器是OEO的关键器件之一，其作用是把光载波携带的信号转换为相应的电信号。一般的光探测器应用光电效应，即入射光的光子与构成光探测器的物质中的电子产生作用，改变电子的运动，产生载流子，进而形成光电流。高品质OEO需要光探测器有高光电转换效率、快响应、宽频带、低噪声等的优点。OEO一般要求光探测器的响应快、带宽大。
滤波器：在OEO中应用的滤波器主要有常规的电滤波器和利用微波光子技术的微波光子滤波器，能使信号中不需要的频率分量大幅削弱而让某一特定的频率分量通过。利用电滤波器进行选频难以保证单个模式的微波信号起振，而具有双环或更多环路的OEO不能彻底解决环路中较宽模式间距与较低相位噪声的矛盾。目前，一般采用的方法是利用微波光子滤波器在光路中选取调制后的光边带，有基于布拉格光栅的OEO[33]、基于布里渊效应的OEO[34]。回音壁模式光学谐振腔具有高Q值、低损耗、体积小等特点，是OEO环路中用作滤波以及储能的元件[35]。


起振条件
众所周知，一般的电振荡器要起振就必须满足巴克豪森稳定性准则，即幅度条件和相位条件，而这篇文章所介绍的OEO也不例外。
Yao-Maleki模型是描述OEO的经典理论模型，该模型假设电光调制器为MZM，MZM的调制信号为 V_in (t)，那么它的输出光功率可用以下公式表达：
P(t)=((αP_0)/2){1-ηsinπ[(V_in (t))/V_π +V_DC/V_π ]}                                          (2-12)
其中：P_0——输入MZM的光功率
V_DC——MZM的直流偏置电压
V_π——MZM的半波电压
η——用来计算消光比(1+η)/(1-η)
α——MZM的插入损耗
调制后的光波信号经过光探测器变为电信号并经过放大器放大后的电压为： 
V_out (t)=ρP(t)RG_A=V_ph {1-ηsinπ[(V_in (t))/V_π +V_DC/V_π ]}                     (2-13)
其中：ρ——光探测器的响应度
R——光探测器的阻值
G_A——电放大器的传输增益
信号经过光探测器和电放大器后的电压为V_ph：
V_ph=RG_A  (αP_0 ρ)/2=RG_A I_ph                                                      (2-14)
其中，I_ph=(αP_0 ρ)/2为光电流。
之后信号进入MZM作为调制信号，形成闭合回路，因此OEO的小信号开环增益G_s为：
G_s≡├ (dV_out)/(dV_in )┤|_(V_in=0)=-(ηπV_ph)/V_π   cos⁡〖((πV_DC)/V_π )                                       (2-15) 〗
开环增益大于1是使OEO正常起振的条件之一。令上式〖|G〗_s |>1，就可以得到起振的阈值条件：
V_ph=V_π/(ηπ |cos┤⁡├ ((πV_DC)/V_π )┤| )                                                        (2-16)
当MZM处于正交偏置点时，即V_DC=0或V_DC=π且η=1，OEO的小信号开环增益最大，上式可写为： 
V_ph=V_π/π                                                                       (2-17)
满足：V_ph>V_π/π，就可以满足 OEO 环路起振的增益阈值条件，可见不需要放大器而使用大功率的激光器也有可能达到起振的增益条件。
在OEO系统中，起振除了要达到一定的增益阈值条件外，还必须具备下列相位条件：
ω_m τ+φ(ω_m )+ϕ_0=2mπ,m=0,1,2,…                                  (2-18)
即光在OEO中传输一周后相位变换为2π的整数倍。满足上述条件的振荡模式都有可能起振，但是由于滤波器的存在以及系统的非线性效应，最终会实现稳定的单模起振。
响应函数线性化
利用准线性理论，令MZM的调制电信号V_in (t)是一个标准正弦信号，其幅度是V_0,初始相角是β,角频率为ω，则：V_in (t)=V_0 sin⁡(ωt+β)。将V_in (t)带入式（2-13）后进行贝塞尔函数（Bessel）展开可得：
V_out (t)=V_ph {1-η sin⁡((πV_DC)/V_π ) [J_0 ((πV_0)/V_π )+2∑_(m=1)^∞▒〖J_2m ((πV_0)/V_π )  cos⁡(2mωt+2mβ) 〗]                             - 2η cos⁡((πV_DC)/V_π ) ∑_(m=0)^∞▒〖J_(2m+1) ((πV_0)/V_π )  sin⁡[(2m+1)ωt+(2m+1)β] 〗}                      (2-19)
由上面的公式可知，OEO所输出的信号含有许多的谐波成分，如果使用一个高性能的滤波器，滤除掉所需频带区间以外的频率成分，则能获得如下的输出信号：
V_out (t)=G(V_0 ) V_in (t)                                                        (2-20)
其中，G(V_0 )是电压增益系数，表示为：
G(V_0 )=G_s  (2V_π)/(πV_0 ) J_1 ((πV_0)/V_π )                                                       (2-21)

将上式泰勒展开可得：
G(V_0 )=G_s [1-1/2 ((πV_0)/〖2V〗_π )^2+1/12 ((πV_0)/〖2V〗_π )^4 ]                                  (2-22)
由于OEO中部分器件（如光探测器等）的传输函数是频率的函数，则可以用复函数F ̃(ω)表示OEO环路中与频率相关的所有部分的整体传输函数，F ̃(ω)表示为： 
F ̃(ω)=F(ω)  exp⁡[iϕ(ω)]                                               (2-23)
其中，F(ω)为OEO系统传输函数的实部,ϕ(ω)为环路色散引起的振荡信号相位改变量，带入公式（2-20），就可以得到复数域的输入输出表达式：
V ̃_out (ω,t)=F ̃(ω)G(V_0 ) V ̃_in (ω,t)                                         (2-24)
其中OEO系统中的输出与输入信号的复数表达分别为V ̃_out (t)与V ̃_in (t)。假设初始噪声信号也就是输入信号为：
V ̃_in (ω,t)=V ̃_in (ω)  exp⁡(iωt)                                              (2-25)
OEO的输出振荡信号就是起源于环路中的噪声信号，该噪声经过环路循环传输m圈后，可以用下面公式来表示输出信号：
V ̃_m (ω,t)=F ̃(ω)G(V_0 ) V ̃_(m-1) (ω,t-τ)                                   (2-26)
其中，τ为时延，m为循环次数，V_m为循环到第m次时的信号幅度且V ̃_(m=0) (ω,t)=V ̃_in (ω,t)，由于电光调制器和放大器的传输非线性，则微波振荡信号的幅度不可能一直被放大，所以最终OEO振荡稳定，输出的信号可以表示为：
V ̃(ω,t)=G_A V ̃_in (ω) ∑_(m=0)^∞▒〖F ̃(ω) 〗 G(V_0 ) e^iω(t-mτ) =(G_A V ̃_in e^iωt)/(1-F ̃(ω)G(V_0)e^(-iωτ) )                      (2-27)
振荡信号通过一窄带滤波器的作用形成信号频率为ω的稳定振荡，它的信号功率是：
P(ω)=〖|V(ω,t)|〗^2/2R=(G_A^2 |V_in (ω)|^2/(2R))/(1+〖|F(ω)G(V_0)|〗^2-2F(ω)|G(V_0)|cos⁡[ωτ+ϕ(ω)+ϕ_0])          (2-28)
令振荡幅度为V_osc，功率为P_osc=V_osc^2/2R，振荡频率和对应角频率为f_osc和ω_osc，把滤波器的中心频率设定为振荡信号的频率f_osc，而且系统传输函数F(ω_osc)=1，将式（2-21）中的增益G(V_osc)设为1，可以得到振荡信号的幅度为：
|J_1 ((πV_OSC)/V_π )|=1/2|G_S |   (πV_OSC)/V_π                                      (2-29)
如果OEO系统中的放大器有比较好的线性度，那么最终的振荡信号幅度主要受限于电光调制器——MZM的非线性。对于|Gs|<1.5的情况下，三阶展开式可以很好地逼近振荡信号的幅值[12]，由公式（2-22），计算出微波振荡信号幅度的三阶表达式为：
V_osc=(2√2 V_π)/π √(1-1/|G_s | )                                                 (2-30)
而在|Gs|<3的情况下，五阶展开式可以很好地逼近振荡信号的幅值[12]，由公式（2-22），计算出微波振荡信号幅值的五阶表达式为：
V_osc=(2√3 V_π)/π (√(1-1/√3 √(4/|G_s | -1)) )^(1/2)                                            (2-31)
从式（2-30）可知，要得到稳定的振荡，必须满足|Gs|>1这个临界增益条件。假定环路中振荡的模式为第k个模式，则对应的振荡频率可以从式（2-18）得到：
f_osc≡f_k=(k+1/2)/τ                 G(V_osc)<0                                 (2-32)
f_osc≡f_k=k/τ                         G(V_osc)>0                                  (2-33)
其中，k表示第k个振荡模式，τ是OEO系统的总延时，一般等于构成OEO的器件由于色散产生的群延时与环路物理长度延时τ′之和，可以表示为：
τ=〖(dϕ(ω))/dω|〗_(ω=ω_osc )+τ^'                                                  (2-34)
相位噪声
理想的频谱源的输出信号的瞬时频率为恒定值f，也就是频谱是一条窄谱线，但在实际情况下，信号中会有相位的随机抖动，表现为如图（2-6）所示的信号在频谱展宽，信号能量分布于所有频段。从图（2-5）所示的幅度抖动与相位抖动示意图可以看出，输出信号的幅度抖动表现为输出信号功率在一定范围内的抖动，相位抖动表现为频谱在一定范围内展宽。
    
图2-5 输出信号的幅度抖动和相位抖动示意图
 
图2-6 由于相位抖动实际频谱相对于理想频谱展宽了
所以，实际上的输出信号可以表示为：
V(t)=[V_0+m(t)]  sin⁡[2πf_0 t+φ(t)]                           (2-35)
其中：V_0——输出信号理想的幅度
f_0——输出信号理想的频率
m(t)——输出信号的幅度抖动函数
φ(t)——输出信号的相位抖动函数
我们重点讨论φ(t)。实验验证φ(t)为一随机过程且是一个宽平稳过程，亦即满足以下三个条件：（1）该随机过程的平均值为一不随时间变化的固定数值；（2）该随机过程的均方值是有限的；（3）自相关函数只依赖于时间差τ；它的自相关函数可以表示为：
R(τ)=E[φ(t)φ(t+τ)]                                             (2-36)
其中，τ是时间差，E[*]表示求数学期望。根据维纳-辛钦定理可知：某一函数的自相关函数和其功率谱密度是一对 Fourier变换对。故φ(t)的双边带（Double Sideband，DSB）功率谱密度可由R(τ)的傅利叶变换取得：
S_φ (f)=∫_(-∞)^(+∞)▒R(τ)  e^(-j2πfτ) dτ                                 (2-37)
其中f表示频偏，进一步有φ(t)的单边带（Single Sideband，SSB）功率谱密度可表示为：
S_φ^' (f)=2S_φ (f)               f≥0                                 (2-38)
单位量纲是〖rad〗^2/Hz。然而在实际操作中我们是无法直接测量R(τ)，而无法利用上述公式算出S_φ^' (f)，但是我们可以通过对φ(t)采样，计算φ(t)在时间区间[-T/2,+T/2]内的傅利叶变换：
Φ(f)=∫_(-T/2)^(+T/2)▒φ(t)  e^(-j2πft) dt                                           (2-39)
从而有：
S_φ^' (f)=lim┬(T→∞)⁡〖1/T〗 [〖Φ(f)〗^2 ]_m                                     (2-40)
其中m表示采样点数，在一定范围内越大则估计越准确，〖[*]〗_m表示将m个采样点的值进行平均，将上式再改写为：
S_φ^' (f)=10 log⁡〖{lim┬(T→∞)⁡〖1/T〗 [〖Φ(f)〗^2 ]_m }                                 〗 (2-41)
则单位量纲变为〖dBrad〗^2/Hz。
实际工程应用中，如图（2-7）所示，我们将相位噪声表示为在频偏f_m处1Hz带宽内的噪声功率与振荡信号f_osc的功率之比，表示为公式（2-42）：
 
图2-7相位噪声定义示意图
L(f)=(P(f_osc+f_m))/(P(f_osc))                                                 (2-42)
该式只能用来估算白噪声或加性噪声带来的相位噪声。为了统一，国际上通常将SSB相位噪声表示为：
L(f)=1/2 S_φ^' (f)                                                         (2-43)
接下来我们对OEO的相位噪声进行分析，上文说过OEO的振荡信号最初来源于环路中的噪声信号，设OEO环路的噪声信号功率谱密度为下式所示：
ρ_N (ω)Δf=|V ̃_in (ω)|^2/2R                                                     (2-44)
其中,Δf为频谱宽度,ρ_N (ω)为噪声功率谱密度。令F(ω_osc )=1，将式（2-44）带入式（2-28）则可以得到振荡模式的功率谱密度为：
S_RF (f^' )=(P(f^'))/(ΔfP_osc )=(ρ_N G_A^2/P_osc)/(1+〖|F(f^')G(V_osc)|〗^2-2F(f^')|G(V_osc)|cos⁡(2πf^' τ))            (2-45)
其中，f^'=(ω-ω_osc )/2π表示相对于振荡频率f_osc的频率偏移，假设振荡信号的谱宽远远小于OEO的模式间隔，即Δf<< 1/τ，所以可以对振荡模式的功率谱密度在[-1/2τ,+1/2τ]范围内归一化，则有： 
∫_(-∞)^∞▒〖S_RF (f^')df^'≈∫_(-1/2τ)^(1/2τ)▒〖S_RF (f^' )df^'=1                             (2-46) 〗〗
 令|F(f^')|=1, 则可以得到：
1-|G(V_osc )|^2≈2[1-|G(V_osc )|]=δ/τ                                    (2-47)
其中, δ=ρ_N G_A^2/P_osc为OEO 中噪声与振荡信号功率的比值。将公式（2-47）带入公式（2-46），可以得出振荡信号的功率谱密度为：
S_RF (f^' )=δ/((2-δ/τ)-2√(1-δ/τ) cos⁡(2πf^' τ))                                    (2-48)
上式中一般情况下2πf^' τ<<1，则可以将其中的余弦函数进行泰勒展开，则上式可以近似表示为： 

S_RF (f^' )=δ/((δ/2τ)^2-(2π)^2 (f^' τ)^2 )                                                     (2-49)
由上述公式可知，该振荡信号的功率谱密度符合Lorentzian分布，其半高全宽Δf_FWHM表示如下： 
Δf_FWHM=δ/(2πτ^2 )=(G_A^2 ρ_N)/(2πτ^2 P_osc )                                              (2-50)
从上式可以看出，Δf_FWHM和噪声与振荡信号功率的比值成正比例关系，和闭合环路延迟的平方成反比例关系。根据经典的Q值定义可以得到系统的Q值为：
Q=f_osc/(Δf_FWHM )=Q_D  τ/δ                                                      (2-51)
其中Q_D=2πf_osc τ是环路时延线的质量因子, Q_D≪1，根据公式（2-49）可得：
S_RF (f^' )=(4τ^2)/δ                      |f^' |<  (Δf_FWHM)/2                                      (2-52) 
S_RF (f^' )=δ/(4τ^2 〖(τf^')〗^2 )           |f^' |>  (Δf_FWHM)/2                                     (2-53) 
从式（2-53）我们可以得知，当OEO频偏f^'大于Δf_FWHM/2时，其相位噪声与频偏f^'和OEO环路延时τ的平方的倒数成正比例关系，并且在一定频率偏移下，OEO相位噪声随着环路时延的增大而减小。然而，随着环路时延的增大，OEO的相位噪声降低，但其相位噪声必然不会小于0。由于当环路延时过大时，会引起多模振荡的问题，因此上述公式不再适用；当频偏小于Δf_FWHM/2时，OEO的相位噪声谱近似等于常数，一般不在此范围内分析相位噪声；而且上述公式表明OEO的相位噪声与其振荡信号角频率值ω_osc没有联系，则OEO生成的微波信号具有高频率低相噪的特点。
我们接下来讨论一下OEO中的噪声。热噪声、散粒噪声、激光器的相对强度噪声（RIN）和闪烁噪声[30]（具体定义见第一章光电振荡器的基本结构）等各种噪声构成了OEO的输入噪声密度ρ_N，于是总的噪声功率谱密度ρ_N可以表示为:
ρ_N=4K_B T(N_f )+2eI_ph R+N_RIN I_ph^2 R+N_F                              (2-54) 
其中  K_B——玻尔兹曼常数；
T——温度；
N_f——电放大器的噪声系数；
e——电子电量等于1.6×10^(-19) C；
I_ph——光电流；
N_RIN——激光器的RIN；
N_F——闪烁噪声功率谱密度；
闪烁噪声是一种由电放大器之类的器件引入的低频率噪声，它的功率与频偏成反比。与环长相关的噪声有：偏振模色散、纤双重散射、激光器的RIN由色散变换而来的相位噪声、环境因素引入的噪声等。大体上，P_osc是一个关于电流I_ph和电放大器电压增益G_A的函数。所以可得：
δ=〖|G_s |〗^2/(1-1/G_s )  (4K_B T(N_f )+2eI_ph R+N_RIN I_ph^2 R+N_F)/(4η^2 〖cos〗^2 (πV_B/V_π)I_ph^2 R)                       (2-55) 
由上述公式可知，当小信号开环增益G_s满足特定条件的时候，即|Gs |=3/2，δ可以达到一个最小值。结果表明，此时振荡信号的幅度约为半波电压的二分之一，OEO的噪声最小。从上述公式中还可以看到，当频率较低时，闪烁噪声是OEO中的主要噪声。当频率增大时，闪烁噪声会降低，激光器的RIN成为主要的噪声。

 
单环OEO仿真实验
仿真思路
OEO具有三个广泛分离的时间或频率尺度：输出信号的频率，约为千兆赫兹、腔模间距，约为百千赫兹、相位噪声的频率，约为几到数千赫兹。所以我们的仿真思路是明确区分快时标T和慢时标τ[36]，基本思路如下：
射频放大器的输出可以由公式（2-13）给出，该输出作为射频滤波器的输入，假设射频滤波器的传输函数是线性的。因此，在时域中，射频滤波器的响应可以由下式给出：
a_out^fil (T)  exp⁡(-2πmf_c T)=∫_(-∞)^T▒〖a_in^fil (T^' )  exp⁡(-2πmf_c T^' )f(T–T^')dT^' 〗            (3-1)
其中a_in^fil (T)=a_out^amp (T)、a_out^fil (T)分别是射频滤波器的输入和输出信号；f_c=ω_c/2π是载波信号频率；f(T)是射频滤波器的脉冲响应函数。
由于滤波器的输出受其输入信号的影响，所以滤波器在时域中的输出由其在时间间隔[T-T_f,T]内的输入决定，T_f=1/Γ。为了计算频域中的滤波器响应，我们考虑复振幅a(T)，其在时间窗[T-T_tot,T],且 T_tot>T_f里的傅利叶级数为:
a(T)=∑_(k=-∞)^∞▒〖a ̃(f_k )  exp⁡(-2πmf_k T)                                           (3-2)〗
其中a ̃(f_k)表示傅利叶系数，f_k=k/T_tot是相对于所选载波频率f_c的频率偏移。滤波器的频域响应函数如下所示：
a ̃_out^fil (f_k )=F(f_k+f_c ) a ̃_in^fil (f_k )                                                         (3-3)	
其中a ̃_out^fil (f_k )和a ̃_in^fil (f_k )分别是a_out^fil (T)和a_in^fil (T)的傅里叶系数；F(f^') 是函数f(T)的傅利叶变换，则可以得到 ：
F(f^' )=∫_(-∞)^∞▒〖f(T)exp⁡(2πmf^' T)〗 df^'                                        (3-4)
在以下的仿真中，假设所用滤波器为一个具有洛伦兹线型的滤波器，其频域响应函数为：
F(f_k+f_c )=(mΓ/2)/(f_k+f_c-f_0-mΓ/2)                                              (3-5)
f_0是滤波器的中心频率。在时域中，滤波器脉冲响应函数由下式给出：
f(T)=πΓ exp⁡[-2πm(f_0+mΓ/2)T] u(T)                                        (3-6)
其中u(T)为单位阶跃函数。
我们假设滤波器脉冲响应的有效持续时间比光纤的延迟短，用a^(l-1) (T)和a^l (T)来表示滤波器输入信号在时间区间，[(l-2)τ,lτ]内的复振幅，则有：
a_(in,2τ)^l (T)={█(a^(l-1) (T)          for  (l-2)τ≤T<(l-1)τ@a^l (T)                          for  (l-1)τ≤T<lτ)┤                            (3-7)
计算a_(in,2τ)^l (T)与滤波器时域脉冲响应的卷积就可以得到滤波器的输出a_(out,2τ)^l (T)。则在下一次循环时，在时间区间lτ≤T≤(l+1)τ里, 〖a^(l+1) (T)=a〗_(out,2τ)^l (T-τ)。
将系统中的总噪声建模为单个白噪声源，作为频域中放大器的输入。在振荡器中每次往返之后，使用下列关系添加噪声:
a ̃_out^(l,amp) (f)=G_A [a ̃_in^(l,amp) (f)+w ̃^l (f)]                                            (3-8)
为了确定100 Hz–100 kHz范围内射频频谱的低频成分，使用电压振幅a_Mτ (T)。T为T_0<T<T_0+Mτ。定义a_Mτ (f)的离散傅利叶变换：
a ̃_Mτ (f)≜F_Mτ [a(T)]=1/Mτ ∫_0^Mτ▒〖a_Mτ (T+T_0 )  exp⁡(2πmfT)dT                       (3-9)〗
在M次循环中累积计算需要存储的包络函数a_Mτ。可以解析的最低频率为1/Mτ。当滤波器带宽与腔模间距相比较宽时，OEO可以在几种不同的腔模之一中工作。除非振荡频率恰好等于所选载波频率f_c，否则相位ϕ(T)线性地取决于时间。为了计算这些情况下的相位噪声，我们从时间相关相位中除去线性相位变化。在计算相位噪声时，我们还减去时间平均相位，只留下二次和高阶时间依赖关系。相位噪声一般表示为相位ϕ(T)的自相关函数的Fourier变换，也就是相位的功率谱密度S_ϕ (f)。在每一次模拟中都使用下列关系式计算相位噪声：
ϕ ̃_Mτ (f)=F_Mτ [ϕ(T)]                                                             (3-10)
在Mτ时间内相位的功率谱是通过将相位的功率谱除以频率分辨率δf^'=1/Mτ得到的。
S_ϕ^Mτ (f)=|ϕ ̃_Mτ (f)|^2/(δf^' )                                                           (3-11)
注意到当M→∞，S_ϕ^Mτ (f)接近相位的功率谱密度S_ϕ (f)。
仿真结果及分析
根据以上仿真思路，令M=10000，并在OEO振荡2000次后开始积累其振幅函数值，则仿真总的振荡循环次数N=12000，设置洛伦兹线型滤波器带宽Γ为15MHz，中心频率f_0为10GHz，载波频率也就是激光频率f_0也设为10GHz。仿真得出的振荡信号归一化时域图如图（3-1）所示，可见其为一标准正弦函数图像。










仿真得出的振荡信号频域图如图（3-2）所示，注意横坐标为相对于振荡频率的频率偏移。该图像在一定误差范围内可近似为一直线，底下的随机曲线是OEO中的底噪，其组成上述文章已有分析。大致可见其相位噪声比较低，基本可以忽略。









我们将图（3-2）部分区域缩放得到图（3-3），可见该OEO有多个腔模式，在滤波器的选模作用下其功率随频偏增大而递减。理论上模式间隔为1/τ, τ为该OEO装置的总时延。因为信号在OEO环路时延主要取决于光纤的长度，所以τ近似等于τ^'，τ^'为信号在光纤中的时延，仿真中将τ^'为为1us。然而在实际仿真中得出1/τ=9.861×10^5Hz，而1/τ^'=1.0×10^5Hz，可见τ略大于τ^'，这是由于OEO中除了光纤外还有其他器件也对信号有延时作用，相对于光纤的延时量可以忽略不计。我们假设一个中心频率为10GHz的洛伦兹线型（Lorenzian line shape）滤波器，该滤波器的频域图像大致如图（3-4）所示，f_0为滤波器的中心频率，其带宽Γ设置为15MHz。在该滤波器的选模作用下，只有一个腔模式可以正常起振，理论上振荡频率为10GHz。由于1/τ≪f_0，所以在一定误差范围内可以近似得出仿真振荡频率为10GHz（误差%0.0004）。










我们接下来设置参数τ^'分别等于0.14us、0.28us、0.66us。根据3.1章节所述思路仿真计算振荡信号的相位噪声。仿真结果如图（3-5）所示，绿色曲线代表相位噪声，黑色点划线是对绿色曲线进行最小二乘拟合的结果。可以看出，绿色曲线表示的相位噪声总体上随着频率偏移的增加而呈下降趋势，而在接近振荡频率的其他模式的频率上，即1/τ频偏处有一个陡增，这可以解释为类似图（3-3）所示的振荡频率右边的第一个模式没有被滤波器完全抑制。可以选择窄带宽的滤波器或者高性能的微波光子滤波器来增大边模抑制比，或者采用双环结构来增大OEO的模式间隔。最小二乘拟合结果所表示的黑色点划线随τ的不同而有着不同的斜率和截距，τ增大斜率也就增大，相应的截距减小。对比图（3-5）中三个图可以看出相位噪声随着τ的增大而整体下降，工程中一般通过增加光纤长度来增加τ。由于光纤的低损耗高储能特性，增加光纤长度我们可以得到较高Q值，亦即降低相位噪声，如公式（2-53）所示。另外，我们可以发现，随着τ的增加，OEO的模式间隔1/τ变小，表现为三个图右部相位噪声凸起尖峰间隔逐渐变密，在这过程中可以发现离振荡频率最近的一个模式间隔尖峰变高了，这是由于窄模式间隔不利于滤波操作，也就是滤波器滤波不彻底，这就需要采用高性能的滤波器。





















改变光纤长度以改变环路时延并仿真记录OEO在10KHz频偏处的相位噪声可以得到如图（3-6）所示为OEO环路中相位噪声和环路延时的关系。可见随着环路延时的增加，10KHz频偏处相位噪声功率谱密度是线性降低的。










如图（3-7）所示，绿色实心线表示相位噪声功率谱密度，是通过对350次仿真所得相位噪声的平均结果；黑色点划线是对单个仿真结果进行最小二乘拟合的结果；红色点线表示的是Yao–Maleki模型的结果；可以看出绿色实心线与黑色点划线大致重合，可见相位噪声是一个宽平稳过程，具有遍历性，如2.4章节所述。因为Yao–Maleki模型忽略了电光调制器的快速增益响应，所以其相位噪声与本仿真结果有着2.5 dB的差异。











通过仿真实验可以发现当OEO的小信号开环增益GS>2.31时，环路振荡信号出现振幅振荡。Chembo课题研究组在实验上观察了OEO中的振幅振荡，他们用一个简单的延迟微分方程描述了这种效应[37]。
通过设置小信号开环增益GS=2.4获得的标准化振幅如图（3-8）所示，可以看出归一化变化周期为2。图（3-8 a）所示为出现振幅振荡时的时域图像，可以看出其为一不规则正弦图像，振幅在做周期性变化。图（3-8 b）所示为图（3-8 a）对应的振幅的变化情况，可以看出其大致为一周期为2的方波函数。











图（3-9）所示为小信号开环增益GS=2.75获得的标准化振幅，可以看出归一化变化周期为4。而且图（3-9 a）所示的振荡信号时域图越来越偏离标准正弦函数。











而当GS>2.75，我们发现出现一个以上频率的振幅振荡，振幅的时间演化变得非周期。如图（3-10）所示，振幅无规律变化。











这些振幅振荡可以通过使用足够窄的滤波器来抑制。我们设置小信号开环增益GS=2.4，τ^'=0.14us，改变滤波器带宽发现当带宽Γ<〖2/τ〗^'时，振幅振荡被抑制。如图（3-11）所示，分别为Γ等于12MHz、16MHz、20MHz时振幅的变化。可以看出，当Γ减小时振幅振荡被抑制，当Γ=12MHz时，没有像图（3-8）所示的那样出现振幅振荡，而且对比图（3-11 b）和（3-1 c）可以发现，当Γ增加时，振幅变化得比较陡，也就是对振幅振荡的抑制作用没有那么明显。




















当滤波器带宽Γ足够宽时，OEO可以在几种腔模式中的一种模式下振荡。在稳态下振荡的腔模式由OEO开启时存在的噪声决定。仿真设置滤波器的带宽Γ等于20MHz，时间延迟τ^'等于2us，载波频率f_c为10GHz，得到如图（3-12）的腔模式竞争图，左边为射频频谱图，注意右边所示的振幅的实部图的频率是相对于载波频率的频偏。可以得知OEO振荡频率的变化是离散的，且变化间隔为其腔模式间隔。

 
双环OEO性能分析及仿真
振荡原理
我们之前讨论的都是单环OEO，一般而言，OEO中的光纤越长，所输出的微波振荡信号的Q值越高，信号质量越好。然而，光纤越长意味着最终的模式间隔〖1/τ〗^'越小，例如，对于4 km长的光纤环路，模式间隔约为50 kHz，这就对带通滤波器提出了比较高的要求，需要带通滤波器有着较窄的通带，然而传统的滤波器很难在有着窄的通带的同时有着较高的滤波特性。于是，有着双环结构的OEO被提出，双环OEO有两个光纤环路，一长一短，只有同时满足两段光纤的振荡条件的相关模式才可以稳定起振。如图（4-1）所示，虚线为滤波器的传输函数，蓝色箭头表示模式间隔的频谱。实际上，由于游标效应，最终是相对扩大了单独长环的模式间隔。其中，短环加大了振荡器的模式间隔（FSR），长环则保证输出信号有着较高的Q值。












如图（4-2）所示，典型的双环OEO主要有两种结构。图（4-2 a）所示双环OEO的两路光信号分别通过不同的光电探测器产生电信号并在电耦合器处进行耦合后通过放大选频链路，最后作为调制信号输入电光调制器；图（4-2 b）所示两路信号分别经过不同的光电探测器、带通滤波器、放大器后进入电光调制器上下两个入口后在电光调制器进行耦合。





















广义的双环OEO还包括注入锁定型双环OEO，其基本结构如图（4-3）所示，较长的环路（称为主环路）生成相位噪声非常低的谐波信号。较短的环路称为从环路，用于减小杂散的幅度。部分主信号Γ12被注入从环路，如实线箭头所示。虚线箭头表示部分从信号Γ21耦合回主回路[38]。









起振条件
虽然实际的双环OEO结构上略有差异，但是其振荡原理本质上是相同的。姚晓天研究团队提出一种比较典型的双环模型。此模型有类似上述单环OEO的递归关系：
V ̃_i (ω)=(g_1 e^(jωτ_1 )+g_2 e^(jωτ_2 ) ) V ̃_(i-1) (ω)                                      (4-1)
其中：τ_1、τ_1——分别为长短两个环路的时延
g_1、g_2——分别为长短两个环路的增益
V ̃_i (ω)——光信号在环路中传输i次后的复振幅
待振荡稳定后可以得到：
V ̃_out (ω)=∑_(i=0)^∞▒〖g_1 e^(jωτ_1 )+g_2 e^(jωτ_2 ) 〗 V ̃_i (ω)=V ̃_0/(1-(g_1 e^(jωτ_1 )+g_2 e^(jωτ_2 )))        (4-2)
其中，V ̃_0为输出信号的复振幅，进一步可以得到：
P(ω)=|V ̃_out |^2/2R=(〖|V_0 |〗^2/2R)/(1+〖|g_1 |〗^2+〖|g_2 |〗^2+2|g_1 |*|g_2 |  cos⁡(ϕ_1-ϕ_2 )-2(|g_1 |cosϕ_1+|g_2 |cosϕ_2))           (4-3)
若长短两个环路的增益|g_1 |和|g_2 |都小于1，则单独的个两环路都不会起振。但是如果某一模式同时满足两个环路的相位条件，亦即有下述关系式：
ϕ_1 (ω)=2N_1 π  
ϕ_2 (ω)=2N_2 π 
 ϕ_1 (ω)-ϕ_2 (ω)=2〖(N〗_1-N_2)π                             (4-4)
类似单环OEO，N_1、N_2分别为振荡环路1和环路2所对应的纵模阶数，将此相位条件带入式（4-3），可以得到：
P(ω)=(〖|V_0 |〗^2/2R)/(1+〖|g_1 |〗^2+〖|g_2 |〗^2+2|g_1 |*|g_2 |-2(|g_1 |+|g_2 |))                    (4-5)
为了使该OEO起振，需要将上式中的分母为0，则有：〖(1-|g_1 |-|g_2 |)〗^2=0，也即：
|g_1 |+|g_2 |=1                                                          (4-6)
该式即为双环OEO的增益条件。
单独长环路的模式间隔与单独短环路的模式间隔的公倍数是最终的双环OEO的模式间隔，即为：
∆f=gcd⁡(1/τ_1 ,1/τ_2 )                                                         (4-7)
其中gcd（*，#）表示求最小公倍数。可见，双环的模式间隔是大于单独长环的模式间隔的，这有利于后面的滤波操作。选择合适的滤波器，则最终振荡频率为:
f_osc=k∆f           k=0,1,2,3…                                    (4-8) 
k为双环的模式数。
仿真建模
如图（4-4）所示为单独短环OEO的振荡频域图和相位噪声图。图（4-5）所示为双环OEO的振荡频域图和相位噪声图，可见双环OEO的频域图较单环OEO的频域图多了一些“小锯齿”，这些小锯齿的间隔即为长环长的时延的倒数。双环OEO的相位噪声与单环OEO的相位噪声大致相同，但是双环OEO的相位噪声变化频率没有单环OEO快，双环OEO的相位噪声显得更“稳定”。
  


双环OEO的仿真结果如下图所示，如图（4-6 a）所示，尖峰间的间距对应长环的模式间隔即1/τ_1 ，尖峰最高点的间距对应的是1/τ_1 和1/τ_2 的最小公倍数，即双环OEO的模式间隔。图（4-6 b）为频域的局部放大图。

我们对双环OEO的相位噪声进行模拟。图（4-7）短光纤为112m，长光纤为448m；图（4-8）短光纤为448m，长光纤为1792m；在10KHz频偏处，图（4-7）双环OEO相位噪声约为-120dBc/Hz，图（4-8）双环OEO相位噪声约为-135dBc/Hz；可见按一样的比例加大双环OEO的长环和短环的长度会在一定程度上改善其相位噪声。






如图（4-9）所示，短光纤统一设为56m，长光纤分别为224m、448m、672m。可以看出，图（4-9 a）双环OEO在10KHz频偏处相位噪声约为-125dBc/Hz，图（4-9 c）双环OEO在10KHz频偏处相位噪声约为-130dBc/Hz，图（4-9 b）双环OEO在10KHz频偏处相位噪声则介于两者之间。可见若短环长度不变加大长环可以在一定程度上改善双环OEO相位噪声。



















图（4-10）三个图表示短光纤为0.56km，长光纤分别为2.24km、4.48km、6.72km。三个图所示OEO的相位噪声较图（4-9）有所下降，这是由于都等比例加大了长短环的环长。虽然由于短环的存在，在一定程度上加大了边模抑制比，但是单独加大长环的长度不能很有效地降低OEO的相位噪声，可见双环OEO对改善OEO的相位噪声有一定的局限性。

















如图（4-11）所示为注入锁定型双环OEO的相位噪声仿真图，图（4-11 a）为两个OEO自由运行时，图（4-11 b）为两个OEO锁定时。在未锁定的OEO中，主OEO的相位噪声明显小于从OEO的相位噪声，这是因为主OEO的光纤长度大于从OEO的光纤长度。未锁定的主OEO的频谱中出现比较低的边模抑制比。图（4-11 b）显示，主、从两个OEO的锁定在频率锁定范围内降低了从OEO的相位噪声。在该区域，从OEO的相位噪声大致等于自由运行时的主OEO中的相位噪声。与自由运行情况下的杂散电平相比，注入锁定主OEO中的第一杂散电平降低约20 dB。由于两个OEO的共同振荡模式是以主OEO的其他模式为代价来提升的，因此获得了较低的杂散电平[38]。
















5总结与展望
微波信号源是无线通信系统、汽车导航、微波光子雷达、测试仪器、临床医学等系统的关键器件，其好坏很大程度上可以影响到上述系统的性能。微波信号源可以作为同步系统中的参考源、提供高速数字系统的时钟信号、作为本振信号并实现上、下变频。因此，如何获取一个高质量的微波信号是上述系统的迫切要求。如今现代通信技术向着更高频率、更高带宽发展，这对微波信号源性能的要求更加苛刻。而目前发展迅速的光电振荡器（OEO）作为一种集合光学和电学特性的高质量微波信号源由于其显著优势而备受关注，经过几十年发展，OEO在此前的基础上又多出了其他新颖结构，采用的原理技术也更加先进。
本文主要完成的工作有：对OEO的发展背景及过程进行简单梳理介绍；对单环和双环OEO振荡原理进行分析：基本振荡器组成及原理、振荡器组成原理及关键参数、起振的两个条件（增益+相位）；对单环和双环OEO理论基础模型分析计算：起振条件分析计算、频谱特性计算、相位噪声计算；对单环和双环OEO的关键参数进行MATLAB仿真分析：振荡信号的时域和频域图、相位噪声、相位噪声与环路延迟的关系、腔模式的竞争、振幅振荡与滤波器带宽的关系、振幅振荡与小信号开环增益的关系、注入锁定双环OEO相位噪声。
毫无疑问，OEO是目前世界各国研究的热点领域，如何在保证OEO的高频输出的性能下进一步降低相位噪声、集成小型化、实现可调谐性是目前热点发展方向，这就要求有着对OEO强大的理论建模能力，以获取一个精确实用的OEO理论模型，在这方面上文已经介绍了单环、双环两种典型的OEO理论模型，并进行了相应的数字孪生。有了理论模型以后，就可以更好地指导实践，实验制造出满足要求的OEO，并对后期的调试验证提供理论支撑。然而，实际的情况会不可预料得多，但这会反馈回来激励研究人员优化构建更精确的理论模型。例如，若以上所描述的典型Yao-Maleki双环模型中某个回路的光纤长度有微小的变化（假定为回路1)，从而环路1的N_1阶纵模的模式间隔也会发生变化，但是环路2的N_2阶纵模的模式间隔并未发生变化。这时，Yao-Maleki双环模型不再被满足，所以就会出现模式跳变，双环OEO将在一个满足公式（4-4）的振荡频率上重新建立振荡，这就表现为当双环OEO其中一环延迟连续变化时，其输出微波振荡信号频率是离散变化的。但是实际的振荡情况却并非如理论描述这般，在试验中，当某个环路的时延连续变化时，其振荡频率也会随之连续改变。经典的Yao-Maleki模型不能很好地解释这个现象，也不能确定双环OEO的时间延迟和振荡频率的变化关系，仅能对双环 OEO的振荡频率进行定性的分析。如此局限只能依靠一代又一代的科研人员们去抛洒热血找到一个更精确的模型！
 
参考文献
	蒲涛 ... 等. 微波光子学原理与应用[M]. 电子工业出版社, 2015.
	Ming L ,  Zhu N . Recent advances in microwave photonics[J]. Frontiers of Optoelectronics, 2016, 9(2):160-185.
	D. Jager, Traveling-Wave Optoelectronic Device for Microwave and Optical Applications [C], Proc. of Progress in Electromagnetic Research Symposium (PIERS), 1991.
	余前帆. 《计算机科学技术名词》(第三版)正式公布[J]. 中国科技术语, 2019, 21(2):1.
	徐伟. 新型光电振荡器研究[D]. 浙江大学, 2014.
	Yu Y ,  Chen X ,  Dai Y , et al. Dual-wavelength erbium-doped fiber laser with a simple linear cavity and its application in microwave generation[J]. IEEE Photonics Technology Letters, 2005, 18(1):187-189.
	O'Reilly J J ,  Lane P M . Optical generation of very narrow linewidth millimetre wave signals[J]. Electronics Letters, 1992, 28(25):2309-2311.
	Wun J M ,  Wei C C ,  Chen J , et al. Photonic chirped radio-frequency generator with ultra-fast sweeping rate and ultra-wide sweeping range[J]. Optics Express, 2013, 21(9):11475-11481.
	Gao H ,  Lei C ,  Chen M , et al. A simple photonic generation of linearly chirped microwave pulse with large time-bandwidth product and high compression ratio[J]. Optics Express, 2013, 21(20):23107-23115.
	Wiberg A ,  Perez-Millan P ,  Andres M V , et al. Microwave-photonic frequency multiplication utilizing optical four-wave mixing and fiber Bragg gratings[J]. Journal of Lightwave Technology, 2006, 24(1):329-334.
	Neyer A, Voges E. Hybrid electro-optical multivibrator operating by finite feedback delay [J]. 1982, 18 (2): 59-60.
	Yao X S, Maleki L. High frequency optical subcarrier generator [J]. Electronics Letters, 1994, 30 (18): 1525-1526.
	Yao X S, Maleki L. Optoelectronic Microwave Oscillator[J]. Journal of the Optical Society of America B-Optical Physics, 1996,13(8):1725-1735.
	X. S. Yao, L. Maleki. Multiloop Optoelectronic Oscillator[J], IEEE J. Quantum Electron, 2000, 36(1): 79-84
	李城鑫. 微波光子振荡器的研究[D]. 电子科技大学, 2015.
	江阳, 于晋龙, 王耀天等. 一种新型双环路光电振荡器[J]. 光学学报. 2007, 27(5): 919-922
	郑伟，杨文丽，谭庆贵等. 光电振荡器最新研究进展[A]. 空间天线技术研究所.西安.710100
	Matsko A B ,  Ilchenko V S . Optical resonators with whispering-gallery modes-part I: basics[J]. IEEE Journal of Selected Topics in Quantum Electronics, 2006, 12(1):3-14.
	Li W . A Wideband Frequency Tunable Optoelectronic Oscillator Incorporating a Tunable Microwave Photonic Filter Based on Phase-Modulation to Intensity-Modulation Conversion Using a Phase-Shifted Fiber Bragg Grating[J]. IEEE Transactions on Microwave Theory & Techniques, 2012, 60(6):1735-1742.
	Yao X S ,  Maleki L . Multiloop optoelectronic oscillator[J]. IEEE J Quantum Electron, 2000, 36(1):79-84.
	Marpaung D ,  Roeloffzen C ,  Heideman R , et al. Integrated microwave photonics[J]. Laser & Photonics Reviews, 2013, 7(4):506-538.
	Maleki, L. The optoelectronic oscillator. Nature Photon 5, 728–730 (2011).
	XUAN Z, DU L, AFLATOUNIf F. Frequency locking of semiconductor lasers to RF oscillators using hybrid-integrated opto-electronic oscillators with dispersive delay lines [J]. Optics Express, 2019, 27 （8）: 10729- 10737
	章献民, 金晓峰, 杨波,等. 光电振荡器[J]. 微波学报, 2013. 
	Li W . A Wideband Frequency Tunable Optoelectronic Oscillator Incorporating a Tunable Microwave Photonic Filter Based on Phase-Modulation to Intensity-Modulation Conversion Using a Phase-Shifted Fiber Bragg Grating[J]. IEEE Transactions on Microwave Theory & Techniques, 2012, 60(6):1735-1742.
	Pan S, Yao J. Wideband and frequency-tunable microwave generation using an optoelectronic oscillator incorporating a Fabry-Perot laser diode with external optical injection [J]. Opt Lett, 2010, 35 (11): 1911-1913.
	X. P. Xie, C. Zhang, T. Sun, et al. Wideband Tunable Optoelectronic Oscillator Based on a Phase Modulator and a Tunable Optical Filter[J]. Opt. Lett., 2013, 38(5): 655–657
	S. Pan, J. Yao, Multichannel Optical Signal Processing in NRZ Systems Based on a FrequencyDoubling Optoelectronic Oscillator [J], IEEE Journal of Selected Topics in Quantum Electronics 16(5) (2010) 1460-1468
	T. Hao, Q. Cen, Y. Dai, J. Tang, W. Li, J. Yao, N. Zhu, M. Li, Breaking the limitation of mode building time in an optoelectronic oscillator [J], Nat. Commun. 9(1) (2018) 1839
	Hajimiri A ,  Lee T H . A general theory of phase noise in electrical oscillators[J]. IEEE Journal of Solid-State Circuits, 1998, 42(2):179-194.
	Hooge,   F . N . 1/f noise sources[J]. IEEE Transactions on Electron Devices, 1994, 41(11):1926-1935.
	甘小勇. 高速铌酸锂波导电光调制器关键技术研究 [J]. 成都:电子科技大学, 2004
	Chen Y ,  Liu S ,  Pan S . Multi-format signal generation using a frequency-tunable optoelectronic oscillator[J]. Optics Express, 2018, 26(3):3404-3420.
	Yao X S . High-quality microwave signal generation by use of Brillouin scattering in optical fibers[J]. Optics Letters, 1997, 22(17):1329-31.
	Merrer P ,  Saleh K ,  Llopis O , et al. Characterization technique of optical whispering gallery mode resonators in the microwave frequency domain for optoelectronic oscillators[J]. Applied Optics, 2012, 51(20):4742.
	Levy E C ,  Horowitz M ,  Menyuk C R , et al. Modeling optoelectronic oscillators. IEEE, 2009.
	Chembo K , Laurent, Larger, et al. Dynamic instabilities of microwaves generated with optoelectronic oscillators.[J]. Optics letters, 2007.
	Horowitz M ,  Levy E C ,  Okusaga O , et al. Theoretical and experimental study of single and dual-loop optoelectronic oscillators[C]2009 IEEE International Conference on Microwaves, Communications, Antennas and Electronics Systems. 0.































致    谢
四年大学生活就要结束啦，我怀着不舍的心情听着规律起伏的乐音敲着键盘写下如此的致谢。在学校的这几年学到了很多技巧及知识，收获了一些许许多多。每当开学进入校园看见“欢迎你 红果园的新主人”的红底白字横幅，总会恍惚间回到自己入学的那个晴空万里。在学校生活和学习过程中，感谢总有舍友及同学的陪伴左右和食堂宿管的叔叔阿姨，也感谢为我们学业及就业操劳的老师和院领导；感谢指导老师和研一的小红果对本论文的批阅及建议；感谢父母及兄弟姐妹无条件的支持；感谢遇见！最后，因为疫情，我在家好像蹲了两年！
 
附    录
附录A：MATLAB程序代码
1.单环OEO主程序
function [phase_noise,phase_noise_frq,v0_v,t_v,freq_v,phase_noise_RF,phi_v]=SingleOEO_main(N,Nrt,Nmax,T,alpha,RFampCorr,P0,VpiAC,VpiDC,Vb,eta,rhoDC,rho,Ga,attenRF,FilterLoss,Gwidth,CouplerLoss,rho_N)
% 单个 OEO 的仿真由 Etgar C. Levy 在 MATLAB 软件中编写
% M. Horowitz 和 C. Menyuk 参与了算法的设计。
% 该代码基于以下论文：
% Etgar C. Levy, Moshe Horowitz, and Curtis R. Menyuk, "Modeling optoelectronic oscillators," J. Opt. Soc. Am. B 26, 148-159 (2009).
% 该软件参考 UMBC 和 Technion 。
%%%%%%%%%%%
% 参数 %
%%%%%%%%%%%
%rand('state',sum(100*clock));   
DT=T/N; %时间步长                       
DF=1/T; %频率步长                     
BW=1/DT; %仿真带宽                    
t=[0:N-1]*DT; %时间轴
freq=[-N/2:N/2-1]*DF; %频率轴    
w=double(2*pi*freq); %角频率
f0=round(10e9*T)/T; %滤波器中心频率, f0=10 GHz              
R=50;   %光电探测器阻抗                       
Iph=alpha*P0*rho/2*FilterLoss*CouplerLoss*attenRF;             
Vph=Iph*R*Ga; %光电流             
Gs=-eta*pi*Vph/VpiAC*cos(pi*Vb/VpiDC); %小信号开环增益
noise_type='gaussian';%噪声为高斯型
v0=zeros(1,N);  
v1=v0;
v0_m=zeros(N,min(Nrt,Nmax));
v0_m(:,1)=v0;
%%%%%%%%%%%
% OEO 循环运行 %
%%%%%%%%%%%
for in=2:Nrt
    %%% RF滤波器-开始%%%
    v2=double(v0);
    f=double(pi*Gwidth*exp(2*pi*i*f0*t).*exp(-pi*Gwidth*t)); %滤波器的时域脉冲响应 
    v02=double(conv([v1 v2],f)./sum(f));
    v0=double(v02(N+1:N+N)); %The output from the RF filter, and now v0 is the a_in of the modulator
    v1=double(v2); %now v1 is the old v0
    %%% RF 滤波器-结束%%%
    %%%%电光调制器–开始%%%%
    Pt0=double(alpha*P0/2*(1-eta*sin(pi*Vb/VpiDC)*besselj(0,pi*abs(v0)/VpiAC))); 
    Pt=-double(alpha*P0*eta*cos(pi*Vb/VpiDC)*besselj(1,pi*abs(v0)/VpiAC).*exp(i*angle(v0))); 
    %%%%电光调制器–结束%%%%
    %%%%光探测器–开始%%%%
    i0=double(Pt*rho);
    v0=double(i0*R);
    %%%%光探测器–结束%%%%
    v0=double(RFampCorr*(Ga).*(v0+rndnoise(N,R,rho_N*N,DF,noise_type))); %Amp saturation and thermal noise 
    %%%%射频放大器和热噪声–结束%%%%
    if Nrt-in+1<=Nmax
        v0_m(:,in+Nmax-max(Nrt,Nmax))=double(v0); %save the signal after the steady state (2000 iterations)
    end
end
%%%%%%%%%%%%%%%%%%%
%收集运行参数 %
%%%%%%%%%%%%%%%%%%%
v0_v=double(reshape(v0_m(1:N,:),1,(N)*min(Nrt,Nmax)));
N_v=length(v0_v);
T_v=N_v*DT;  %总的时间长度
t_v=[0:N_v-1]*DT;% 整个时间轴 
DF_v=1/T_v;
freq_v=[-N_v/2:N_v/2-1]*DF_v;
phi_v=double(angle(v0_v));
phi_v=unwrap(phi_v); %使得相位跳变的值不超过Pi 弧度（radians）
A_m=double([N_v,sum(t_v)
    sum(t_v),sum(t_v.^2)]);
B_v=double([sum(phi_v), sum(t_v.*phi_v)]);
X_v=double(B_v/A_m);
phi_v=double(phi_v-(X_v(1)+X_v(2).*t_v));
V0_v=double(fftshift(fft(v0_v))/N_v); 
 %%% %%% %%%
%G_v=double(Gwidth/2*i./(df0-freq_v+i*Gwidth/2)); %The Fourier transform of f(T) of the filter
%phiG_v=angle(G_v);%phase(G_v);
%%%%%%%%%%%%%%%%%%%%
% 振荡器功率 %
%%%%%%%%%%%%%%%%%%%%
pt=0.5*abs(v0_v).^2/R;                  % 作为时间函数的功率 [W]
pavg=trapz(t_v,pt)/t_v(end);            % 循环时间内的平均功率 [W]
Pw=0.5*abs(V0_v).^2/R;                  % 功率作为频率的函数 [W]
Pavg=sum(Pw);                           % 带宽上的平均功率 [W]
%%%%%%%%%%%%%%%
% 相位噪声 %
%%%%%%%%%%%%%%%
PHI_v=double(fftshift(fft(phi_v))/N_v); 
phase_noise=double(10*log10(abs(PHI_v).^2/DF_v)); 
%phase_noise=abs(PHI_v);
%%%%%%%%%%%%%%%%%%%%%%%
% 来自频率的相位噪声 %
% （假设没有幅度噪声） %
%%%%%%%%%%%%%%%%%%%%%%%
phase_noise_frq=10*log10(abs(V0_v).^2/R/2/Pavg/DF_v); 
phase_noise_RF=abs(V0_v).^2/R/2/Pavg;

2.双环OEO主程序
%——————————双环OEO ——————————
function [phase_a_noise,phase_b_noise,freq1_v,freq2_v,Vb0_v,tb_v,vb0_v,Va0_v,ta_v,va0_v]=DualLoop_OEO_main(N1,N2,Nrt,Nmax,N12,x_aa,x_ab,x_ba,x_bb,...
DF2,DF1,freq1,R1,R2,noise_type1,noise_type2,RFampCorr1,RFampCorr2,flicker_noise_v1,flicker_noise_v2,CouplerLoss1,CouplerLoss2,... alpha1,alpha2,P01,P02,eta1,eta2,Vb1,Vb2,VpiDC1,VpiDC2,VpiAC1,VpiAC2,rho1,rho2,DT1,DT2,N_FN2,rhoDC1,rhoDC2,rho_THERM1,rho_THERM2)
%%%%%%%%%%%%%%%%%%
% 初始化 %
%%%%%%%%%%%%%%%%%%
va0=ones(1,N1);%rndnoise(N1,R1,rhoN1*N1,DF1,'gaussian');%噪声为高斯型
vb0=ones(1,N2);%rndnoise(N2,R2,rhoN2*N2,DF2,'gaussian');
vb_N12=zeros(1,N1);
va1=va0;
vb1=vb0;
vb0_m=zeros(N2,min(Nrt,Nmax));%矩阵
vb0_m(:,1)=vb0;
va0_m=zeros(N1,Nmax/N12);
qe=1.6e-19;
N2_2=2*N2;
DF2_2=DF2/2;
freq2_2=[-N2_2/2:N2_2/2-1]*DF2_2;
Fb2=filter_8MHz(freq2_2);
Fa=filter_8MHz(freq1);
rho_N1=2.4e-20;
rho_N2=9e-21;
for in=1:Nrt
    if mod(in,N12)==0
           % 耦合器
             va0=double(va0+vb_N12);%3-dB,plus directly
            % 由于射频放大器2而增加了热噪声    
va0=RFampCorr1*sqrt(Gamp0(abs(va0).^2/2/R1)).*(va0+rndnoise(N1,R1,rho_THERM1*N1,DF1,noise_type1));    va0=RFampCorr1*sqrt(Gamp0(abs(va0).^2/2/R1)).*(va0+rndnoise(N1,R1,rho_THERM1*N1,DF1,noise_type1));
            % 加入闪烁噪声
            if Nrt-in+1<=Nmax
                va0=double(va0.*exp(i*flicker_noise_v1(((in+Nmax-Nrt)/N12-1)*N1+1:((in+Nmax-Nrt)/N12)*N1)));
            end
            %% 累积计算
            if Nrt-in+1<=Nmax
                va0_m(:,(in+Nmax-Nrt)/N12)=double(va0);
            end
            %% 耦合器
            va0=double(CouplerLoss1*va0);
            % RF 滤波器  (frequency domain)
            dfa0=0;
            Va0=double(fftshift(fft(va0))/N1);
            Va0=double(Fa.*Va0);
            va0=double(ifft(ifftshift(Va0))*N1);
            % 电光调制器输出 [W]
            Pt01=double(alpha1*P01/2*(1-eta1*sin(pi*Vb1/VpiDC1)*besselj(0,pi*abs(va0)/VpiAC1)));
            Pt1=-double(alpha1*P01*eta1*cos(pi*Vb1/VpiDC1)*besselj(1,pi*abs(va0)/VpiAC1).*exp(i*angle(va0)));
            % 光电二极管电流 [A]
            iDC1=Pt01*rhoDC1;
            i01=double(Pt1*rho1);
            va0=0.5.*double(i01*R1);
            % 添加散粒噪声
            rho_SN1=2*qe*mean(abs(iDC1))*R1;%+2*qe*mean(abs(i01))*R1;
            va0=va0+rndnoise(N1,R1,rho_SN1*N1,DF1,noise_type1);
            % 由于射频放大器1而增加了热噪声
va0=RFampCorr1*sqrt(Gamp0(abs(va0).^2/2/R1)).*(va0+0*rndnoise(N1,R1,rho_N1*N1,DF1,noise_type1));
    end
% 由于射频放大器2而增加了热噪声
vb0=double(RFampCorr2*sqrt(Gamp0(abs(vb0).^2/2/R2)).*(vb0+0*rndnoise(N2,R2,rho_N2*N2,DF2,noise_type2)));
vb0=double(RFampCorr2*sqrt(Gamp0(abs(vb0).^2/2/R2)).*(vb0+0*rndnoise(N2,R2,rho_N2*N2,DF2,noise_type2)));
    % 加入闪烁噪声
    if Nrt-in+1<=N_FN2/N2
        vb0=double(vb0.*exp(i*flicker_noise_v2((in+Nmax-Nrt-1)*N2+1:(in+Nmax-Nrt)*N2)));
    end
    if Nrt-in+1<=Nmax
        vb0_m(:,in+Nmax-max(Nrt,Nmax))=double(vb0);
    end
    %耦合器
    vb0=double(CouplerLoss2*vb0);
    % 射频滤波器（频域）
    dfb0=0;
    vb2=vb0;
    vb02=[vb1 vb2];
    Vb02=double(fftshift(fft(vb02))/N2/2);   
    Vb02=double(Fb2.*Vb02);
    vb02=double(ifft(ifftshift(Vb02))*2*N2); %time-domain complex amplitude
    vb0=vb02(end-N2+1:end);
    vb1=vb2;
     % 电光调制器输出 [W]
    Pt02=double(alpha2*P02/2*(1-eta2*sin(pi*Vb2/VpiDC2)*besselj(0,pi*abs(vb0)/VpiAC2)));
    Pt2=-double(alpha2*P02*eta2*cos(pi*Vb2/VpiDC2)*besselj(1,pi*abs(vb0)/VpiAC2).*exp(i*angle(vb0)));
    % 光电二极管电流 [A]
    iDC2=Pt02*rhoDC2;
    i02=double(Pt2*rho2);
    % 光电二极管电压[V]
    vb0=double(i02*R2);
    % 加入散弹噪声
    rho_SN2=2*qe*mean(abs(iDC2))*R2;%+2*qe*mean(abs(i02))*R2;
    vb0=vb0+rndnoise(N2,R2,rho_SN2*N2,DF2,noise_type2);
    % 由于射频放大器1而增加了热噪声
vb0=RFampCorr2*sqrt(Gamp0(abs(vb0).^2/2/R2)).*(vb0+rndnoise(N2,R2,rho_THERM2*N2,DF2,noise_type2)); vb0=double(RFampCorr2*sqrt(Gamp0(abs(vb0).^2/2/R2)).*(vb0+rndnoise(N2,R2,rho_N2*N2,DF2,noise_type2)));
    jn=mod(in,N12);
    % vb0数据矩阵
    vb_N12(jn*N2+1:(jn+1)*N2)=vb0;
    %射频合路器
    vb0=double(vb0*x_bb+va0(jn*N2+1:(jn+1)*N2)*x_ba);%!!!
end
%%%%%%%%%%%%%%%%%%%
% 收集循环数据 %
%%%%%%%%%%%%%%%%%%%
va0_v=double(reshape(va0_m,1,N1*Nmax/N12));
Na_v=length(va0_v);
Ta_v=Na_v*DT1;
ta_v=[0:Na_v-1]*DT1;%the whole T axis 
DFa_v=1/Ta_v;
freq1_v=[-Na_v/2:Na_v/2-1]*DFa_v;
phi_a_v=double(angle(va0_v));
phi_a_v=unwrap(phi_a_v);
A_m=double([Na_v sum(ta_v)
    sum(ta_v) sum(ta_v.^2)]);
B_v=double([sum(phi_a_v), sum(ta_v.*phi_a_v)]);
X_v=double(B_v/A_m);
phi_a_v=double(phi_a_v-(X_v(1)+X_v(2).*ta_v));
Va0_v=double(fftshift(fft(va0_v))/Na_v);
vb0_v=double(reshape(vb0_m,1,N2*min(Nrt,Nmax)));
Nb_v=length(vb0_v);
Tb_v=Nb_v*DT2;
tb_v=[0:Nb_v-1]*DT2;%the whole T axis 
DFb_v=1/Tb_v;
freq2_v=[-Nb_v/2:Nb_v/2-1]*DFb_v;
phi_b_v=double(angle(vb0_v));
phi_b_v=unwrap(phi_b_v);
A_m=double([Nb_v sum(tb_v)
    sum(tb_v) sum(tb_v.^2)]);
B_v=double([sum(phi_b_v), sum(tb_v.*phi_b_v)]);
X_v=double(B_v/A_m);
phi_b_v=double(phi_b_v-(X_v(1)+X_v(2).*tb_v));
Vb0_v=double(fftshift(fft(vb0_v))/Nb_v);
%%%%%%%%%%%%%%%
% 相位噪声 %
%%%%%%%%%%%%%%%
%长环相位噪声
PHI_a_v=double(fftshift(fft(phi_a_v))/Na_v); %
phase_a_noise=double(10*log10(abs(PHI_a_v).^2/DFa_v)); %dBc/Hz
%短环相位噪声
PHI_b_v=double(fftshift(fft(phi_b_v))/Nb_v); %
phase_b_noise=double(10*log10(abs(PHI_b_v).^2/DFb_v)); %dBc/Hz



